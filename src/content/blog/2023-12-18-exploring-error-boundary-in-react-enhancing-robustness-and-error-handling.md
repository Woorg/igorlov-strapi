---
title: 'Исследование границ ошибок в React: Повышение надежности и обработка ошибок'
meta_title: >-
  Исследование границ ошибок в React: Повышение надежности и обработка ошибок |
  Игорь Горлов - Фронтeндер
description: >-
  Обработка ошибок  важный аспект создания надежных и прочных приложений. В
  React границы ошибок служат механизмом для эффективного перехвата ошибок
  Javascript
date: 2023-12-18T00:00:00.000Z
categories:
  - Учебник
author: Игорь Горлов
draft: false
slug: >-
  yssledovanye-hranyts-oshybok-v-react-pov-shenye-nadezhnosty-y-obrabotka-oshybok
translatedPosition: 28
tags:
  - Обработка ошибок
  - React
image: >-
  ../../assets/images/yssledovanye-hranyts-oshybok-v-react-pov-shenye-nadezhnosty-y-obrabotka-oshybok-Dec-18-2023.avif
lastmod: 2024-03-20T21:26:43.713Z
---

Обработка ошибок - важный аспект создания надежных и прочных приложений. В React границы ошибок служат механизмом для эффективного перехвата ошибок Javascript во время рендеринга, в методах жизненного цикла и в конструкторах всего дерева под ними. Границы ошибок предотвращают крах всего приложения и обеспечивают способ изящной обработки сбоев без ущерба для пользовательского опыта.

![giphy.gif](../../assets/images/giphy.gif)

## Что такое граница ошибки?

Граница ошибки - это компонент React, который оборачивается вокруг других компонентов, чтобы поймать и обработать ошибки, возникающие в их поддереве. Он действует как защитная сетка, изолируя ошибки и не давая им распространяться вверх. Таким образом, он позволяет остальной части приложения продолжать работать без сбоев, даже если в некоторых частях возникнут ошибки.

## Зачем нужны границы ошибок?

Хотя React уже предоставляет свой собственный механизм обработки ошибок, называемый `componentDidCatch`, он работает только для компонентов классов и не может перехватывать ошибки в обработчиках событий. Границы ошибок, с другой стороны, работают как с компонентами классов, так и с компонентами функций. Они помогают гарантировать, что ошибки, такие как неожиданные исключения или сетевые сбои, не нарушат общую стабильность приложения.

## Пример использования

Представьте, что у вас есть приложение с компонентами A. Вы можете обернуть компонент A границей ошибок, чтобы перехватить любые потенциальные ошибки, возникающие внутри A и его дочерних компонентов. Если внутри A произойдет ошибка, граница ошибки перехватит ее и отобразит резервный пользовательский интерфейс, который может представлять собой сообщение об ошибке или пользовательский компонент, предназначенный для изящной обработки конкретной ошибки.

### Посмотрите пример использования Error Boundary

#### Пользовательская полная реализация границы ошибки

Чтобы реализовать пользовательскую границу ошибок в React, вам нужно создать класс компонента, который расширяет базовый класс `React.Component`. Внутри этого компонента вы переопределяете метод жизненного цикла `componentDidCatch`, чтобы определить, как вы хотите обрабатывать ошибку.

Вот пример пользовательского компонента границы ошибок:

```js
class ErrorBoundary extends React.Component {
	constructor(props) {
		super(props);
		this.state = { hasError: false };
	}

	componentDidCatch(error, errorInfo) {
		// Log the error or send it to an error reporting service
		console.error(error, errorInfo);
		// Update state to show the fallback UI
		this.setState({ hasError: true });
	}

	render() {
		if (this.state.hasError) {
			// You can render any custom fallback UI
			return this.props.fallback;
		}
		return this.props.children;
	}
}

// Usage
<ErrorBoundary fallback={<span>Something went wrong</span>}>
	<ComponentA />
</ErrorBoundary>;
```

В настоящее время не существует способа написать границу ошибки как компонент функции. Однако вам не обязательно писать класс границы ошибки самостоятельно. Вместо этого вы можете использовать `react-error-boundary`.

## Как работают границы ошибок?

Границы ошибок в React - это особый тип компонентов, которые отлавливают ошибки, возникающие в их дочерних компонентах во время рендеринга, в методах жизненного цикла и в конструкторах всего дерева под ними. Они действуют как защитный щит вокруг поддерева компонентов, которые они оборачивают, не позволяя ошибкам распространяться вверх и разрушать все приложение.

При возникновении ошибки в компоненте с границей ошибки React вызывает метод жизненного цикла `componentDidCatch` компонента с границей ошибки. Этот метод получает два параметра: error (объект ошибки) и errorInfo (объект, предоставляющий дополнительную информацию о трассировке стека компонента).

Метод `componentDidCatch` позволяет обработать ошибку и предпринять соответствующие действия. Вы можете записать ошибку в журнал, отобразить пользователю резервный пользовательский интерфейс или отобразить альтернативное дерево компонентов, чтобы изящно восстановиться после ошибки. Компонент-граница ошибки берет на себя контроль над потоком ошибок и поддерживает стабильность приложения.

Важно отметить, что границы ошибок в React отлавливают только ошибки, возникающие во время рендеринга, в методах жизненного цикла и в конструкторах всего дерева под ними. Они не отлавливают ошибки в обработчиках событий, асинхронном коде (например, `setTimeout` или `requestAnimationFrame` callbacks), рендеринге на стороне сервера. Для работы с этими типами ошибок можно использовать другие техники обработки ошибок, например, блоки `try-catch` или `Promise.catch()`.

Включив границы ошибок в приложение React, вы сможете изолировать и обрабатывать ошибки контролируемым образом. Это повышает прочность и надежность вашего приложения, предотвращая сбои и обеспечивая изящный способ восстановления после ошибок, что гарантирует плавную работу пользователей.

## Библиотека React Error-Boundary

React также предоставляет встроенную библиотеку под названием `react-error-boundary`. Эта библиотека предлагает декларативный подход, предоставляя компонент высшего порядка (HOC), который оборачивается вокруг компонента. HOC обрабатывает логику границ ошибок, позволяя разработчикам сосредоточиться на пользовательском интерфейсе и стратегиях обработки ошибок.  
Она широко используется сообществом React и считается лучшей практикой обработки ошибок в приложениях React.

`npm install react-error-boundary`

```js
import React, { ErrorBoundary } from 'react';

const MyComponent = () => {
	// Your component logic here

	return (
		<ErrorBoundary fallback={<span>Something went wrong</span>}>
			{/* Component JSX code here */}
		</ErrorBoundary>
	);
};
```

## Заключение

Границы ошибок в React играют важнейшую роль в поддержании стабильности приложения, перехватывая и обрабатывая ошибки в определенных компонентах. Благодаря границам ошибок вы можете минимизировать их влияние и обеспечить более изящный откат пользовательского интерфейса для улучшения общего впечатления пользователя. Независимо от того, используете ли вы собственную реализацию или пользуетесь удобством библиотеки react-error-boundary, включение границ ошибок является важной практикой при создании надежных приложений React.
