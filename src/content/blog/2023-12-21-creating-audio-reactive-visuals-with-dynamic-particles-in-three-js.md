---
title: >-
  –°–æ–∑–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å—Ç–∏—Ü –≤
  Three.js
date: 2023-12-21T00:00:00.000Z
categories:
  - –£—á–µ–±–Ω–∏–∫
author: –ò–≥–æ—Ä—å –ì–æ—Ä–ª–æ–≤
draft: false
slug: >-
  sozdanye-audyoreaktyvn-kh-vyzualn-kh-ffektov-s-pomoschiu-dynamycheskykh-chastyts-v-three-js
tags:
  - Three.js
  - Webgl
image: >-
  ../../assets/images/sozdanye-audyoreaktyvn-kh-vyzualn-kh-ffektov-s-pomoschiu-dynamycheskykh-chastyts-v-three-js-Dec-21-2023.avif
meta_title: >-
  –°–æ–∑–¥–∞–Ω–∏–µ –∞—É–¥–∏–æ—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å—Ç–∏—Ü –≤
  Three.js | –ò–≥–æ—Ä—å –ì–æ—Ä–ª–æ–≤ - –§—Ä–æ–Ω—Çe–Ω–¥–µ—Ä
description: >-
  –í —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –≤—ã —É–∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –º—ã –≤ ARKx —Å–æ–∑–¥–∞–≤–∞–ª–∏ –∞—É–¥–∏–æ—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ
  –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–∞–π—Ç–∞ Coala Music. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏,
  –∏—Å–ø–æ–ª—å–∑—É–µ–º
lastmod: 2024-03-20T21:26:44.483Z
---

–í —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –≤—ã —É–∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ –º—ã –≤ ARKx —Å–æ–∑–¥–∞–≤–∞–ª–∏ –∞—É–¥–∏–æ—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–∞–π—Ç–∞ Coala Music. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ—á–∞—Å—Ç–æ—Ç –∏ —Ç–µ–º–ø–∞, —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ —á–∞—Å—Ç–∏—Ü.

## –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

–ú—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—à—É —Å—Ü–µ–Ω—É Three.js —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º; —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã —Å–º–æ–∂–µ–º –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∏ –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤.

```js
export default class App {
	constructor() {
		this.onClickBinder = () => this.init();
		document.addEventListener('click', this.onClickBinder);
	}

	init() {
		document.removeEventListener('click', this.onClickBinder);

		// BASIC THREEJS SCENE
		this.renderer = new THREE.WebGLRenderer();
		this.camera = new THREE.PerspectiveCamera(
			70,
			window.innerWidth / window.innerHeight,
			0.1,
			10000,
		);
		this.scene = new THREE.Scene();
	}
}
```

## –ê–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ–¥–∞–Ω–Ω—ã—Ö

–î–∞–ª–µ–µ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—à–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∞—É–¥–∏–æ –∏ BPM. –û–Ω–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –∞—É–¥–∏–æ, –µ–≥–æ –∞–Ω–∞–ª–∏–∑ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

```js
async createManagers() {
  App.audioManager = new AudioManager();
  await App.audioManager.loadAudioBuffer();
  App.bpmManager = new BPMManager();
  App.bpmManager.addEventListener('beat', () => {
    this.particles.onBPMBeat();
  });
  await App.bpmManager.detectBPM(App.audioManager.audio.buffer);
}
```

–ó–∞—Ç–µ–º –∫–ª–∞—Å—Å `AudioManager` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∞—É–¥–∏–æ –∏–∑ URL - –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º URL Spotify Preview - –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ, —Ä–∞–∑–±–∏–≤–∞—è –∞—É–¥–∏–æ—Å–∏–≥–Ω–∞–ª—ã –Ω–∞ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ –±–ª–æ–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

```js
const audioLoader = new THREE.AudioLoader();
audioLoader.load(this.song.url, (buffer) => {
	this.audio.setBuffer(buffer);
});
```

## –ß–∞—Å—Ç–æ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–î–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∞–º–ø–ª–∏—Ç—É–¥ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —á–∞—Å—Ç–æ—Ç–Ω—ã–π —Å–ø–µ–∫—Ç—Ä –Ω–∞ –Ω–∏–∑–∫–∏–µ, —Å—Ä–µ–¥–Ω–∏–µ –∏ –≤—ã—Å–æ–∫–∏–µ —á–∞—Å—Ç–æ—Ç—ã.

–ß—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –Ω–∞–º –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é –∏ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–∞–ø–∞–∑–æ–Ω –Ω–∏–∑–∫–∏—Ö —á–∞—Å—Ç–æ—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è `lowFrequency` –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º `midFrequency`). –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∞–º–ø–ª–∏—Ç—É–¥—ã, –ø—Ä–æ—Å—Ç–æ —É–º–Ω–æ–∂—å—Ç–µ —á–∞—Å—Ç–æ—Ç—ã –Ω–∞ –¥–ª–∏–Ω—É –±—É—Ñ–µ—Ä–∞, –∑–∞—Ç–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ –∫ —à–∫–∞–ª–µ 0-1.

```js
this.lowFrequency = 10;
this.frequencyArray = this.audioAnalyser.getFrequencyData();

const lowFreqRangeStart = Math.floor(
	(this.lowFrequency * this.bufferLength) / this.audioContext.sampleRate,
);
const lowFreqRangeEnd = Math.floor(
	(this.midFrequency * this.bufferLength) / this.audioContext.sampleRate,
);

const lowAvg = this.normalizeValue(
	this.calculateAverage(this.frequencyArray, lowFreqRangeStart, lowFreqRangeEnd),
);
// –¢–û–ñ–ï –°–ê–ú–û–ï –î–õ–Ø MID –ò HIGH
```

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–∞

–ê–º–ø–ª–∏—Ç—É–¥—ã —á–∞—Å—Ç–æ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ä–∏—Ç–º —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ BPM (Beats Per Minute) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –ø—É–ª—å—Å–æ–º –º—É–∑—ã–∫–∏. –í –ø—Ä–æ–µ–∫—Ç–µ Coala –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–µ—Å–µ–Ω –∏—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤, –∏ –º—ã –Ω–µ –∑–Ω–∞–µ–º —Ç–µ–º–ø–∞ –∫–∞–∂–¥–æ–≥–æ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è. –ü–æ—ç—Ç–æ–º—É –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º BPM –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –º–æ–¥—É–ª—è `web-audio-beat-detector`, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É audioBuffer.

`const { bpm } = await guess(audioBuffer);`

## –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è BPM –º—ã –º–æ–∂–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª —Å–æ–±—ã—Ç–∏—è —Å –ø–æ–º–æ—â—å—é `setInterval`.

```js
this.interval = 60000 / bpm; // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º BPM –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª
this.intervalId = setInterval(() => {
	this.dispatchEvent({ type: 'beat' });
}, this.interval);
```

## –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã (–≤–µ—Å–µ–ª–∞—è —á–∞—Å—Ç—å üòé)

–¢–µ–ø–µ—Ä—å –º—ã —Å–æ–∑–¥–∞–¥–∏–º –Ω–∞—à–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–∫–æ—Ä–µ –±—É–¥—É—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∑–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã. –ù–∞—á–Ω–µ–º —Å –¥–≤—É—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ (`Box` –∏ `Cylinder`) —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏; —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–π.

–ó–∞—Ç–µ–º –º—ã –¥–æ–±–∞–≤–∏–º —ç—Ç—É –≥–µ–æ–º–µ—Ç—Ä–∏—é –≤ –æ–±—ä–µ–∫—Ç `THREE.Points` —Å –ø—Ä–æ—Å—Ç—ã–º `ShaderMaterial`.

```js
const geometry = new THREE.BoxGeometry(1, 1, 1, widthSeg, heightSeg, depthSeg);

const material = new THREE.ShaderMaterial({
	side: THREE.DoubleSide,
	vertexShader: vertex,
	fragmentShader: fragment,
	transparent: true,
	uniforms: {
		size: { value: 2 },
	},
});

const pointsMesh = new THREE.Points(geometry, material);
```

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞—à–∏ —Å–µ—Ç–∫–∏ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ:

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞

–ú—ã —á–µ—Ä–ø–∞–ª–∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –≤ —É—á–µ–±–Ω–∏–∫–µ –ê–∫–µ–ª–ª—ã –ø–æ FBO –∏ –≤–∫–ª—é—á–∏–ª–∏ —à—É–º –∑–∞–≤–∏—Ö—Ä–µ–Ω–∏–π –≤ –≤–µ—Ä—à–∏–Ω–Ω—ã–π —à–µ–π–¥–µ—Ä, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –æ—Ä–≥–∞–Ω–∏—á–Ω—ã–µ, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–∏—Ç—å —á–∞—Å—Ç–∏—Ü–∞–º —Ç–µ–∫—É—á–∏–µ, –≤–∏—Ö—Ä–µ–≤—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è. –Ø –Ω–µ –±—É–¥—É —É–≥–ª—É–±–ª—è—Ç—å—Å—è –≤ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ Curl Noise –∏ FBO Particles, –ø–æ—Å–∫–æ–ª—å–∫—É –ê–∫–µ–ª–ª–∞ –ø—Ä–æ–¥–µ–ª–∞–ª –ø–æ—Ç—Ä—è—Å–∞—é—â—É—é —Ä–∞–±–æ—Ç—É –≤ —Å–≤–æ–µ–º —Ç—É—Ç–æ—Ä–∏–∞–ª–µ. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –æ–± —ç—Ç–æ–º –±–æ–ª—å—à–µ.

## –ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü

–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥, –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤ –≤–µ—Ä—à–∏–Ω–Ω–æ–º —à–µ–π–¥–µ—Ä–µ –º—ã –∞–Ω–∏–º–∏—Ä—É–µ–º —Ç–æ—á–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–∏–∫—Ç—É—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ —á–∞—Å—Ç–∏—Ü. –ù–∞—á–∏–Ω–∞—è —Å `newpos`, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–º –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏, –º—ã —Å–æ–∑–¥–∞–µ–º —Ü–µ–ª—å. –≠—Ç–∞ —Ü–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —à—É–º —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è al–Ω–∞ –µ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –∏–∑–º–µ–Ω—è—é—â–∏–π—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –∏ –∞–º–ø–ª–∏—Ç—É–¥–Ω–æ–π —Ñ–æ—Ä–º—ã. –û–Ω –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç—Å—è –ø–æ –º–æ—â–Ω–æ—Å—Ç–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è `d` –º–µ–∂–¥—É –Ω–∏–º–∏. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–µ—Ç –ø–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥, –æ—Å–ª–∞–±–µ–≤–∞—é—â–∏–π –ø–æ –º–µ—Ä–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è —Ç–æ—á–∫–∏ –∫ —Ü–µ–ª–∏.

```js
vec3 newpos = position;
vec3 target = position + (normal * .1) + curl(newpos.x * frequency, newpos.y * frequency, newpos.z * frequency) * amplitude;
float d = length(newpos - target) / maxDistance;
newpos = mix(position, target, pow(d, 4.));
```

–ú—ã —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤–æ–ª–Ω–æ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∫ `newpos.z`, –¥–æ–±–∞–≤–ª—è—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π –∂–∏–≤–æ—Å—Ç–∏ –≤ –∞–Ω–∏–º–∞—Ü–∏—é.

`newpos.z += sin(time) * (.1 * offsetGain);`

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ —Ç–æ—á–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫ —Ü–µ–ª–∏ –∏ –Ω–∞ –∫–∞–∫–æ–π –≥–ª—É–±–∏–Ω–µ –≤ —Å—Ü–µ–Ω–µ –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é –±–æ–ª–µ–µ —Ç—Ä–µ—Ö–º–µ—Ä–Ω–æ–π.

`gl_PointSize = size + (pow(d,3.) * offsetSize) * (1./-mvPosition.z);`

–í–æ—Ç –æ–Ω–æ:

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤

–í —à–µ–π–¥–µ—Ä–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –º—ã –º–∞—Å–∫–∏—Ä—É–µ–º —Ç–æ—á–∫—É —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã –∫—Ä—É–≥–∞ –∏ –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ–º —Ñ–æ—Ä–º—ã `startColor` –∏ `endColor` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å `vDistance` —Ç–æ—á–∫–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≤ –≤–µ—Ä—à–∏–Ω–µ:

```js
vec3 circ = vec3(circle(uv, 1.));
vec3 color = mix(startColor, endColor, vDistance);
gl_FragColor = vec4(color, circ.r * vDistance);
```

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à–∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –Ω–∞–∑–Ω–∞—á–∏—Ç—å –∑–≤—É–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–∏—Ç–º –≤—Å–µ–º —Å–≤–æ–π—Å—Ç–≤–∞–º, –∫–∞–∫ –≤ –≤–µ—Ä—à–∏–Ω–Ω—ã—Ö, —Ç–∞–∫ –∏ –≤–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–Ω—ã—Ö —à–µ–π–¥–µ—Ä–∞—Ö. –ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—Ä–∞—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é GSAP.

```js
update() {
  // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–º–ø–ª–∏—Ç—É–¥—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∞—É–¥–∏–æ–º–µ–Ω–µ–¥–∂–µ—Ä–∞
  this.material.uniforms.amplitude.value = 0.8 + THREE.MathUtils.mapLinear(App.audioManager.frequencyData.high, 0, 0.6, -0.1, 0.2);

  // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∏–ª–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–æ–Ω–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∞
  this.material.uniforms.offsetGain.value = App.audioManager.frequencyData.mid * 0.6;

  // –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã
  const t = THREE.MathUtils.mapLinear(App.audioManager.frequencyData.low, 0.6, 1, 0.2, 0.5);
  this.time += THREE.MathUtils.clamp(t, 0.2, 0.5);

  // –ó–∞–∂–∏–º–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –æ–Ω–æ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –≤ –Ω—É–∂–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
  this.material.uniforms.time.value = this.time;
}
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Å–∫–∞–∑–∞–ª–æ –≤–∞–º –æ —Ç–æ–º, –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–≤—É–∫ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ —á–∞—Å—Ç–∏—Ü —Å –ø–æ–º–æ—â—å—é Three.js.  
–ù–∞–¥–µ—é—Å—å, –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å! –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –¥–∞–π—Ç–µ –º–Ω–µ –∑–Ω–∞—Ç—å –≤ Twitter.
