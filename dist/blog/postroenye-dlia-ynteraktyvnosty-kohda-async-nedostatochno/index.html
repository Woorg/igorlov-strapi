<!DOCTYPE html><html lang="ru"> <head><title>Построение для интерактивности: Когда Async недостаточно | Игорь Горлов - Фронтeндер</title><link rel="canonical" href="https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno"><meta name="description" content="В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, [различных протоколах](https://dev.to/awsheroes/websock"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.9.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.sihbnQqJ.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.CpmbJtnn.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-xdjatz7t-1"] { view-transition-name: blog-image-postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno-Feb-10-2024.lfVOIjj__rkUhF.avif" type="image/avif"><source srcset="/_astro/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno-Feb-10-2024.lfVOIjj__Z1hnLgR.webp" type="image/webp"> <img src="/_astro/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno-Feb-10-2024.lfVOIjj__r3rxu.png" alt="Построение для интерактивности: Когда Async недостаточно" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-xdjatz7t-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <!-- <ul class="article__categories categories">
				{
					categories.map((category: string, index: number) => (
						<li class="categories__item">
							<a href={`/category/${slugify(category)}`} class="categories__link">
								{humanize(category)}
								{index !== categories.length - 1 && ','}
							</a>
						</li>
					))
				}
			</ul> --> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Построение для интерактивности: Когда Async недостаточно </h1> <!-- <ul class="article__tags tags">
				{
					tags.map((tag: string) => (
						<li class="tags__item">
							<a class="tags__link" href={`/tag/${slugify(tag)}`}>
								{humanize(tag)}
							</a>
						</li>
					))
				}
			</ul> --> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 10 фев., 2024 by Игорь Горлов </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div class="flex flex-col border-b border-blue bg-box font-bold transition-colors text-xs fluid:py-5 lg:text-lg" data-astro-cid-2umh5aky> <span class="title" data-astro-cid-2umh5aky>Задонатить на пиво</span> <ul class="list" data-astro-cid-2umh5aky> <li class="item" data-astro-cid-2umh5aky>usdt trc20 (tron): TCgbLvPt8fe8n4jqbTjVNkzyPTqhEWxW3k</li><li class="item" data-astro-cid-2umh5aky>btc: bc1qslfl8efv733sgr489yxmf9hduw6ptjvvlq2mwx</li><li class="item" data-astro-cid-2umh5aky>eth: 0x316577c4071a5738DD5C0242A97C44bdd3CD6304</li> </ul> </div>  <!-- <AdfoxTocAds blockId="adfox_17062261612859555" /> --> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Построение для интерактивности: Когда Async недостаточно&url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno&title=Построение для интерактивности: Когда Async недостаточно&summary=В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, [различных протоколах](https://dev.to/awsheroes/websock&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno&media=&description=В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, [различных протоколах](https://dev.to/awsheroes/websock" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open class="toc border-b border-blue text-blue fluid:p-8 overflow-auto cursor-pointer bg-box"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#время-ожидания-имеет-значение">Время ожидания имеет значение</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#эволюция-обмена-сообщениями">Эволюция обмена сообщениями</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#интерактивность---это-ключ">Интерактивность - это ключ.</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="text-blue text-blue-h3" href="#что-если-это-не-вариант">Что, если это не вариант?</a></li></ol></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#как-начать">Как начать</a></li></ol></details open><p>В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, <a href="https://dev.to/aws-heroes/websockets-grpc-mqtt-and-sse-which-real-time-notification-method-is-for-you-52n7" rel="noopener noreferrer nofollow" target="_blank">различных протоколах</a> и о том, как их реализовать, чтобы беспрепятственно доставлять обновления в пользовательский интерфейс. Я не буду утверждать, что я эксперт, но я определенно чувствую себя комфортно с различными способами передачи сообщения от сервера к конечному пользователю.</p>
<p>Посыл, который я последовательно продвигаю уже несколько месяцев, заключается в том, чтобы <em>остановить создание синхронного программного обеспечения</em>. Вместо того чтобы создавать системы на основе запросов/ответов API-вызовов, разделите ваши компоненты и отправляйте обновления в соответствующие части вашей системы. Сам по себе этот совет подходит для современной разработки программного обеспечения, особенно для бессерверных экосистем. Но недавно я начал спрашивать себя ”почему?” Почему это хороший совет?</p>
<p>С точки зрения конечного пользователя, это хороший совет, потому что вы не хотите заставлять людей ждать завершения работы - особенно если она занимает больше нескольких секунд. В 2024 году ожидание, как правило, приводит к плохому пользовательскому опыту. Плохой пользовательский опыт приводит к недовольным пользователям. Недовольные пользователи приводят к тому, что никто не использует ваше программное обеспечение 😬.</p>
<p>Если вы сосредоточились на асинхронной работе с внешним интерфейсом, ваша реализация внутреннего интерфейса обычно состоит из набора конечных точек, которые запускают фоновые процессы и возвращают идентификатор для целей отслеживания. Фоновый процесс периодически отправляет обновления состояния в пользовательский интерфейс через постоянное соединение, например WebSocket или Server-Sent Events (SSE). На случай, если клиент отключится, у вас также будет конечная точка для ваших процессов, которая получит текущий статус, чтобы вы всегда могли получить нужные данные. Простым примером может служить API транскрипции, представленный ниже.</p>
<figure class="igorlov-figure"><img  src="/_astro/async_is_not_enough_1.Bm2bp1yx_Z10L9ya.webp" alt="async_is_not_enough_1.png" width="800" height="307" loading="lazy" decoding="async"><figcaption>async_is_not_enough_1.png</figcaption></figure>
<p>С точки зрения простых цифр, переход от синхронного вызова запроса/ответа к асинхронному заданию увеличивает количество конечных точек, которые вам нужно создавать и поддерживать, с 1 до 3 (как минимум). Плюс в том, что ваши пользователи не будут сидеть и ждать завершения длительного задания. Но достаточная ли это причина для перехода? Кажется, что для того, чтобы пользователи не сидели и не смотрели на спиннер, требуется гораздо больше кода, времени, усилий и сложностей.</p>
<h2 id="время-ожидания-имеет-значение"><a href="#wait-time-matters"></a>Время ожидания имеет значение<a aria-hidden="true" tabindex="-1" href="#время-ожидания-имеет-значение"><span class="icon icon-link"></span></a></h2>
<p>Согласно исследованию <a href="https://www.nngroup.com/articles/response-times-3-important-limits/" rel="noopener noreferrer nofollow" target="_blank">Neilsen Norman Group</a>, существует три важных ограничения, которые необходимо учитывать при оптимизации производительности приложений.</p>
<ul>
<li><strong>0,1 секунды</strong> - время, в течение которого человек чувствует, что система реагирует мгновенно.</li>
<li><strong>1 секунда</strong> - максимальное время, за которое пользователь заметит задержку, но при этом останется сосредоточенным на своей мысли.</li>
<li><strong>10 секунд</strong> - пользователь теряет кратковременную память, и его мысли начинают блуждать в сторону от задачи.</li>
</ul>
<p>По мере того как время ожидания приближается к пределу, ваши пользователи все больше теряют концентрацию. Задачи длительностью более 10 секунд, как правило, нарушают поток пользователей, что часто приводит к отказу от сайта вместо того, чтобы начать выполнение задачи с нуля.</p>
<p>Тем не менее, заставить пользователей просто <em>не</em> смотреть на спиннер, пока выполняется ваше асинхронное задание, вряд ли лучше. Если вы вернете их на приборную панель или переведете пользователей на экран, который ждет обновления, они все равно будут ждать. Они могут не знать, что что-то происходит. Они даже могут подумать, что что-то пошло не так, если вы не держите их в курсе событий.</p>
<p>Конечно, раньше было вполне нормально перемещать кого-то по дому, пока вы занимались чем-то в фоновом режиме. Но теперь это уже не так. Давайте рассмотрим пример из реальной жизни.</p>
<h2 id="эволюция-обмена-сообщениями"><a href="#the-evolution-of-messaging"></a>Эволюция обмена сообщениями<a aria-hidden="true" tabindex="-1" href="#эволюция-обмена-сообщениями"><span class="icon icon-link"></span></a></h2>
<p>Обмен сообщениями - идеальный пример асинхронного взаимодействия. Вы отправляете сообщение адресату, продолжаете заниматься своими делами и в конце концов получаете ответ. Вам не нужно бросать все дела и ждать ответа, вы вольны делать все, что захотите.</p>
<p>В Соединенных Штатах доставка почты [началась в 1775 году] (<a href="https://www.history.com/news/post-office-mail-delivery" rel="noopener noreferrer nofollow" target="_blank">https://www.history.com/news/post-office-mail-delivery</a>) и осуществлялась в основном на лошадях. Если вы хотели отправить другу сообщение, вам приходилось ждать от нескольких недель до нескольких месяцев, пока его доставят. И это был только один способ!</p>
<p>Любой асинхронный процесс можно ”улучшить”, уменьшив общее время, которое он занимает от начала до конца. Именно это и произошло с доставкой почты. В течение следующих нескольких столетий время доставки сокращалось за счет изменения способа транспортировки. Лошади превратились в дилижансы. Дилижансы превратились в железные дороги. Железные дороги превратились в автомобили. Автомобили превратились в авиапочту. Прошло немного времени, и теперь сообщения мгновенно доставляются через Интернет.</p>
<p>Как только мы достигли скорости интернета, мы достигли пика по времени доставки. Вы можете доставить текстовое сообщение или DM любому человеку в мире за миллисекунды. Но это все еще недостаточно хорошо.</p>
<p>Мы привыкли к мгновенной доставке сообщений. Но нам всегда хочется большего. Если я отправляю текстовое сообщение, я хочу знать, как долго мне ждать, пока тот, с кем я переписываюсь, ответит мне. Если я знаю, что человек на другом конце активен, я прекращу свои действия и сосредоточусь на разговоре. Если я знаю, что он не ответит мне в течение нескольких часов, я уберу телефон и займусь чем-нибудь другим.</p>
<p>Как же мы продолжали совершенствоваться? Теперь у нас есть совершенно новый набор индикаторов, которые показывают, как работает наш асинхронный процесс. Во многих приложениях <em>индикаторы присутствия</em> говорят мне, активно ли человек, с которым я обмениваюсь сообщениями, держит приложение открытым. Когда я отправляю сообщение, я получаю не только <em>квитанцию о доставке</em>, но и <em>квитанцию о прочтении</em>. Это означает, что я знаю, попало ли мое сообщение на устройство другого человека и видел ли он его или нет. Кроме того, я вижу индикатор набора текста, который говорит о том, что собеседник активно отвечает на сообщение.</p>
<p>Я не скажу вам ничего такого, чего бы вы уже не знали. Это уже давно существует, и мы привыкли к этому. Но что вы, возможно, не успели собрать воедино между ежедневными текстовыми сообщениями и программным обеспечением, которое вы создаете, так это то, что <strong>вам нужен уровень интерактивности</strong>.</p>
<h2 id="интерактивность---это-ключ"><a href="#interactivity-is-the-key"></a>Интерактивность - это ключ.<a aria-hidden="true" tabindex="-1" href="#интерактивность---это-ключ"><span class="icon icon-link"></span></a></h2>
<p>Современный обмен сообщениями по своей сути все еще является асинхронной коммуникацией. Основная функция - доставка сообщения от отправителя к получателю. Но мы достигли максимальной скорости доставки, а люди все еще нетерпеливы.</p>
<p>Это происходит потому, что асинхронные процессы по сути являются <em><a href="https://en.wikipedia.org/wiki/Black_box" rel="noopener noreferrer nofollow" target="_blank">черными ящиками</a> для потребителей</em>. Как разработчик, вы должны сделать все возможное, чтобы превратить их в ”серые ящики”. Это значит, что вы должны предоставлять как можно больше информации как можно чаще. Помните, если вы не сможете удержать пользователя менее 10 секунд, вы его потеряете.</p>
<blockquote>
<p>Каждый раз, когда вы взаимодействуете с пользователем, ваш таймер сбрасывается.</p>
</blockquote>
<p>Представим, что на получение ответа от человека, с которым вы активно переписываетесь, уходит 20 секунд. 20 секунд - это в два раза больше времени, чем обычно отводит наша кратковременная память на ожидание. Что же делать?</p>
<p>Когда вы нажимаете кнопку отправки, запускается таймер внимания. Вам предстоит обеспечить достаточную интерактивность, чтобы удержать пользователя на протяжении всего времени. Давайте рассмотрим взаимодействия, которые происходят между нажатием кнопки <em>отправить</em> и получением ответного сообщения 👇.</p>
<figure class="igorlov-figure"><img  src="/_astro/async_is_not_enough_2.Y_EMCnVe_ZDSisz.webp" alt="async_is_not_enough_2.png" width="800" height="315" loading="lazy" decoding="async"><figcaption>async_is_not_enough_2.png</figcaption></figure>
<p>В сумме получается 20 секунд, но ни один из отдельных шагов не занимает больше 9 секунд, так что мы в полном порядке, если отправляем интерактивные обновления в нужное время. Обновления показывают, что что-то происходит, и вы можете продолжать привлекать внимание пользователя.</p>
<h3 id="что-если-это-не-вариант"><a href="#what-if-thats-not-an-option"></a>Что, если это не вариант?<a aria-hidden="true" tabindex="-1" href="#что-если-это-не-вариант"><span class="icon icon-link"></span></a></h3>
<p>Идеальный сценарий - это множество событий, свидетельствующих о достигнутом прогрессе. К сожалению, не все сценарии использования идеальны. Некоторые рабочие процессы просто занимают много времени без каких-либо измеримых показателей прогресса. Для других обновление статуса может занять несколько минут, что не позволит вам удержать пользователей.</p>
<p>Возможно, вам стоит подумать о том, чтобы сделать индикатор выполнения по времени. Если ваш рабочий процесс занимает в среднем 4 минуты, установите таймер в пользовательском интерфейсе на 4 минуты и 15 секунд и увеличивайте прогресс каждые несколько секунд. Позвольте мне задать вам вопрос: нравится ли вам смотреть на индикаторы выполнения?</p>
<p>Если вам нужно, чтобы пользователи ждали 30 с лишним секунд, но у вас нет возможности обеспечить значимую интерактивность, отвлеките их другими способами, чтобы сохранить их кратковременную память.</p>
<p>Фантастический пример такого подхода - [Matchbooks] (<a href="https://matchbooks.ai/" rel="noopener noreferrer nofollow" target="_blank">https://matchbooks.ai/</a>). Matchbooks - это приложение, которое позволяет детям использовать генеративный ИИ для безопасного создания собственных историй. Дети описывают главного героя своей истории и рассказывают подробности сюжета. После того как они добавят все данные, приложение создаст великолепно иллюстрированные книги и истории, в точности соответствующие описанию. Этот процесс занимает несколько минут, а для тех, кто не знает, продолжительность внимания детей гораздо короче.</p>
<p>Вместо того чтобы обновлять статус создания истории, приложение направляет детей на игру-пиктограмму, в которую они могут поиграть. Дети играют в быстрые, 10-секундные игры, в которых им предлагается определить, какое животное нарисовано на экране. Как только они произносят вслух правильное животное, они сразу же переходят к новому. Этот процесс повторяется до тех пор, пока на заднем плане не закончится история.</p>
<p>По окончании рассказа загорается кнопка ”Продолжить”, и дети продолжают путешествие с книгой.</p>
<p>При таком подходе дети полностью отвлечены и вовлечены в процесс, который длится несколько минут и является частью рабочего процесса. Дети остаются довольны, потому что их развлекают, а когда они будут готовы, то смогут продолжить созданную ими историю. Эта же концепция применима и к другим областям, просто следите за тем, чтобы она была актуальна для вашего пользователя.</p>
<h2 id="как-начать"><a href="#how-to-start"></a>Как начать<a aria-hidden="true" tabindex="-1" href="#как-начать"><span class="icon icon-link"></span></a></h2>
<p>Интерактивность требует времени. Это гораздо больше, чем настройка WebSockets и публикация нескольких сообщений. Речь идет о контексте. Речь идет о передаче правильной информации, чтобы сбросить внутренние таймеры ваших пользователей. Чтобы понять, что это за правильная информация, я советую вам <em>поступить как пользователь</em>. Используйте свое собственное программное обеспечение и спросите себя ”что я должен делать, пока это происходит?” или ”какая дополнительная информация могла бы быть полезной?”. Попробуйте придумать статусы или метаданные, которые можно представить пользователям.</p>
<p>Когда вы поймете, что именно вы хотите показать пользователям, следующим очевидным шагом будет создание этого приложения. И опять же, решение обычно немного сложнее, чем простая настройка WebSockets в вашем приложении. В зависимости от требований безопасности, соответствия нормативным требованиям и специфики интерактивности, <a href="https://dev.to/aws-heroes/websockets-grpc-mqtt-and-sse-which-real-time-notification-method-is-for-you-52n7" rel="noopener noreferrer nofollow" target="_blank">тип механизма уведомления</a> может сильно различаться. Потратьте некоторое время на исследование и определите, какой из них подходит вам лучше всего.</p>
<p>Лично я опираюсь на <a href="https://www.gomomento.com/services/topics" rel="noopener noreferrer nofollow" target="_blank">Momento Topics</a> для создания интерактивности. Они позволяют соединять браузер с браузером, браузер с бэкендом и бэкенд с бэкендом без создания какой-либо инфраструктуры. Я создал <a href="https://www.gomomento.com/blog/building-an-interactive-live-reaction-app-with-next-js-and-momento" rel="noopener noreferrer nofollow" target="_blank">забавные, интерактивные, реактивные приложения для своих презентаций</a> всего за пару часов, а недавно <a href="https://dev.to/aws-heroes/how-i-built-a-santa-chatbot-to-mess-with-my-brother-21mm" rel="noopener noreferrer nofollow" target="_blank">создал чатбота</a>, используя всего две функции Lambda и url функции. Это значительно ускоряет время разработки, обеспечивая при этом низкую задержку, шину событий, доступную всем частям распределенного приложения.</p>
<p>Но это не продажа Momento Topics. Речь идет о создании лучшего программного обеспечения. Программного обеспечения, которое не только избавит ваших пользователей от ожидания, но и развлечет их. <a href="https://dev.to/aws-heroes/build-what-matters-30on" rel="noopener noreferrer nofollow" target="_blank">Найдите то, что важно</a> и порадуйте своих пользователей. Детали реализации зависят от вас, как и всегда.</p>
<p>Так что попробуйте! Погрузитесь в процесс и выясните, что вы можете сделать, чтобы ваши взаимодействия были частыми и значимыми. Не просто отправляйте пользователей обратно на целевую страницу. Держите их на крючке и не забывайте мыслить нестандартно - именно так технологическая индустрия внедряла инновации в области обмена сообщениями, когда мы уже не могли работать быстрее.</p>
<p>Счастливого кодирования!</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Построение для интерактивности: Когда Async недостаточно&url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno&title=Построение для интерактивности: Когда Async недостаточно&summary=В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, [различных протоколах](https://dev.to/awsheroes/websock&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/postroenye-dlia-ynteraktyvnosty-kohda-async-nedostatochno&media=&description=В 2023 году я потратил много времени на изучение уведомлений в реальном времени. Я узнал о концепциях, [различных протоколах](https://dev.to/awsheroes/websock" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/call-vs-put-vs-post-obyasnenie-metodov-http-zaprosov" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Call vs Put vs Post – Объяснение методов HTTP запросов </a> <a href="/blog/bot-dlya-kratkogo-izlozheniya-razgovorov-v-telegram-s-chatgpt-i-flask-quart" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Бот для краткого изложения разговоров в Telegram с ChatGPT и Flask (Quart) </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>