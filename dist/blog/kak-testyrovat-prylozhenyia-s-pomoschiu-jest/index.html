<!DOCTYPE html><html lang="ru"> <head><title>Как тестировать приложения с помощью Jest - Фул Фронт Дев</title><link rel="canonical" href="https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest"><meta name="description" content="Тестирование программного обеспечения [https://kinsta.com/blog/performancetestingtools/] жизненно необходимо для того, чтобы ваши приложения работали так, ка"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.5.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.uIaUWrkB.css" />
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw);padding-left:min(2rem,1.2125rem + 1.05vw);padding-right:min(2rem,1.2125rem + 1.05vw);padding-top:1rem;padding-bottom:1rem}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.breadcrumbs__link[data-astro-cid-vcbh62el]{border-radius:9999px;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover{--tw-bg-opacity: 1;background-color:#fce4e1;background-color:rgba(252,228,225,var(--tw-bg-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]{padding:.125rem .75rem}.breadcrumbs__link[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#6a6a6a;background-color:rgba(106,106,106,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#8a8a93;background-color:rgba(138,138,147,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}
</style>
<link rel="stylesheet" href="/_astro/_single_.CyWP_2Jq.css" />
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#020202;border-color:rgba(2,2,2,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-533071ec]{margin:auto;margin-top:1.25rem;max-width:42rem;--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.comments:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame[data-v-533071ec]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
.theme-toggle[data-v-8d8d9c54]{width:1.25rem;height:1.25rem}
</style><script type="module" src="/_astro/hoisted.DYPnEDpO.js"></script><style>[data-astro-transition-scope="astro-vgmtzcrq-1"] { view-transition-name: blog-image-kak-testyrovat-prylozhenyia-s-pomoschiu-jest; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-14 font-inter text-dark fluid:text-lg dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-extrabold lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> </button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> </button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/projects" class="nav__link" data-astro-cid-7wkmezxd> Работы. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты. </a> </li> </ul> </nav> </div>   <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var v=Object.defineProperty;var A=(c,s,a)=>s in c?v(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a;var d=(c,s,a)=>(A(c,typeof s!="symbol"?s+"":s,a),a);var u;{let c={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},s=t=>{let[e,n]=t;return e in c?c[e](n):void 0},a=t=>t.map(s),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,s(n)]));customElements.get("astro-island")||customElements.define("astro-island",(u=class extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var f;if(!this.hydrator||!this.isConnected)return;let e=(f=this.parentElement)==null?void 0:f.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),r={},l=this.querySelectorAll("template[data-astro-template]");for(let o of l){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("data-astro-template")||"default"]=o.innerHTML,o.remove())}for(let o of n){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("name")||"default"]=o.innerHTML)}let h;try{h=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(o){let i=this.getAttribute("component-url")||"<unknown>",b=this.getAttribute("component-export");throw b&&(i+=` (export ${b})`),console.error(`[hydrate] Error parsing props for component ${i}`,this.getAttribute("props"),o),o}let p;await this.hydrator(this)(this.Component,h,r,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),n.disconnect(),this.childrenConnectedCallback()},n=new MutationObserver(()=>{var r;((r=this.lastChild)==null?void 0:r.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});n.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}try{await Astro[n](async()=>{let r=this.getAttribute("renderer-url"),[l,{default:h}]=await Promise.all([import(this.getAttribute("component-url")),r?import(r):()=>()=>{}]),p=this.getAttribute("component-export")||"default";if(!p.includes("."))this.Component=l[p];else{this.Component=l;for(let y of p.split("."))this.Component=this.Component[y]}return this.hydrator=h,this.hydrate},e,this)}catch(r){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,r)}}attributeChangedCallback(){this.hydrate()}},d(u,"observedAttributes",["props"]),u))}})();</script><astro-island uid="IJ3dh" component-url="/_astro/ThemeToggle.kpN4JrWQ.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-rq644orq&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}"></astro-island> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <div class="blocks__container container"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <ol class="breadcrumbs__list" role="list" data-astro-cid-vcbh62el> <li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </nav>  </div> <div class="blocks__container container"> <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/учебник" class="categories__link" data-astro-cid-axzg2cw6> Учебник  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Как тестировать приложения с помощью Jest </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/testing" data-astro-cid-axzg2cw6> Testing </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/jest" data-astro-cid-axzg2cw6> Jest </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 04 дек., 2023 by Igor Gorlov </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div>  <figure class="article__image" data-astro-cid-axzg2cw6> <picture> <source srcset="/_astro/kak-testyrovat-prylozhenyia-s-pomoschiu-jest-Dec-04-2023.CkfgoQnt_2EF6u.avif" type="image/avif"><source srcset="/_astro/kak-testyrovat-prylozhenyia-s-pomoschiu-jest-Dec-04-2023.CkfgoQnt_Z1zJkYK.webp" type="image/webp"> <img src="/_astro/kak-testyrovat-prylozhenyia-s-pomoschiu-jest-Dec-04-2023.CkfgoQnt_SK35Q.png" alt="Как тестировать приложения с помощью Jest" class="aspect-auto h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-vgmtzcrq-1" width="1200" height="500" decoding="async"> </picture> </figure>  <div class="article__content prose prose-zinc max-w-full dark:prose-invert prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:-mx-12 prose-figure:w-screen prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div id="adfox_17062261612859555"></div> <script>(function(){const blockId = "adfox_17062261612859555";

	window.yaContextCb = window.yaContextCb || [];
	window.yaContextCb.push(() => {
		Ya.adfoxCode.createAdaptive(
			{
				ownerId: 1493338,
				containerId: blockId,
				params: {
					p1: 'dawgg',
					p2: 'p',
				},
			},
			['desktop', 'tablet', 'phone'],
			{
				tabletWidth: 830,
				phoneWidth: 480,
				isAutoReloads: true,
			},
		);
	});
})();</script> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Как тестировать приложения с помощью Jest&#38;url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest&#38;title=Как тестировать приложения с помощью Jest&#38;summary=Тестирование программного обеспечения [https://kinsta.com/blog/performancetestingtools/] жизненно необходимо для того, чтобы ваши приложения работали так, ка&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest&#38;media=&#38;description=Тестирование программного обеспечения [https://kinsta.com/blog/performancetestingtools/] жизненно необходимо для того, чтобы ваши приложения работали так, ка" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open class="toc px-5 border border-gray-light lg:px-10 py-2 cursor-pointer"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#что-такое-jest">Что такое Jest?</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#как-настроить-jest-для-вашего-javascript-проекта">Как настроить Jest для вашего JavaScript-проекта</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#предварительные-условия">Предварительные условия</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#установите-пакет-jest">Установите пакет Jest</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#настройка-jest">Настройка Jest</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#настроить-jest-в-packagejson">Настроить Jest в package.json</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#настройка-jest-в-файле-конфигурации">Настройка Jest в файле конфигурации</a></li></ol></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#создание-базового-тестового-файла">Создание базового тестового файла</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#напишите-тест">Напишите тест</a></li><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#выполните-тест">Выполните тест</a></li></ol></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#как-писать-тесты-с-jest">Как писать тесты с Jest</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#синтаксис-тестов-jest">Синтаксис тестов Jest</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#организация-тестов-в-тестовые-наборы">Организация тестов в тестовые наборы</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#написание-простых-утверждений-с-помощью-jest-matchers">Написание простых утверждений с помощью Jest Matchers</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#тестируем-асинхронный-код">Тестируем асинхронный код</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#расширенные-возможности-jest">Расширенные возможности Jest</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#mock-функции-и-модули">Mock-функции и модули</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#тестирование-react-компонентов-с-помощью-jest-и-библиотеки-тестирования-react">Тестирование React-компонентов с помощью Jest и библиотеки тестирования React</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#запуск-отчетов-о-покрытии-кода">Запуск отчетов о покрытии кода</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#интеграция-jest-с-процессом-разработки">Интеграция Jest с процессом разработки</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#запуск-тестов-в-режиме-наблюдения">Запуск тестов в режиме наблюдения</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#настройка-крючков-предварительного-коммита">Настройка крючков предварительного коммита</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#резюме">Резюме</a></li></ol></details open><p>Тестирование программного обеспечения жизненно необходимо для того, чтобы ваши приложения работали так, как ожидалось, особенно когда вы вносите изменения. Выявление и исправление ошибок на ранних этапах разработки имеет решающее значение для поддержания надежного и качественного кода.</p>
<p>Из множества доступных инструментов и фреймворков для тестирования JavaScript Jest является одним из самых популярных. Продукт компании Meta, Jest обладает широкими возможностями тестирования JavaScript-приложений и приложений, созданных с использованием JavaScript-фреймворков.</p>
<p>Давайте рассмотрим фреймворк Jest, его возможности и то, как лучше всего интегрировать его в рабочий процесс разработки.</p>
<h2 id="что-такое-jest">Что такое Jest?<a aria-hidden="true" tabindex="-1" href="#что-такое-jest"><span class="icon icon-link"></span></a></h2>
<p><a href="https://jestjs.io/" rel="noopener noreferrer nofollow" target="_blank">Jest</a> - это гибкий и простой в использовании фреймворк. В дополнение к основным функциям тестирования JavaScript, он предлагает конфигурации и плагины для поддержки тестирования приложений на основе Babel, <a href="https://kinsta.com/blog/vite-vs-webpack/" rel="noopener noreferrer nofollow" target="_blank">webpack, Vite</a>, <a href="https://kinsta.com/blog/rollup-vs-webpack-vs-parcel/" rel="noopener noreferrer nofollow" target="_blank">Parcel</a> или <a href="https://kinsta.com/knowledgebase/what-is-typescript/" rel="noopener noreferrer nofollow" target="_blank">TypeScript</a>.</p>
<p>Jest получил широкое распространение среди разработчиков и может похвастаться множеством плагинов, созданных и поддерживаемых сообществом. Он отличается простотой использования: Тестирование JavaScript не требует дополнительных настроек или плагинов. Но вы можете выполнять и более сложное тестирование - например, тестирование <a href="https://kinsta.com/topic/javascript-frameworks/" rel="noopener noreferrer nofollow" target="_blank">JavaScript-фреймворков</a> - используя некоторые дополнительные параметры конфигурации.</p>
<h2 id="как-настроить-jest-для-вашего-javascript-проекта">Как настроить Jest для вашего JavaScript-проекта<a aria-hidden="true" tabindex="-1" href="#как-настроить-jest-для-вашего-javascript-проекта"><span class="icon icon-link"></span></a></h2>
<p>Давайте рассмотрим, как настроить Jest в существующем проекте JavaScript.</p>
<h3 id="предварительные-условия">Предварительные условия<a aria-hidden="true" tabindex="-1" href="#предварительные-условия"><span class="icon icon-link"></span></a></h3>
<p>Чтобы следовать этому руководству, убедитесь, что у вас есть следующее:</p>
<ul>
<li><a href="https://nodejs.org/en/download" rel="noopener noreferrer nofollow" target="_blank">Node.js</a> установлен.</li>
<li>Установлен npm (уже входит в состав Node.js) или <a href="https://classic.yarnpkg.com/lang/en/docs/install/#windows-stable" rel="noopener noreferrer nofollow" target="_blank">Yarn</a>.</li>
<li>Установлен пакет Jest <a href="https://www.npmjs.com/package/jest" rel="noopener noreferrer nofollow" target="_blank">npm</a>.</li>
</ul>
<h3 id="установите-пакет-jest">Установите пакет Jest<a aria-hidden="true" tabindex="-1" href="#установите-пакет-jest"><span class="icon icon-link"></span></a></h3>
<ol>
<li>Если у вас еще нет проекта, чтобы следовать этому руководству, используйте <a href="https://github.com/VirtuaCreative/kinsta-jest-javascript" rel="noopener noreferrer nofollow" target="_blank">это репо</a> в качестве отправной точки.</li>
</ol>
<p>Ветка <a href="https://github.com/VirtuaCreative/kinsta-jest-javascript/tree/starter-files" rel="noopener noreferrer nofollow" target="_blank"><code>starter-files</code></a> дает вам основу для создания приложения по ходу обучения. Обратитесь к ветке <code>[main](https://github.com/VirtuaCreative/kinsta-jest-javascript/tree/main)</code> для просмотра кода этого руководства и перекрестной проверки вашего кода.</p>
<ol start="2">
<li>Чтобы установить Jest с помощью <a href="https://kinsta.com/knowledgebase/what-is-npm/" rel="noopener noreferrer nofollow" target="_blank">npm</a>, перейдите в каталог проекта в терминале и выполните следующую команду:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">npm</span><span style="color:#ADD7FF"> install</span><span style="color:#ADD7FF"> --save-dev</span><span style="color:#ADD7FF"> jest</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<p>Опция <code>--save-dev</code> указывает npm установить пакет под <code>devDependencies</code>, который содержит зависимости, необходимые для разработки.</p>
<h3 id="настройка-jest">Настройка Jest<a aria-hidden="true" tabindex="-1" href="#настройка-jest"><span class="icon icon-link"></span></a></h3>
<p>Хотя Jest обычно работает без дополнительной настройки, есть два способа расширить его возможности: в файле <strong>package.json</strong> и через файл конфигурации Jest.</p>
<h4 id="настроить-jest-в-packagejson">Настроить Jest в <strong>package.json</strong><a aria-hidden="true" tabindex="-1" href="#настроить-jest-в-packagejson"><span class="icon icon-link"></span></a></h4>
<p>В файле <strong>package.json</strong> добавьте объект <code>jest</code> со свойствами, как показано ниже:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">{</span></span>
<span class="line"><span style="color:#D0679D">  ...</span></span>
<span class="line"><span style="color:#A6ACCD">  "</span><span style="color:#E4F0FB">jest</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">    "</span><span style="color:#ADD7FF">displayName</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Ecommerce</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">    "</span><span style="color:#ADD7FF">globals</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">      "</span><span style="color:#91B4D5">PROJECT_NAME</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Ecommerce TD</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">    },</span></span>
<span class="line"><span style="color:#A6ACCD">    "</span><span style="color:#ADD7FF">bail</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#5DE4C7">20</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">    "</span><span style="color:#ADD7FF">verbose</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#5DE4C7">true</span></span>
<span class="line"><span style="color:#A6ACCD">  },</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Во время тестирования Jest ищет этот объект и применяет эти конфигурации. Дополнительные параметры можно посмотреть на <a href="https://jestjs.io/docs/26.x/configuration" rel="noopener noreferrer nofollow" target="_blank">странице конфигураций Jest</a>, но свойства этого объекта включают:</p>
<ul>
<li><code>displayName</code> - Jest добавляет значение этого свойства в качестве метки к результатам теста.</li>
<li><code>globals</code> - Хранит значение объекта для определения глобальных переменных, доступных в вашем тестовом окружении.</li>
<li><code>bail</code> - По умолчанию Jest выполняет все тесты и отображает ошибки в результатах. <code>bail</code> указывает Jest прекратить выполнение после заданного количества неудач.</li>
<li><code>verbose</code> - Если установлено значение <code>true</code>, то во время выполнения теста отображаются отдельные тестовые отчеты.</li>
</ul>
<h4 id="настройка-jest-в-файле-конфигурации">Настройка Jest в файле конфигурации<a aria-hidden="true" tabindex="-1" href="#настройка-jest-в-файле-конфигурации"><span class="icon icon-link"></span></a></h4>
<p>Вы также можете настроить Jest в файле <strong>jest.config.js</strong>. Jest также поддерживает расширения <strong>.ts</strong>, <strong>.mjs</strong>, <strong>.cjs</strong> и <strong>.json</strong>. При выполнении тестов Jest ищет эти файлы и применяет настройки в найденном файле.</p>
<p>Например, рассмотрим этот файл <strong>jest.config.js</strong>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> config</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">	displayName</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Ecommerce</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	globals</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">		PROJECT_NAME</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Ecommerce TD</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">	},</span></span>
<span class="line"><span style="color:#ADD7FF">	bail</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 20</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	подробный</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> true</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">module</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">exports</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> config</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span></code></pre>
<p>Этот код экспортирует объект конфигурации Jest с теми же свойствами, что и в предыдущем примере.</p>
<p>Вы также можете использовать пользовательский файл, содержащий JSON-сериализуемый объект конфигурации, и передавать путь к файлу в опции <code>--config</code> при выполнении тестов.</p>
<h3 id="создание-базового-тестового-файла">Создание базового тестового файла<a aria-hidden="true" tabindex="-1" href="#создание-базового-тестового-файла"><span class="icon icon-link"></span></a></h3>
<p>Настроив Jest, создайте свои тестовые файлы. Jest просматривает тестовые файлы вашего проекта, выполняет их и предоставляет результаты. Тестовые файлы обычно имеют такой формат, как <strong>[name].test.js</strong> или <strong>[name]-test.js</strong>. Этот шаблон облегчает идентификацию тестовых файлов как для Jest, так и для вашей команды.</p>
<p>Рассмотрим файл <strong>string-format.js</strong>, содержащий следующий код:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">function</span><span style="color:#ADD7FF"> truncate</span><span style="color:#A6ACCD">(</span></span>
<span class="line"><span style="color:#E4F0FB">  str</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#E4F0FB">  count</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#E4F0FB">  withEllipsis</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7"> true</span></span>
<span class="line"><span style="color:#A6ACCD">) {</span></span>
<span class="line"><span style="color:#A6ACCD">  if (</span><span style="color:#E4F0FB">str</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">length</span><span style="color:#91B4D5"> &#x3C;</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> count</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FB">    вернуть</span><span style="color:#E4F0FB"> str</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">  const</span><span style="color:#E4F0FB"> substring</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> str</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">substr</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">count</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">  if (</span><span style="color:#91B4D5">!</span><span style="color:#E4F0FB">withEllipsis</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FB">    вернуть</span><span style="color:#E4F0FB"> подстроку</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">  return</span><span style="color:#E4F0FB"> substring</span><span style="color:#91B4D5"> +</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">...</span><span style="color:#A6ACCD">'</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">module</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">exports</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> {</span><span style="color:#E4F0FB"> truncate</span><span style="color:#A6ACCD"> }</span></span>
<span class="line"></span></code></pre>
<p>Функция <code>truncate()</code> усекает строки до определенной длины с возможностью добавления многоточия.</p>
<h4 id="напишите-тест">Напишите тест<a aria-hidden="true" tabindex="-1" href="#напишите-тест"><span class="icon icon-link"></span></a></h4>
<ol>
<li>
<p>Создайте тестовый файл с именем <strong>string-format.test.js</strong>.</p>
</li>
<li>
<p>Чтобы сохранить упорядоченность файлов, поместите <strong>string-format.test.js</strong> в тот же каталог, где находится файл <strong>string-format.js</strong>, или в специальный каталог тестов. Независимо от того, где находится ваш тестовый файл в проекте, Jest найдет и выполнит его. С помощью Jest вы можете тестировать свои приложения в различных сценариях.</p>
</li>
<li>
<p>Напишите базовый тест в <strong>string-format.test.js</strong> следующим образом:</p>
</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">truncate</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> require</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">./string-format</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">корректно усекает строку</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> ></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">truncate(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Я иду домой</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> 6</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB">).</span><span style="color:#ADD7FF">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Я иду...</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<p>Тестовый пример имеет описание <code>корректно усекает строку</code>. Этот код использует функцию <code>expect</code>, предоставляемую Jest, которая проверяет, соответствует ли значение ожидаемому результату.</p>
<p>Код передает <code>truncate("Я иду домой", 6)</code> в качестве аргумента <code>expect</code>. Этот код проверяет значение, возвращаемое при вызове <code>truncate</code> с аргументами <code>"Я иду домой"</code> и <code>6</code>. Вызов <code>expect</code> возвращает объект expectation, который предоставляет доступ к соответствиям Jest.</p>
<p>Он также содержит матчер <code>toBe</code>, аргументом которого является <code>"Я иду домой..."</code>. Матчер <code>toBe</code> проверяет равенство между ожидаемым и действительным значениями.</p>
<h4 id="выполните-тест">Выполните тест<a aria-hidden="true" tabindex="-1" href="#выполните-тест"><span class="icon icon-link"></span></a></h4>
<p>Чтобы выполнить тесты, определите команду <code>jest</code>.</p>
<ol>
<li>В файл <strong>package.json</strong> вашего проекта добавьте этот скрипт <code>test</code>:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">scripts</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">  "</span><span style="color:#E4F0FB">test</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">jest</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>Теперь запустите <code>npm run test</code>, <code>npm test</code> или <code>npm t</code> в терминале. Это запустит Jest для проекта.</li>
</ol>
<p>Когда вы выполните тесты, результат будет таким:</p>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-string-format-test.png" alt="Результат теста Jest показывает прохождение теста &#x22;правильно усекает строку&#x22; в string-format.test.js."><figcaption>Результат теста Jest показывает прохождение теста "правильно усекает строку" в string-format.test.js.</figcaption></figure>
<p>Успешный результат теста Jest для string-format.test.js.</p>
<p>Результаты показывают один набор тестов (файл <strong>string-format.test.js</strong>), один успешно выполненный тест (<code>"правильно усекает строку"</code>) и <code>displayName</code> (<code>Ecommerce</code>), который вы определили в конфигурации.</p>
<ol start="3">
<li>В файле <strong>string-format.js</strong>, если добавить лишнюю точку, чтобы сломать код и запустить тест, он завершится неудачей:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-truncate-failed.png" alt="Jest test result showing failed for the &#x22;truncates a string correctly&#x22; test in string-format.test.js. Ожидаемая строка из теста - &#x22;i am g...&#x22;, но полученная строка - &#x22;i am g....&#x22;"><figcaption>Jest test result showing failed for the "truncates a string correctly" test in string-format.test.js. Ожидаемая строка из теста - "i am g...", но полученная строка - "i am g...."</figcaption></figure>
<p>Неудачный результат теста Jest из-за неработающей функции truncate.</p>
<p>Этот результат указывает на то, что вы сломали функцию <code>truncate</code> или сделали обновления, которые требуют обновления тестов.</p>
<h2 id="как-писать-тесты-с-jest">Как писать тесты с Jest<a aria-hidden="true" tabindex="-1" href="#как-писать-тесты-с-jest"><span class="icon icon-link"></span></a></h2>
<h3 id="синтаксис-тестов-jest">Синтаксис тестов Jest<a aria-hidden="true" tabindex="-1" href="#синтаксис-тестов-jest"><span class="icon icon-link"></span></a></h3>
<p>Собственный синтаксис Jest прост в использовании. Jest предоставляет вашему проекту глобальные методы и объекты для написания тестов. Некоторые из его фундаментальных понятий - <code>describe</code>, <code>test</code>, <code>expect</code> и matchers.</p>
<ul>
<li><code>describe</code>: Эта функция группирует связанные тесты в файл.</li>
<li><code>test</code>: Эта функция запускает тест. Это псевдоним для <code>it</code>. Она содержит утверждения для значений, которые вы хотите проверить.</li>
<li><code>expect</code>: Эта функция объявляет утверждения для различных значений. Она предоставляет доступ к матчерам для различных форм утверждений.</li>
<li>Матчики: Они позволяют утверждать значение различными способами. Вы можете утверждать равенство значений, булево равенство и контекстное равенство (например, содержит ли массив данное значение).</li>
</ul>
<p>Чтобы использовать их, рассмотрим следующий пример:</p>
<ol>
<li>Замените тест в файле <strong>string-format.test.js</strong> следующим кодом:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FBD0">describe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">все форматы строк работают как ожидалось</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> ></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">правильно усекает строку</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> (</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB"> = > </span><span style="color:#A6ACCD">{</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span></span>
<span class="line"><span style="color:#E4F0FBD0">truncate</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Я иду домой</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span><span style="color:#5DE4C7"> 6</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Я ж...</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span><span style="color:#E4F0FB">)</span></span>
<span class="line"><span style="color:#A6ACCD">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>Запустите код.</li>
</ol>
<p>Результат выглядит следующим образом:</p>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-truncate-string.png" alt="Результат теста Jest показывает прохождение теста &#x22;правильно усекает строку&#x22; в файле string-format.test.js. Результат теста также показывает текст &#x22;все форматы строк работают как ожидалось&#x22; из функции describe."><figcaption>Результат теста Jest показывает прохождение теста "правильно усекает строку" в файле string-format.test.js. Результат теста также показывает текст "все форматы строк работают как ожидалось" из функции describe.</figcaption></figure>
<p>Успешный результат теста Jest, показывающий метку describe.</p>
<p>На скриншоте видно, что метка в функции <code>describe</code> создает блок. Хотя функция <code>describe</code> необязательна, группировка тестов в файле с большим контекстом полезна.</p>
<h3 id="организация-тестов-в-тестовые-наборы">Организация тестов в тестовые наборы<a aria-hidden="true" tabindex="-1" href="#организация-тестов-в-тестовые-наборы"><span class="icon icon-link"></span></a></h3>
<p>В Jest тестовый пример состоит из функции <code>test</code>, функции <code>expect</code> и матчера. Набор связанных между собой тестовых примеров является тестовым набором. В предыдущем примере <strong>string-format.test.js</strong> - это набор тестов, состоящий из одного тестового случая для проверки файла <strong>string-format.js</strong>.</p>
<p>Предположим, что в вашем проекте есть еще несколько файлов, например <strong>file-operations.js</strong>, <strong>api-logger.js</strong> и <strong>number-format.js</strong>. Вы можете создать наборы тестов для этих файлов, например <strong>file-operations.test.js</strong>, <strong>api-logger.test.js</strong> и <strong>number-format.test.js</strong>.</p>
<h3 id="написание-простых-утверждений-с-помощью-jest-matchers">Написание простых утверждений с помощью Jest Matchers<a aria-hidden="true" tabindex="-1" href="#написание-простых-утверждений-с-помощью-jest-matchers"><span class="icon icon-link"></span></a></h3>
<p>Мы рассмотрели пример использования матчера <code>toBe</code>. Утверждения с <a href="https://jestjs.io/docs/expect#matchers" rel="noopener noreferrer nofollow" target="_blank">другими матчерами Jest</a> включают:</p>
<ul>
<li><code>toEqual</code> - Для проверки ”глубокого” равенства в экземплярах объектов.</li>
<li><code>toBeTruthy</code> - Для проверки истинности значения в булевом контексте.</li>
<li><code>toBeFalsy</code> - Для проверки ложности значения в булевом контексте.</li>
<li><code>toContain</code> - Для проверки того, что массив содержит значение.</li>
<li><code>toThrow</code> - Для проверки того, что вызванная функция выбрасывает ошибку.</li>
<li><code>stringContaining</code> - Для проверки того, что строка содержит подстроку.</li>
</ul>
<p>Давайте рассмотрим примеры с использованием некоторых из этих матчеров.</p>
<p>Например, вы можете ожидать, что функция или код вернут объект с определенными свойствами и значениями.</p>
<ol>
<li>Используйте приведенный ниже фрагмент кода для проверки этой функциональности. В этом случае вы хотите подтвердить, что возвращаемый объект равен ожидаемому объекту.</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">	имя</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Джо</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	возраст</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 40</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">}).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">	имя</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Джо</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	возраст</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 40</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В этом примере используется <code>toBe</code>. Тест не проходит, так как этот матчер не проверяет глубокое равенство - он проверяет значение, а не все свойства.</p>
<ol start="2">
<li>Используйте матчер <code>toEqual</code> для проверки глубокого равенства:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">	имя</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Джо</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	возраст</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 40</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">}).</span><span style="color:#E4F0FBD0">toEqual</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">	имя</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Джо</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">	возраст</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 40</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Тест пройден, так как оба объекта ”глубоко равны”, то есть все их свойства равны.</p>
<ol start="3">
<li>Попробуйте другой пример с матчером, который проверяет, содержит ли заданный массив определенный элемент.</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">([</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">апельсин</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">груша</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">яблоко</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">]).</span><span style="color:#E4F0FBD0">toContain</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">манго</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span></code></pre>
<p>Этот тест провалился, потому что <code>toContain</code> утверждает, что массив <code>["orange", "pear", "apple"]</code> содержит ожидаемое значение <code>"mango"</code>, но массив не содержит его.</p>
<ol start="4">
<li>Используйте переменные для того же теста, что и в приведенном ниже коде:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> fruits</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> [</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">апельсин</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">груша</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">яблоко</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">];</span></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> expectedFruit</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">манго</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">fruits</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toContain</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">expectedFruit</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span></code></pre>
<h3 id="тестируем-асинхронный-код">Тестируем асинхронный код<a aria-hidden="true" tabindex="-1" href="#тестируем-асинхронный-код"><span class="icon icon-link"></span></a></h3>
<p>До сих пор мы тестировали синхронный код - выражения, которые возвращают значение до того, как код выполнит следующую строку. Вы также можете использовать Jest для асинхронного кода с помощью <code>async</code>, <code>await</code> или Promises.</p>
<p>Например, в файле <strong>apis.js</strong> есть функция для выполнения <a href="https://kinsta.com/knowledgebase/javascript-http-request/" rel="noopener noreferrer nofollow" target="_blank">API-запроса</a>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">function</span><span style="color:#ADD7FF"> getTodos</span><span style="color:#A6ACCD">() {</span></span>
<span class="line"><span style="color:#5DE4C7C0">	return</span><span style="color:#E4F0FBD0"> fetch</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">https://jsonplaceholder.typicode.com/todos/1</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Функция <code>getTodos</code> отправляет запрос <code>GET</code> на адрес <code>https://jsonplaceholder.typicode.com/todos/1</code>.</p>
<ol>
<li>Создайте файл с именем <strong>apis.test.js</strong> со следующим кодом для тестирования <a href="https://jsonplaceholder.typicode.com/" rel="noopener noreferrer nofollow" target="_blank">поддельного API</a>:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">getTodos</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> require</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">./apis</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">получает объект todo с нужными свойствами</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> ></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">return </span><span style="color:#ADD7FF">getTodos</span><span style="color:#A6ACCD">()</span></span>
<span class="line"><span style="color:#E4F0FB">.</span><span style="color:#ADD7FF">then</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">(response</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB"> = > </span><span style="color:#A6ACCD">{</span></span>
<span class="line"><span style="color:#5DE4C7C0">return</span><span style="color:#E4F0FB"> response</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">json</span><span style="color:#A6ACCD">()</span></span>
<span class="line"><span style="color:#A6ACCD">}</span><span style="color:#E4F0FB">)</span></span>
<span class="line"><span style="color:#E4F0FB">.then((data) = > </span><span style="color:#A6ACCD">{</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">userId</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">id</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">title</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">completed</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span><span style="color:#E4F0FB">)</span></span>
<span class="line"><span style="color:#A6ACCD">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<p>Этот тестовый пример вызывает функцию <code>getTodos</code>, которая получает объект <code>todo</code>. Когда он разрешает Promise, он использует метод <code>.then</code> для получения разрешенного значения.</p>
<p>В этом значении код возвращает <code>response.json()</code>, который является еще одним Promise, преобразующим ответ в формат JSON. Еще один метод <code>.then</code> получает объект JSON, содержащий <code>expect</code> и matchers. Код утверждает, что объект JSON включает пять свойств: <code>userId</code>, <code>id</code>, <code>title</code>, <code>completed</code> и <code>description</code>.</p>
<ol start="2">
<li>Выполните тесты:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-apis-failed.png" alt="Результат Jest-теста показывает неудачу для теста &#x22;получает объект todo с нужными свойствами&#x22; в apis.test.js. Результат показывает, что ожидаемое свойство &#x22;description&#x22; не существует у объекта"><figcaption>Результат Jest-теста показывает неудачу для теста "получает объект todo с нужными свойствами" в apis.test.js. Результат показывает, что ожидаемое свойство "description" не существует у объекта</figcaption></figure>
<p>Результат теста Jest, показывающий неудачный тест для асинхронного кода.</p>
<p>Как видно на скриншоте, тест для <code>getTodos()</code> провалился. Он ожидает свойства <code>description</code>, но API его не возвращает. Имея эту информацию, вы можете попросить команду управления API вашей компании включить это свойство, если оно необходимо приложению, или обновить тесты, чтобы они соответствовали ответу API.</p>
<ol start="3">
<li>Удалите утверждение для свойства <code>description</code> и запустите тесты заново:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-async.png" alt="Результат теста Jest показывает, что тест &#x22;правильно усекает строку&#x22; в string-format.test.js и тест &#x22;получает объект todo с нужными свойствами&#x22; в apis.test.js пройден"><figcaption>Результат теста Jest показывает, что тест "правильно усекает строку" в string-format.test.js и тест "получает объект todo с нужными свойствами" в apis.test.js пройден</figcaption></figure>
<p>Результат теста Jest, показывающий пройденный тест для асинхронного кода.</p>
<p>На скриншоте видно, что все прошло тест.</p>
<ol start="4">
<li>Теперь попробуйте использовать <code>async/await</code> вместо традиционной обработки Promise:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">получает объект todo с нужными свойствами</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FBD0">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> ></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">  const response</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7C0"> await</span><span style="color:#E4F0FBD0"> getTodos</span><span style="color:#A6ACCD">()</span></span>
<span class="line"><span style="color:#E4F0FB">  const data</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7C0"> await</span><span style="color:#E4F0FB"> response</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">json</span><span style="color:#A6ACCD">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADD7FF">  expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB">.</span><span style="color:#ADD7FF">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">userId</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#ADD7FF">  expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB">.</span><span style="color:#ADD7FF">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">id</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#ADD7FF">  expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB">.</span><span style="color:#ADD7FF">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">title</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#ADD7FF">  expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">)</span><span style="color:#E4F0FB">.</span><span style="color:#ADD7FF">toHaveProperty</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">completed</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">})</span></span>
<span class="line"></span></code></pre>
<p>Ключевое слово <code>async</code> теперь находится перед функцией. В коде используется <code>await</code> перед <code>getTodos()</code> и <code>await</code> перед <code>response.json()</code>.</p>
<h2 id="расширенные-возможности-jest">Расширенные возможности Jest<a aria-hidden="true" tabindex="-1" href="#расширенные-возможности-jest"><span class="icon icon-link"></span></a></h2>
<h3 id="mock-функции-и-модули">Mock-функции и модули<a aria-hidden="true" tabindex="-1" href="#mock-функции-и-модули"><span class="icon icon-link"></span></a></h3>
<p>При написании тестов вы можете захотеть протестировать выражение с внешними зависимостями. В некоторых случаях, особенно при модульном тестировании, ваши тесты должны быть изолированы от внешних эффектов. В этом случае вы можете подружить свои функции или модули с Jest, чтобы лучше контролировать свои тесты.</p>
<ol>
<li>Например, рассмотрим файл <strong>functions.js</strong>, содержащий следующий код:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">function</span><span style="color:#ADD7FF"> multipleCalls</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">count</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">callback</span><span style="color:#A6ACCD">) {</span></span>
<span class="line"><span style="color:#A6ACCD">	if (</span><span style="color:#E4F0FB">count</span><span style="color:#91B4D5"> &#x3C;</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">) </span><span style="color:#5DE4C7C0">return</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">	for (</span><span style="color:#91B4D5">let</span><span style="color:#E4F0FB"> counter</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7"> 1</span><span style="color:#A6ACCD">; </span><span style="color:#E4F0FB">counter</span><span style="color:#91B4D5"> &#x3C;=</span><span style="color:#E4F0FB"> count</span><span style="color:#A6ACCD">; </span><span style="color:#E4F0FB">counter</span><span style="color:#91B4D5">++</span><span style="color:#A6ACCD">) {</span></span>
<span class="line"><span style="color:#E4F0FBD0">		callback</span><span style="color:#A6ACCD">();</span></span>
<span class="line"><span style="color:#A6ACCD">	}</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Функция <code>multipleCalls</code> выполняется в зависимости от значения <code>count</code>. Она зависит от функции обратного вызова - внешней зависимости. Ее цель - узнать, правильно ли <code>multipleCalls</code> выполняет внешнюю зависимость.</p>
<ol start="2">
<li>Чтобы подружиться с внешней зависимостью и отслеживать ее состояние в тестовом файле <strong>functions.test.js</strong>, используйте следующий код:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">multipleCalls</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> require</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">./functions</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">функции вызываются несколько раз правильно</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> mockFunction</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">fn</span><span style="color:#A6ACCD">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	multipleCalls</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">5</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">mockFunction</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">mockFunction</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">mock</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">calls</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">length</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">5</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Здесь метод <code>fn</code> объекта <code>jest</code> создает mock-функцию. Затем код выполняет команду <code>multipleCalls</code>, передавая в качестве аргументов <code>5</code> и имитатор функции. Затем утверждается, что <code>mockFunction</code> вызывается пять раз. Свойство <code>mock</code> содержит информацию о том, как код вызывает функцию и возвращаемые значения.</p>
<ol start="3">
<li>При выполнении теста ожидается следующий результат:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-multiplecalls.png" alt="Результат теста Jest показывает, что тест пройден для трех тестов: &#x22;правильно усекает строку&#x22;, &#x22;функции вызываются несколько раз правильно&#x22; и &#x22;получает объект todo с нужными свойствами&#x22;"><figcaption>Результат теста Jest показывает, что тест пройден для трех тестов: "правильно усекает строку", "функции вызываются несколько раз правильно" и "получает объект todo с нужными свойствами"</figcaption></figure>
<p>Успешный результат Jest-теста с имитацией функции.</p>
<p>Как показано, код вызывает <code>mockFunction</code> пять раз.</p>
<p>В коде имитационная функция имитирует внешнюю зависимость. Неважно, что это за внешняя зависимость, когда приложение использует <code>multipleCalls</code> в производстве. Вашему модульному тесту все равно, как работает внешняя зависимость. Он просто проверяет, что <code>multipleCalls</code> работает так, как ожидается.</p>
<ol start="4">
<li>Чтобы подражать модулям, используйте метод <code>mock</code> и передайте путь к файлу, который является модулем:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">truncate</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> require</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">./string-format</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mock</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">./string-format.js</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span></code></pre>
<p>Этот код имитирует все функции, которые экспортирует <strong>string-format.js</strong>, и отслеживает, как часто он их вызывает. Функция <code>truncate</code> модуля становится имитатором функции, в результате чего она теряет свою первоначальную логику. Вы можете узнать, сколько раз <code>truncate</code> выполняется в ваших тестах в свойстве <code>truncate.mock.calls.length</code>.</p>
<p>Если у вас возникла ошибка или ваш код не работает, сравните его с <a href="https://github.com/VirtuaCreative/kinsta-jest-javascript/tree/main" rel="noopener noreferrer nofollow" target="_blank">полной реализацией</a>.</p>
<h2 id="тестирование-react-компонентов-с-помощью-jest-и-библиотеки-тестирования-react">Тестирование React-компонентов с помощью Jest и библиотеки тестирования React<a aria-hidden="true" tabindex="-1" href="#тестирование-react-компонентов-с-помощью-jest-и-библиотеки-тестирования-react"><span class="icon icon-link"></span></a></h2>
<p>Если у вас еще нет проекта, по которому вы могли бы следовать в рамках этого руководства, вы можете использовать <a href="https://github.com/VirtuaCreative/kinsta-jest-react" rel="noopener noreferrer nofollow" target="_blank">этот проект примера React</a> в качестве отправной точки. Ветка <a href="https://github.com/VirtuaCreative/kinsta-jest-react/tree/starter-files" rel="noopener noreferrer nofollow" target="_blank"><code>starter-files</code></a> поможет вам начать составлять код, следуя руководству. Используйте ветку <a href="https://github.com/VirtuaCreative/kinsta-jest-react/tree/main/" rel="noopener noreferrer nofollow" target="_blank"><code>main</code></a> в качестве ссылки, чтобы сверять свой код с полным кодом этого руководства.</p>
<p>Вы можете использовать Jest для тестирования JavaScript-фреймворков, таких как <a href="https://kinsta.com/topic/react/" rel="noopener noreferrer nofollow" target="_blank">React</a>. Когда вы создаете проекты React с помощью <a href="https://create-react-app.dev/" rel="noopener noreferrer nofollow" target="_blank">Create React App</a>, они поддерживают React Testing Library и Jest из коробки. Если вы создаете проект React без Create React App, установите Jest для тестирования React с помощью Babel и <a href="https://github.com/kentcdodds/react-testing-library" rel="noopener noreferrer nofollow" target="_blank">React testing library</a>. Если вы клонируете ветку <code>starter-app</code>, вам не нужно устанавливать зависимости или применять конфигурации.</p>
<ol>
<li>Если вы используете проект-пример, используйте эту команду для установки необходимых зависимостей:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">npm</span><span style="color:#ADD7FF"> install</span><span style="color:#ADD7FF"> --save-dev</span><span style="color:#ADD7FF"> babel-jest</span><span style="color:#ADD7FF"> @babel/preset-env</span><span style="color:#ADD7FF"> @babel/preset-react</span><span style="color:#ADD7FF"> react-testing-library</span></span>
<span class="line"></span></code></pre>
<p>Вы также можете использовать <a href="https://www.npmjs.com/package/enzyme" rel="noopener noreferrer nofollow" target="_blank">Enzyme</a> вместо React Testing Library.</p>
<ol start="2">
<li>Обновите конфигурацию Babel в <strong>babel.config.js</strong> или создайте этот файл, если он не существует:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#E4F0FB">module</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">exports</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">	presets</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> [</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">@babel/preset-env</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span><span style="color:#A6ACCD"> [</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">@babel/preset-react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span><span style="color:#A6ACCD"> {</span><span style="color:#ADD7FF"> runtime</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">automatic</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD"> }]],</span></span>
<span class="line"><span style="color:#A6ACCD">};</span></span>
<span class="line"></span></code></pre>
<ol start="3">
<li>Рассмотрим файл <strong>src/SubmitButton.js</strong>, содержащий следующий код:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">React</span><span style="color:#A6ACCD">,</span><span style="color:#A6ACCD"> {</span><span style="color:#ADD7FF"> useState</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">react</span><span style="color:#A6ACCD">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7">export default </span><span style="color:#91B4D5">function</span><span style="color:#ADD7FF"> SubmitButton</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">props</span><span style="color:#A6ACCD">)</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">  const</span><span style="color:#A6ACCD"> {</span><span style="color:#E4F0FB">id</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> label</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> onSubmit</span><span style="color:#A6ACCD">}</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> props</span></span>
<span class="line"><span style="color:#91B4D5">  const</span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">isLoading</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> setisLoading</span><span style="color:#A6ACCD">]</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> useState</span><span style="color:#A6ACCD">(</span><span style="color:#D0679D">false</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">  const</span><span style="color:#ADD7FF"> submit</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> ()</span><span style="color:#91B4D5"> =></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">    setisLoading</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">true</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">    onSubmit</span><span style="color:#A6ACCD">()</span></span>
<span class="line"><span style="color:#A6ACCD">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">  return</span></span>
<span class="line"></span></code></pre>
<p>Этот компонент <code>SubmitButton</code> получает три реквизита:</p>
<ul>
<li><code>id</code> - идентификатор кнопки.</li>
<li><code>label</code> - Какой текст отображать в кнопке.</li>
<li><code>onSubmit</code> - Какая функция должна срабатывать, когда кто-то нажимает на кнопку.</li>
</ul>
<p>Код присваивает параметр <code>id</code> атрибуту <code>data-testid</code>, который идентифицирует элемент для тестирования.</p>
<p>Компонент также отслеживает состояние <code>isLoading</code> и обновляет его до <code>true</code>, когда кто-то нажимает на кнопку.</p>
<ol start="4">
<li>Создайте тест для этого компонента. Поместите следующий код в файл <strong>SubmitButton.test.js</strong>:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> fireEvent</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> render</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> screen</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">@testing-library/react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">@testing-library/jest-dom</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">SubmitButton</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">./SubmitButton</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Кнопка SubmitButton становится неактивной после нажатия</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> submitMock</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">fn</span><span style="color:#A6ACCD">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	render</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">SubmitButton</span><span style="color:#91B4D5;font-style:italic"> id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">submit-details</span><span style="color:#A6ACCD">"</span><span style="color:#91B4D5;font-style:italic"> label</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Submit</span><span style="color:#A6ACCD">"</span><span style="color:#91B4D5;font-style:italic"> onSubmit</span><span style="color:#91B4D5">=</span><span style="color:#E4F0FB">{submitMock} /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">screen</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">submit-details</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)).</span><span style="color:#E4F0FB">not</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">toBeDisabled</span><span style="color:#A6ACCD">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">	fireEvent</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">submit</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">screen</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">submit-details</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">screen</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">submit-details</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)).</span><span style="color:#E4F0FBD0">toBeDisabled</span><span style="color:#A6ACCD">();</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Приведенный выше код рендерит компонент <code>SubmitButton</code> и использует метод запроса <code>screen.getByTestId</code> для получения узла DOM по атрибуту <code>data-testid</code>.</p>
<p>Первый <code>expect</code> - <code>getByTestId("submit-details")</code> и использует модификатор <code>not</code> и матчер <code>toBeDisabled</code> (раскрывается из <code>react-testing-library</code>) для утверждения, что кнопка не отключена. Используйте модификатор <code>not</code> с каждым матчером, чтобы утверждать обратное матчеру.</p>
<p>Затем код запускает событие `submit на компоненте и проверяет, что кнопка отключена. Больше пользовательских матчиков можно найти в <a href="https://github.com/testing-library/jest-dom#custom-matchers" rel="noopener noreferrer nofollow" target="_blank">документации по библиотеке тестирования</a>.</p>
<ol start="5">
<li>Теперь запустите тесты. Если вы клонировали ветку <code>starter-files</code>, убедитесь, что все зависимости проекта установлены, выполнив <code>npm install</code> перед запуском тестов.</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-truncate-react.png" alt="Результат теста Jest показывает прохождение для четырех тестов: &#x22;правильно усекает строку&#x22;, &#x22;функции вызываются несколько раз&#x22;, &#x22;получает объект todo с нужными свойствами&#x22; и &#x22;кнопка SubmitButton становится неактивной после нажатия&#x22;"><figcaption>Результат теста Jest показывает прохождение для четырех тестов: "правильно усекает строку", "функции вызываются несколько раз", "получает объект todo с нужными свойствами" и "кнопка SubmitButton становится неактивной после нажатия"</figcaption></figure>
<p>Результат Jest-теста, показывающий, что тест компонента react пройден.</p>
<h3 id="запуск-отчетов-о-покрытии-кода">Запуск отчетов о покрытии кода<a aria-hidden="true" tabindex="-1" href="#запуск-отчетов-о-покрытии-кода"><span class="icon icon-link"></span></a></h3>
<p>Jest также предлагает отчеты о покрытии кода, чтобы показать, какую часть вашего проекта вы тестируете.</p>
<ol>
<li>Передайте Jest опцию <code>--coverage</code>. В сценарии Jest в файле <strong>package.json</strong> (в проекте JavaScript) обновите команду Jest с этой опцией покрытия:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">scripts</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">  "</span><span style="color:#E4F0FB">test</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">jest --coverage</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>Запустите <code>npm run test</code> для проверки вашего кода. Вы получите отчет, как показано ниже:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-coverage-report.png" alt="Результат тестирования Jest, показывающий покрытие для четырех тестов. Результат показывает, что &#x22;SubmitButton.js&#x22; имеет 100 % покрытие, а string-format.js - 76,92 %. Он также показывает, что в string-format.js не покрыты строки 7 и 12."><figcaption>Результат тестирования Jest, показывающий покрытие для четырех тестов. Результат показывает, что "SubmitButton.js" имеет 100 % покрытие, а string-format.js - 76,92 %. Он также показывает, что в string-format.js не покрыты строки 7 и 12.</figcaption></figure>
<p>Отчет об успешном покрытии Jest для каждого тестового костюма.</p>
<p>Этот отчет показывает, что Jest протестировал 100 % функций в <strong>SubmitButton.js</strong> и <strong>string-format.js</strong>. Он также показывает, что Jest не проверил ни одного утверждения и строки в <strong>string-format.js</strong>. Покрытие тестов показывает, что непокрытыми строками в <strong>string-format.js</strong> являются 7 и 12.</p>
<p>В строке 7 функция <code>return str</code> в функции <code>truncate</code> не выполняется, потому что условие <code>if (str.length &#x3C;= count)</code> возвращает <code>false</code>.</p>
<p>В строке 12, также в функции <code>truncate</code>, <code>return substring</code> не выполняется, потому что условие <code>if (!withEllipsis)</code> возвращает <code>false</code>.</p>
<h2 id="интеграция-jest-с-процессом-разработки">Интеграция Jest с процессом разработки<a aria-hidden="true" tabindex="-1" href="#интеграция-jest-с-процессом-разработки"><span class="icon icon-link"></span></a></h2>
<p>Давайте посмотрим, как вы можете интегрировать эти тесты для улучшения вашего рабочего процесса разработки.</p>
<h3 id="запуск-тестов-в-режиме-наблюдения">Запуск тестов в режиме наблюдения<a aria-hidden="true" tabindex="-1" href="#запуск-тестов-в-режиме-наблюдения"><span class="icon icon-link"></span></a></h3>
<p>Вместо того чтобы выполнять тесты вручную, вы можете запускать их автоматически при изменении кода, используя режим watch.</p>
<ol>
<li>Чтобы включить режим наблюдения, обновите командный сценарий Jest в <strong>package.json</strong> (в проекте JavaScript), добавив опцию <code>--watchAll</code>:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">scripts</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">test</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">jest --coverage --watchAll</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>Запустите <code>npm run test</code>. Это запустит Jest в режиме просмотра:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-watch-mode.png" alt="Jest в режиме просмотра, показывающий четыре пройденных теста, а также список команд для использования в режиме просмотра. Он показывает команду f, для запуска только проваленных тестов; o, для запуска только тестов, связанных с измененными файлами; p, для фильтрации по шаблону regex имени файла; t, для фильтрации по шаблону regex имени теста; q, для завершения режима просмотра; Enter, для запуска запуска теста."><figcaption>Jest в режиме просмотра, показывающий четыре пройденных теста, а также список команд для использования в режиме просмотра. Он показывает команду f, для запуска только проваленных тестов; o, для запуска только тестов, связанных с измененными файлами; p, для фильтрации по шаблону regex имени файла; t, для фильтрации по шаблону regex имени теста; q, для завершения режима просмотра; Enter, для запуска запуска теста.</figcaption></figure>
<p>Запуск Jest в режиме просмотра.</p>
<p>Тесты запускаются каждый раз, когда вы изменяете проект. Такой подход способствует непрерывной обратной связи по мере создания приложения.</p>
<h3 id="настройка-крючков-предварительного-коммита">Настройка крючков предварительного коммита<a aria-hidden="true" tabindex="-1" href="#настройка-крючков-предварительного-коммита"><span class="icon icon-link"></span></a></h3>
<p>В средах Git хуки выполняют скрипты каждый раз, когда происходит определенное событие (например, pull, push или commit). Хуки предварительной фиксации определяют, какие скрипты запускаются для события предварительной фиксации (которое код запускает перед фиксацией).</p>
<p>Коммит проходит успешно, только если скрипт не выдает ошибку.</p>
<p>Запуск Jest перед pre-commit гарантирует, что ни один из ваших тестов не сработает до фиксации.</p>
<p>Вы можете использовать различные библиотеки для установки <a href="https://kinsta.com/blog/git-hooks/" rel="noopener noreferrer nofollow" target="_blank">git hooks</a> в вашем проекте, например <a href="https://www.npmjs.com/package/ghooks" rel="noopener noreferrer nofollow" target="_blank">ghooks</a>.</p>
<ol>
<li>Установите <code>ghooks</code> в разделе <code>devDependencies</code>:</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">npm</span><span style="color:#ADD7FF"> install</span><span style="color:#ADD7FF"> ghooks</span><span style="color:#ADD7FF"> --save-dev</span></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>
<p>Добавьте объект <code>configs</code> в верхний уровень вашего файла <strong>package.json</strong> (в проекте JavaScript).</p>
</li>
<li>
<p>Добавьте объект <code>ghooks</code> под <code>configs</code>.</p>
</li>
<li>
<p>Добавьте свойство с ключом <code>pre-commit</code> и значением <code>jest</code>.</p>
</li>
</ol>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">{</span></span>
<span class="line"><span style="color:#D0679D">...</span></span>
<span class="line"><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">config</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">"</span><span style="color:#ADD7FF">ghooks</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: {</span></span>
<span class="line"><span style="color:#A6ACCD">"</span><span style="color:#91B4D5">pre-commit</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">jest</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"><span style="color:#A6ACCD">},</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ol start="5">
<li>Зафиксируйте код. Код запускает хук pre-commit, который выполняет Jest:</li>
</ol>
<figure class="igorlov-figure"><img src="https://kinsta.com/wp-content/uploads/2023/08/jest-test-pre-commit.png" alt="Выполнение Jest на этапе предкоммита. При выполнении коммита с помощью git commit -m в терминале выполняется Jest и отображаются результаты тестов"><figcaption>Выполнение Jest на этапе предкоммита. При выполнении коммита с помощью git commit -m в терминале выполняется Jest и отображаются результаты тестов</figcaption></figure>
<p>Запуск Jest во время предварительной коммисии с помощью ghooks.</p>
<h2 id="резюме">Резюме<a aria-hidden="true" tabindex="-1" href="#резюме"><span class="icon icon-link"></span></a></h2>
<p>Теперь вы знаете, как интегрировать Jest в рабочий процесс разработки, чтобы он автоматически выполнялся каждый раз, когда вы вносите изменения. Такой подход обеспечивает непрерывную обратную связь, чтобы вы могли быстро исправить любые проблемы в коде перед выпуском изменений в производство.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span></span></span></code></pre> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Как тестировать приложения с помощью Jest&#38;url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest&#38;title=Как тестировать приложения с помощью Jest&#38;summary=Тестирование программного обеспечения [https://kinsta.com/blog/performancetestingtools/] жизненно необходимо для того, чтобы ваши приложения работали так, ка&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/kak-testyrovat-prylozhenyia-s-pomoschiu-jest&#38;media=&#38;description=Тестирование программного обеспечения [https://kinsta.com/blog/performancetestingtools/] жизненно необходимо для того, чтобы ваши приложения работали так, ка" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/kak-udalyt-predvaryteln-e-versyy-razvert-vanyi-vercel-yz-github-actions" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Как удалить предварительные версии развертываний Vercel из GitHub Actions </a> <a href="/blog/kak-sozdat-vspl-vaiuschyi-modal-na-javascript-s-nulia" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Как создать всплывающий модал на JavaScript с нуля </a> </nav>  </div> </article> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.svLg6TOn.js" component-export="default" renderer-url="/_astro/client.D9Vng9vH.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> <astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.BwogX8bT.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  </div> <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-extrabold lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>