<!DOCTYPE html><html lang="ru"> <head><title>Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок | Игорь Горлов - Фронтeндер</title><link rel="canonical" href="https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok"><meta name="description" content="Руководство по Python с полным кодом Окончательный код: E2B Cookbook  AI GitHub Developer Что мы будем делать В этом руководстве мы создадим собственног"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.5.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.DbkvWnAm.css" />
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw);padding-left:min(2rem,1.2125rem + 1.05vw);padding-right:min(2rem,1.2125rem + 1.05vw);padding-top:1rem;padding-bottom:1rem}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.breadcrumbs__link[data-astro-cid-vcbh62el]{border-radius:9999px;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover{--tw-bg-opacity: 1;background-color:#fce4e1;background-color:rgba(252,228,225,var(--tw-bg-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]{padding:.125rem .75rem}.breadcrumbs__link[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#6a6a6a;background-color:rgba(106,106,106,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#8a8a93;background-color:rgba(138,138,147,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}
</style>
<link rel="stylesheet" href="/_astro/_single_.BCoIA8H8.css" />
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#020202;border-color:rgba(2,2,2,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-533071ec]{margin:auto;margin-top:1.25rem;max-width:42rem;--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.comments:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame[data-v-533071ec]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
.theme-toggle[data-v-8d8d9c54]{width:1.25rem;height:1.25rem}
</style><script type="module" src="/_astro/hoisted.DYPnEDpO.js"></script><style>[data-astro-transition-scope="astro-vgmtzcrq-1"] { view-transition-name: blog-image-sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-14 font-inter text-dark fluid:text-lg dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> </button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> </button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/projects" class="nav__link" data-astro-cid-7wkmezxd> Работы. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты. </a> </li> </ul> </nav> </div>   <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var v=Object.defineProperty;var A=(c,s,a)=>s in c?v(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a;var d=(c,s,a)=>(A(c,typeof s!="symbol"?s+"":s,a),a);var u;{let c={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},s=t=>{let[e,n]=t;return e in c?c[e](n):void 0},a=t=>t.map(s),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,s(n)]));customElements.get("astro-island")||customElements.define("astro-island",(u=class extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var f;if(!this.hydrator||!this.isConnected)return;let e=(f=this.parentElement)==null?void 0:f.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),r={},l=this.querySelectorAll("template[data-astro-template]");for(let o of l){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("data-astro-template")||"default"]=o.innerHTML,o.remove())}for(let o of n){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("name")||"default"]=o.innerHTML)}let h;try{h=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(o){let i=this.getAttribute("component-url")||"<unknown>",b=this.getAttribute("component-export");throw b&&(i+=` (export ${b})`),console.error(`[hydrate] Error parsing props for component ${i}`,this.getAttribute("props"),o),o}let p;await this.hydrator(this)(this.Component,h,r,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),n.disconnect(),this.childrenConnectedCallback()},n=new MutationObserver(()=>{var r;((r=this.lastChild)==null?void 0:r.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});n.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}try{await Astro[n](async()=>{let r=this.getAttribute("renderer-url"),[l,{default:h}]=await Promise.all([import(this.getAttribute("component-url")),r?import(r):()=>()=>{}]),p=this.getAttribute("component-export")||"default";if(!p.includes("."))this.Component=l[p];else{this.Component=l;for(let y of p.split("."))this.Component=this.Component[y]}return this.hydrator=h,this.hydrate},e,this)}catch(r){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,r)}}attributeChangedCallback(){this.hydrate()}},d(u,"observedAttributes",["props"]),u))}})();</script><astro-island uid="IJ3dh" component-url="/_astro/ThemeToggle.kpN4JrWQ.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-rq644orq&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}"></astro-island> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <div class="blocks__container container"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <ol class="breadcrumbs__list" role="list" data-astro-cid-vcbh62el> <li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </nav>  </div> <div class="blocks__container container"> <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/учебник" class="categories__link" data-astro-cid-axzg2cw6> Учебник  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/python" data-astro-cid-axzg2cw6> Python </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/ai" data-astro-cid-axzg2cw6> Ai </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 21 дек., 2023 by Игорь Горлов </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div>  <figure class="article__image" data-astro-cid-axzg2cw6> <picture> <source srcset="/_astro/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok-Dec-21-2023.fmBQbZeW_1CqR2a.avif" type="image/avif"><source srcset="/_astro/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok-Dec-21-2023.fmBQbZeW_AY9En.webp" type="image/webp"> <img src="/_astro/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok-Dec-21-2023.fmBQbZeW_kXJ7M.png" alt="Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок" class="aspect-auto h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-vgmtzcrq-1" width="1200" height="500" decoding="async"> </picture> </figure>  <div class="article__content prose prose-zinc max-w-full break-words dark:prose-invert prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:-mx-12 prose-figure:w-screen prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div id="adfox_17062261612859555"></div> <script>(function(){const blockId = "adfox_17062261612859555";

	window.yaContextCb = window.yaContextCb || [];
	window.yaContextCb.push(() => {
		Ya.adfoxCode.createAdaptive(
			{
				ownerId: 1493338,
				containerId: blockId,
				params: {
					p1: 'dawgg',
					p2: 'p',
				},
			},
			['desktop', 'tablet', 'phone'],
			{
				tabletWidth: 830,
				phoneWidth: 480,
				isAutoReloads: true,
			},
		);
	});
})();</script> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок&#38;url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok&#38;title=Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок&#38;summary=Руководство по Python с полным кодом Окончательный код: E2B Cookbook  AI GitHub Developer Что мы будем делать В этом руководстве мы создадим собственног&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok&#38;media=&#38;description=Руководство по Python с полным кодом Окончательный код: E2B Cookbook  AI GitHub Developer Что мы будем делать В этом руководстве мы создадим собственног" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open class="toc px-5 border border-gray-light lg:px-10 py-2 cursor-pointer"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#1-создать-файлы">1. Создать файлы</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#2-определение-действий-для-ассистента">2. Определение действий для ассистента</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#21-импорт-пакетов">2.1 Импорт пакетов</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#22-печать-действий-в-песочнице">2.2 Печать действий в песочнице</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#23-определение-действий-для-разработчика-ии">2.3 Определение действий для разработчика ИИ</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#3-создание-помощника">3. Создание помощника</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#31-импорт-пакетов">3.1 Импорт пакетов</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#32-определите-помощника">3.2 Определите помощника</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#33-запись-системной-подсказки">3.3 Запись системной подсказки</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#4-создание-основной-программы">4. Создание основной программы</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#41-импорт-пакетов">4.1 Импорт пакетов</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#42-получение-помощника">4.2 Получение помощника</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#42-запрос-пользователю-репозитория-github-аутентификации-и-задания">4.2 Запрос пользователю репозитория GitHub, аутентификации и задания</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#43-настройка-git">4.3 Настройка git</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#44-клонирование-репозитория">4.4 Клонирование репозитория</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#45-создание-песочницы">4.5 Создание песочницы</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#46-создание-песочницы">4.6 Создание песочницы</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#вывод">Вывод</a></li></ol></details open><p>Руководство по Python с полным кодом</p>
<p>🏁 Окончательный код: E2B Cookbook - AI GitHub Developer</p>
<p>Что мы будем делать</p>
<p>В этом руководстве мы создадим собственного разработчика ИИ, который клонирует выбранный вами репозиторий GitHub в свою удаленную облачную среду, работает над ним, а затем делает запрос на притяжение с изменениями.</p>
<p>Для удаленного выполнения действий ИИ-разработчика мы используем E2B Sandboxes, а для ИИ-ассистента - OpenAI’s Assistants API.</p>
<p>Полный финальный код можно найти здесь. 🏁</p>
<p>Вот пример проекта Next.js, созданного разработчиком ИИ.</p>
<p>Предварительные условия</p>
<p>Мы используем два ключевых понятия:</p>
<p>OpenAI API - найдите свой ключ API здесь, прочитайте введение в Assistants API, и вызов функций.</p>
<p>E2B Sandbox - найти бесплатный API-ключ можно здесь, прочитать, как работают песочницы E2B, можно здесь.</p>
<h2 id="1-создать-файлы">1. Создать файлы<a aria-hidden="true" tabindex="-1" href="#1-создать-файлы"><span class="icon icon-link"></span></a></h2>
<p>Давайте начнем с создания файлов:</p>
<p><code>main.py</code> для основной программы</p>
<p><code>assistant.py</code> для определения поведения AI разработчика</p>
<p><code>actions.py</code> для определения действий (функций Python) для разработчика.</p>
<p>Подготовьте также файл <code>.env</code>, в котором хранятся ключи API.</p>
<h2 id="2-определение-действий-для-ассистента">2. Определение действий для ассистента<a aria-hidden="true" tabindex="-1" href="#2-определение-действий-для-ассистента"><span class="icon icon-link"></span></a></h2>
<p>В файле <code>actions.py</code> мы определяем Python-функции как выполняемые действия для ИИ-ассистента и LLM.</p>
<p>Сначала импортируем E2B Sandbox и все остальное, что нам нужно.</p>
<p>Здесь мы используем песочницу E2B ”по умолчанию”. Для различных случаев использования мы можем использовать различные пользовательские песочницы с дополнительными пакетами. Например, песочницу интерпретатора кода, полезную для расширенного анализа данных, или песочницу облачного браузера.</p>
<h3 id="21-импорт-пакетов">2.1 Импорт пакетов<a aria-hidden="true" tabindex="-1" href="#21-импорт-пакетов"><span class="icon icon-link"></span></a></h3>
<p>Мы используем библиотеку Python <code>Rich</code> для форматирования терминального вывода программы.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> os </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> random </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> string </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> typing </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Any, Dict </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> e2b </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Sandbox </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> rich.console </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Console </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> rich.theme </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Theme</span></span>
<span class="line"></span></code></pre>
<h3 id="22-печать-действий-в-песочнице">2.2 Печать действий в песочнице<a aria-hidden="true" tabindex="-1" href="#22-печать-действий-в-песочнице"><span class="icon icon-link"></span></a></h3>
<p>Мы определяем директорию, в которую разработчик AI будет клонировать пользовательское репо в песочнице. Мы добавляем способ печати того, что происходит в песочнице (и выбираем тему для печати, используя <code>Rich</code>).</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">REPO_DIRECTORY </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">/home/user/repo</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">custom_theme </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> Theme(</span></span>
<span class="line"><span style="color:#A6ACCD">    {</span></span>
<span class="line"><span style="color:#A6ACCD">        "</span><span style="color:#5DE4C7">sandbox_action</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">bold #E57B00</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,  </span><span style="color:#767C9DB0;font-style:italic"># Корректируем цвет по необходимости</span></span>
<span class="line"><span style="color:#A6ACCD">    }</span></span>
<span class="line"><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">console </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> Console(</span><span style="color:#E4F0FB">theme</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">custom_theme)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Create a logger instance</span></span>
<span class="line"><span style="color:#A6ACCD">logger </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> logging.getLogger(__name__)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> print_sandbox_action</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">action_type</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">action_message</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Add logging statements to log the action type and message</span></span>
<span class="line"><span style="color:#A6ACCD">    logger.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Action type: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">action_type</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    logger.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Action message: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">action_message</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">    console.print(</span></span>
<span class="line"><span style="color:#91B4D5">        f</span><span style="color:#5DE4C7">"[sandbox_action] [Sandbox Action][/sandbox_action] </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">action_type</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">action_message</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#A6ACCD">    )</span></span>
<span class="line"></span></code></pre>
<h3 id="23-определение-действий-для-разработчика-ии">2.3 Определение действий для разработчика ИИ<a aria-hidden="true" tabindex="-1" href="#23-определение-действий-для-разработчика-ии"><span class="icon icon-link"></span></a></h3>
<p>Затем мы определяем действия, которые может использовать разработчик ИИ. В дальнейшем вы можете модифицировать программу, добавив дополнительные действия для вашего конкретного случая использования по тому же принципу. Мы добавляем действия, которые позволяют разработчику ИИ делать следующее:</p>
<p>Создать директорию в удаленной песочнице Сохранить содержимое (например, код) в файл Перечислить файлы в директории Прочитать содержимое файлов Зафиксировать изменения Сделать запрос на извлечение.</p>
<p>”Действия” - это функции Python, автоматически вызываемые в программе с помощью E2B SDK. Внутри действий
Каждому действию соответствует ровно одна функция OpenAI (см. следующие шаги руководства).</p>
<p>Для каждого действия необходимо указать аргументы и добавить печать соответствующей информации. Например, для <code>list_files</code> имеет смысл возвращать список файлов в папке.<br>
Внутри действий вызываются различные операции внутри песочницы.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#767C9DB0;font-style:italic"># Список действий для помощника</span></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> create_directory</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    directory </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Creating directory:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, directory)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">    try</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        sandbox.filesystem.make_dir(directory)</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">success</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#5DE4C7C0">    except</span><span style="color:#A6ACCDC0"> Exception</span><span style="color:#5DE4C7C0"> as</span><span style="color:#A6ACCD"> e:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">e</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> save_content_to_file</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    path </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#A6ACCD">    content </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">content</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Saving content to:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, path)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">    try</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        dir </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> os.path.dirname(path)</span></span>
<span class="line"><span style="color:#A6ACCD">        sandbox.filesystem.make_dir(</span><span style="color:#E4F0FBD0">dir</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">        sandbox.filesystem.write(path, content)</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">success</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#5DE4C7C0">    except</span><span style="color:#A6ACCDC0"> Exception</span><span style="color:#5DE4C7C0"> as</span><span style="color:#A6ACCD"> e:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">e</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> list_files</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    path </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Listing files on path:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, path)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">    try</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        files </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.filesystem.list(path)</span></span>
<span class="line"><span style="color:#A6ACCD">        response </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> "</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">.join([</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"dir: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">file.name</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#5DE4C7C0"> if</span><span style="color:#A6ACCD"> file.is_dir </span><span style="color:#5DE4C7C0">else</span><span style="color:#A6ACCD"> file.name </span><span style="color:#5DE4C7C0">for</span><span style="color:#A6ACCD"> file </span><span style="color:#5DE4C7C0">in</span><span style="color:#A6ACCD"> files])</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> response</span></span>
<span class="line"><span style="color:#5DE4C7C0">    except</span><span style="color:#A6ACCDC0"> Exception</span><span style="color:#5DE4C7C0"> as</span><span style="color:#A6ACCD"> e:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">e</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> read_file</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    path </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Чтение файла по пути:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, path)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">    try</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> sandbox.filesystem.read(path)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    except</span><span style="color:#A6ACCDC0"> Exception</span><span style="color:#5DE4C7C0"> as</span><span style="color:#A6ACCD"> e:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">e</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> commit</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    repo_directory </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">/home/user/repo</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">    commit_message </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">message</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Committing with the message:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, commit_message)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#A6ACCD">    git_add_proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"git -C </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_directory</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> add ."</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> git_add_proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        error </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error adding files to staging: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_add_proc.stdout</span><span style="color:#5DE4C7">}</span><span style="color:#5FB3A1">\n\t</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_add_proc.stderr</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#E4F0FBD0">        print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\t</span><span style="color:#5DE4C7">Error:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, error)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> error</span></span>
<span class="line"><span style="color:#A6ACCD">    git_commit_proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"git -C </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_directory</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> commit -m '</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">commit_message</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">'"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> git_commit_proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        error </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Error committing changes: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_commit_proc.stdout</span><span style="color:#5DE4C7">}</span><span style="color:#5FB3A1">\n\t</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_commit_proc.stderr</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#E4F0FBD0">        print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\t</span><span style="color:#5DE4C7">Error:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, error)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span><span style="color:#A6ACCD"> error</span></span>
<span class="line"><span style="color:#5DE4C7C0">    return</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">success</span><span style="color:#A6ACCD">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> make_pull_request</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">: Sandbox, </span><span style="color:#E4F0FB">args</span><span style="color:#A6ACCD">: Dict[</span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">, Any]) -> </span><span style="color:#A6ACCDC0">str</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    base_branch </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">main</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">    random_letters </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> ""</span><span style="color:#A6ACCD">.join(random.choice(string.ascii_letters) </span><span style="color:#5DE4C7C0">for</span><span style="color:#A6ACCD"> _ </span><span style="color:#5DE4C7C0">in</span><span style="color:#E4F0FBD0"> range</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">5</span><span style="color:#A6ACCD">))</span></span>
<span class="line"><span style="color:#A6ACCD">    new_branch_name </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"ai-developer-</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">random_letters</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#A6ACCD">    title </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> args[</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">title</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#A6ACCD">    body </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> ""</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Making a pull request</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"from '</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">new_branch_name</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">' to '</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">base_branch</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">'"</span><span style="color:#A6ACCD">)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#A6ACCD">    git_checkout_proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"git -C </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">REPO_DIRECTORY</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> checkout -b </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">new_branch_name</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> git_checkout_proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        error </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"Ошибка создания новой ветки git </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">new_branch_name</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_checkout_proc.stdout</span><span style="color:#5DE4C7">}</span><span style="color:#5FB3A1">\n\t</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">git_checkout_proc.stderr</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#E4F0FBD0">        print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\t</span><span style="color:#5DE4C7">Error:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, error)  </span><span style="color:#767C9DB0;font-style:italic"># Add logging statement</span></span>
<span class="line"><span style="color:#5DE4C7C0">        return</span></span>
<span class="line"></span></code></pre>
<h2 id="3-создание-помощника">3. Создание помощника<a aria-hidden="true" tabindex="-1" href="#3-создание-помощника"><span class="icon icon-link"></span></a></h2>
<p>Теперь мы создадим самого разработчика ИИ внутри файла <code>assistant.py</code>. Особенностью API ассистентов OpenAI, которой мы воспользуемся, является вызов функций.</p>
<p>Функция вызова функций дает нашему ИИ-ассистенту возможность принимать решения о вызове действий в песочнице, которые мы определили в файле <code>actions.py</code>.</p>
<h3 id="31-импорт-пакетов">3.1 Импорт пакетов<a aria-hidden="true" tabindex="-1" href="#31-импорт-пакетов"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> typing </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> List </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> dotenv </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> load_dotenv </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> openai </span><span style="color:#5DE4C7C0">from</span><span style="color:#A6ACCD"> openai.types.beta.assistant_create_params </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Tool load_dotenv()</span></span>
<span class="line"></span></code></pre>
<h3 id="32-определите-помощника">3.2 Определите помощника<a aria-hidden="true" tabindex="-1" href="#32-определите-помощника"><span class="icon icon-link"></span></a></h3>
<p>Теперь мы создадим помощника и оснастим его шестью функциями (помните, это функции OpenAI, а не Python), каждая из которых соответствует одному действию, определенному ранее в файле <code>actions.py</code>.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> create_assistant</span><span style="color:#A6ACCD">(): client </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> openai.Client() functions: List[Tool] </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> [ { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">create_directory</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Создать каталог</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">параметры</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Путь к создаваемому каталогу</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">save_content_to_file</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Сохранить содержимое (код или текст) в файл</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">parameters</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">content</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Содержимое для сохранения</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Путь к файлу, включая расширение</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">content</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], }, }, }, { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">list_files</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Список файлов в каталоге</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">parameters</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Путь к каталогу</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">read_file</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Чтение файла</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">parameters</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Путь к файлу</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">path</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">commit</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Зафиксировать изменения в репо</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">parameters</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">message</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Сообщение о фиксации</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, }, }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">message</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">function</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">make_pull_request</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Создает новую ветку и делает pull request</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">parameters</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">object</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">properties</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">title</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: { </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">type</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">string</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">description</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Название запроса</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, } }, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">required</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">title</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">], } }, }, }, ]</span></span>
<span class="line"></span></code></pre>
<h3 id="33-запись-системной-подсказки">3.3 Запись системной подсказки<a aria-hidden="true" tabindex="-1" href="#33-запись-системной-подсказки"><span class="icon icon-link"></span></a></h3>
<p>Все еще находясь внутри функции <code>create_assistant()</code>, мы даем указания помощнику и выбираем его параметры. После запуска этого файла он выведет идентификатор помощника, который мы можем сохранить в качестве переменной окружения.<br>
Не забудьте повторно запустить файл с ассистентом и создать новый ID при каждом обновлении.</p>
<p>💡 Совет: При необходимости корректируйте инструкции. Например, вы можете решитьИдеально, насколько разработчик ИИ вовлечен в дискуссию с пользователем и не ограничивается ли он выполнением поставленной задачи.<br>
Здесь может пригодиться руководство по разработке подсказок OpenAI.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">ai_developer </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> client.beta.assistants.create(</span><span style="color:#E4F0FB">instructions</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"""</span><span style="color:#5DE4C7">Вы - разработчик ИИ. Вы помогаете пользователю решать его задачи, связанные с кодированием в его кодовой базе. Предоставленная кодовая база находится в /home/user/repo. Получив задание по кодированию, работайте над ним до завершения, коммитите его и делайте pull request.  Если вы столкнулись с проблемой, сообщите об этом незамедлительно, пожалуйста.  Вы можете создавать и сохранять содержимое (текст или код) в указанном файле (или создавать новый файл), перечислять файлы в заданном каталоге, читать файлы, фиксировать изменения и делать запросы на исправление. Всегда следите за тем, чтобы записывать содержимое в кодовую базу.  По умолчанию после выполнения любого действия с репозиторием всегда либо фиксируйте свои изменения, либо делайте запрос на притяжение. Это поможет в проверке и слиянии ваших изменений. Назовите PR в соответствии с внесенными изменениями.  Ведите себя профессионально, избегайте споров и сосредоточьтесь на выполнении задания.  По завершении задания всегда указывайте ссылку на сделанный вами запрос (если вы его сделали). Кроме того, будьте готовы к дискуссиям; не все, что пишет пользователь, подразумевает изменения в репозитории. Например, если пользователь пишет "спасибо", вы можете просто ответить "не за что". Но по умолчанию, если вам поставили задачу, вы должны немедленно выполнить ее в предоставленном репо, а не только рассказывать о своем плане. </span><span style="color:#A6ACCD">"""</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">name</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">AI Developer</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">tools</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">functions, </span><span style="color:#E4F0FB">model</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">gpt-4-1106-preview</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Add logging statements</span></span>
<span class="line"><span style="color:#A6ACCD">logger </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> logging.getLogger(__name__)</span></span>
<span class="line"><span style="color:#A6ACCD">logger.setLevel(logging.DEBUG)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Example logging statements</span></span>
<span class="line"><span style="color:#A6ACCD">logger.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Debug message</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">logger.info(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Info message</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">logger.warning(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Warning message</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">logger.error(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Error message</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">AI Developer Assistant created, copy its id to .env file:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">print</span><span style="color:#A6ACCD">(ai_developer.id)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">if</span><span style="color:#A6ACCD"> __name__ </span><span style="color:#91B4D5">==</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">__main__</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    create_assistant()</span></span>
<span class="line"></span></code></pre>
<h2 id="4-создание-основной-программы">4. Создание основной программы<a aria-hidden="true" tabindex="-1" href="#4-создание-основной-программы"><span class="icon icon-link"></span></a></h2>
<p>Теперь мы создадим основную программу. Ассистент вызывает функции OpenAI через JSON, который E2B SDK разбирает и автоматически вызывает определенные действия.</p>
<h3 id="41-импорт-пакетов">4.1 Импорт пакетов<a aria-hidden="true" tabindex="-1" href="#41-импорт-пакетов"><span class="icon icon-link"></span></a></h3>
<p>Сначала мы импортируем необходимые пакеты - <code>openai</code>, <code>e2b Sandbox</code> и действия, которые мы создали в другом файле.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> os</span></span>
<span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> dotenv </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> load_dotenv</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> e2b </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Sandbox</span></span>
<span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> openai</span></span>
<span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> time</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> ai_github_developer.actions </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> (</span></span>
<span class="line"><span style="color:#A6ACCD">    create_directory,</span></span>
<span class="line"><span style="color:#A6ACCD">    read_file,</span></span>
<span class="line"><span style="color:#A6ACCD">    save_content_to_file,</span></span>
<span class="line"><span style="color:#A6ACCD">    list_files,</span></span>
<span class="line"><span style="color:#A6ACCD">    commit,</span></span>
<span class="line"><span style="color:#A6ACCD">    make_pull_request,</span></span>
<span class="line"><span style="color:#A6ACCD">    REPO_DIRECTORY,</span></span>
<span class="line"><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> rich </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> print</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> rich.console </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Console</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> rich.theme </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Theme</span></span>
<span class="line"><span style="color:#5DE4C7">from</span><span style="color:#A6ACCD"> rich.prompt </span><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> Prompt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Set up logging</span></span>
<span class="line"><span style="color:#A6ACCD">logging.basicConfig(</span><span style="color:#E4F0FB">level</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">logging.DEBUG)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> MyPrompt</span><span style="color:#A6ACCD">(</span><span style="color:#ADD7FF">Prompt</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    prompt_suffix </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> ""</span></span>
<span class="line"><span style="color:#A6ACCD">    custom_theme </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> Theme(</span></span>
<span class="line"><span style="color:#A6ACCD">        {</span></span>
<span class="line"><span style="color:#A6ACCD">            "</span><span style="color:#5DE4C7">theme</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">bold #666666</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">        }</span></span>
<span class="line"><span style="color:#A6ACCD">    )</span></span>
<span class="line"><span style="color:#A6ACCD">    console </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> Console(</span><span style="color:#E4F0FB">theme</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">custom_theme)</span></span>
<span class="line"></span></code></pre>
<h3 id="42-получение-помощника">4.2 Получение помощника<a aria-hidden="true" tabindex="-1" href="#42-получение-помощника"><span class="icon icon-link"></span></a></h3>
<p>Мы вызываем ассистента по его ID и используем OpenAI API для получения ассистента. Не забудьте сохранить ID помощника, ключ OpenAI API и ключ E2B API в качестве переменных окружения.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">load_dotenv()</span></span>
<span class="line"><span style="color:#A6ACCD">client </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> openai.Client()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Set up logging</span></span>
<span class="line"><span style="color:#A6ACCD">logging.basicConfig(</span><span style="color:#E4F0FB">level</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">logging.DEBUG)</span></span>
<span class="line"><span style="color:#A6ACCD">logger </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> logging.getLogger(__name__)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">AI_ASSISTANT_ID </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> os.getenv(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">AI_ASSISTANT_ID</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">USER_GITHUB_TOKEN </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> os.getenv(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">GITHUB_TOKEN</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Add logging statements</span></span>
<span class="line"><span style="color:#A6ACCD">logger.debug(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">AI_ASSISTANT_ID: %s</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, AI_ASSISTANT_ID)</span></span>
<span class="line"><span style="color:#A6ACCD">logger.debug(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">USER_GITHUB_TOKEN: %s</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, USER_GITHUB_TOKEN)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">assistant </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> client.beta.assistants.retrieve(AI_ASSISTANT_ID)</span></span>
<span class="line"></span></code></pre>
<h3 id="42-запрос-пользователю-репозитория-github-аутентификации-и-задания">4.2 Запрос пользователю репозитория GitHub, аутентификации и задания<a aria-hidden="true" tabindex="-1" href="#42-запрос-пользователю-репозитория-github-аутентификации-и-задания"><span class="icon icon-link"></span></a></h3>
<p>Мы определяем три функции, которые запрашивают у пользователя</p>
<p>URL-адрес репозитория GitHub Указание задачи для агента ИИ (например, ”Пожалуйста, создайте калькулятор на JavaScript и сохраните его в новом файле”) Токен аутентификации GitHub.</p>
<p>У пользователя запрашивается его персональный токен доступа GitHub (classic) как стандартный способ безопасного взаимодействия с API GitHub.</p>
<p>💡 Совет: Сохраните свой токен GitHub как <code>GITHUB_TOKEN</code> в файле <code>.env</code>, чтобы не вставлять его каждый раз при запуске программы.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> prompt_user_for_github_repo</span><span style="color:#A6ACCD">():</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Prompting user for GitHub repo</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    user_repo </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> MyPrompt.ask(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">В каком репо GitHub вы хотите работать? Укажите его следующим образом: [bold #E0E0E0]your_username/your_repo_name[/bold #E0E0E0].</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">> </span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"User repo: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_repo</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">🔄[#666666] Клонирование репо...[/#666666]</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">end</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">""</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">end</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    repo_url </span><span style="color:#91B4D5">=</span><span style="color:#91B4D5"> f</span><span style="color:#5DE4C7">"https://github.com/</span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_repo.strip()</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">.git"</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Repo URL: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_url</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    return</span><span style="color:#A6ACCD"> repo_url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> prompt_user_for_task</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">repo_url</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Prompting user for task</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    user_task_specification </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> MyPrompt.ask(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n\n</span><span style="color:#5DE4C7">🤖[#E57B00][bold] Разработчик AI работает в клонированном репо[/bold][/#E57B00]</span><span style="color:#5FB3A1">\n\n</span><span style="color:#5DE4C7">Что вы хотите сделать?</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">> </span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"User task specification: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_task_specification</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    user_task </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> (</span></span>
<span class="line"><span style="color:#91B4D5">        f</span><span style="color:#5DE4C7">"Пожалуйста, работайте с репо кодовой базы под названием </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_url</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> "</span></span>
<span class="line"><span style="color:#91B4D5">        f</span><span style="color:#5DE4C7">"которая клонирована в каталоге /home/user/repo. Реагируйте на следующий комментарий пользователя: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_task_specification</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span></span>
<span class="line"><span style="color:#A6ACCD">    )</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"User task: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_task</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">""</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">end</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    return</span><span style="color:#A6ACCD"> user_task</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> prompt_user_for_auth</span><span style="color:#A6ACCD">():</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Prompting user for authentication</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    user_auth </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> MyPrompt.ask(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">Предоставьте [bold]токен GitHub[/bold] со следующими правами:</span><span style="color:#5FB3A1">\n\n\u2022</span><span style="color:#5DE4C7"> read:org</span><span style="color:#5FB3A1">\n\u2022</span><span style="color:#5DE4C7"> read:project</span><span style="color:#5FB3A1">\n\u2022</span><span style="color:#5DE4C7"> repo</span><span style="color:#5FB3A1">\n\n</span><span style="color:#5DE4C7">Найдите или создайте свой токен на [bold #0096FF]https://github.com/settings/tokens[/bold #0096FF]</span><span style="color:#5FB3A1">\n\n</span><span style="color:#5DE4C7">Token:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">password</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">User authentication provided</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">""</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">end</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    return</span><span style="color:#A6ACCD"> user_auth</span></span>
<span class="line"></span></code></pre>
<h3 id="43-настройка-git">4.3 Настройка git<a aria-hidden="true" tabindex="-1" href="#43-настройка-git"><span class="icon icon-link"></span></a></h3>
<p>Мы настраиваем конфигурацию Git и аутентификацию для учетной записи пользователя в заданном окружении песочницы. Это включает в себя настройку электронной почты и имени пользователя, вход в систему с помощью персонального токена доступа GitHub и настройку учетных данных Git для GitHub. Чтобы контролировать процесс, мы добавили печать кодов выхода на каждом шаге.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> setup_git</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Logging into GitHub...</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.process.start_and_wait(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">git config --global user.email 'ai-developer@email.com'</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.process.start_and_wait(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">git config --global user.name 'AI Developer'</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Вход пользователя на GitHub</span></span>
<span class="line"><span style="color:#A6ACCD">    proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"echo </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">USER_GITHUB_TOKEN</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> | gh auth login --with-token"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Error: Unable to log into GitHub</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(proc.stderr)</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(proc.stdout)</span></span>
<span class="line"><span style="color:#E4F0FBD0">        exit</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">1</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Настройка учетных данных Git пользователя</span></span>
<span class="line"><span style="color:#A6ACCD">    proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">gh auth setup-git</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Error: Unable to set up Git auth with GitHub</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(proc.stderr)</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(proc.stdout)</span></span>
<span class="line"><span style="color:#E4F0FBD0">        exit</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">1</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    else</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.info(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">✅ [#666666]Logged in[/#666666]</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span></code></pre>
<h3 id="44-клонирование-репозитория">4.4 Клонирование репозитория<a aria-hidden="true" tabindex="-1" href="#44-клонирование-репозитория"><span class="icon icon-link"></span></a></h3>
<p>Используя среду песочницы, выполните команду Git clone и проверьте, успешно ли прошел процесс. Мы определяем способ печати стандартного вывода или стандартной ошибки из песочницы (с определенной визуальной темой).</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> clone_repo_in_sandbox</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">sandbox</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">repo_url</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Cloning repo: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_url</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    git_clone_proc </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.process.start_and_wait(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"git clone </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_url</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> {</span><span style="color:#A6ACCD">REPO_DIRECTORY</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> git_clone_proc.exit_code </span><span style="color:#91B4D5">!=</span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        logging.error(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Error: Unable to clone the repo</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#E4F0FBD0">        exit</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">1</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> handle_sandbox_stdout</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">message</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"[Sandbox] </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">message.line</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> handle_sandbox_stderr</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">message</span><span style="color:#A6ACCD">):</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.info(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"[Sandbox] </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">message.line</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span></code></pre>
<h3 id="45-создание-песочницы">4.5 Создание песочницы<a aria-hidden="true" tabindex="-1" href="#45-создание-песочницы"><span class="icon icon-link"></span></a></h3>
<p>Теперь мы можем определить функцию <code>main</code> для создания песочницы E2B.</p>
<p>Внутри функции мы выбираем предпочтительную песочницу E2B, которая называется просто ”<code>Sandbox</code>”, так как мы выбрали песочницу по умолчанию.</p>
<p>💡 Совет: E2B предлагает готовые песочницы или возможность создать свою собственную, используя предпочтительные пакеты. Чтобы сохранить простоту этого руководства, мы выбрали песочницу по умолчанию и оснастили ее только теми действиями, которые мы определили в файле <code>actions.py</code>.</p>
<p>Мы используем метод <code>sandbox.add_action()</code> для регистрации действий в песочнице.<br>
Мы запускаем песочницу и настраиваем ИИ-ассистента в git. Мы регистрируем пользователя на GitHub с помощью токена аутентификации.<br>
Назначаем ассистенту задачу пользователя. Затем мы создаем поток, отправляем в него сообщения и, наконец, запускаем поток.</p>
<p>Мы регистрируем действия в песочнице с помощью метода <code>sandbox.add_action()</code>. Мы запускаем песочницу, настраиваем ИИ-разработчика в Git и запрашиваем у пользователя токен GitHub, если он еще не добавил его в качестве переменной окружения.</p>
<p>Затем мы назначаем задачу пользователя ассистенту, создаем и запускаем поток для отправки сообщений для выполнения задачи.</p>
<p>Здесь мы используем концепцию OpenAI о потоках, сообщениях и запусках.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">def</span><span style="color:#ADD7FF"> main</span><span style="color:#A6ACCD">():</span></span>
<span class="line"><span style="color:#5DE4C7">    global</span><span style="color:#A6ACCD"> USER_GITHUB_TOKEN</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Set up logging</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.basicConfig(</span><span style="color:#E4F0FB">level</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">logging.DEBUG, </span><span style="color:#E4F0FB">format</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">%(asctime)s - %(levelname)s - %(message)s</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Создаем песочницу E2B</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> Sandbox(</span></span>
<span class="line"><span style="color:#E4F0FB">        on_stderr</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">handle_sandbox_stderr,</span></span>
<span class="line"><span style="color:#E4F0FB">        on_stdout</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">handle_sandbox_stdout,</span></span>
<span class="line"><span style="color:#A6ACCD">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Add logging statements</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Creating sandbox</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(create_directory)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added create_directory action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(read_file)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added read_file action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(save_content_to_file)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added save_content_to_file action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(list_files)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added list_files action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(commit)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added commit action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    sandbox.add_action(make_pull_request)</span></span>
<span class="line"><span style="color:#A6ACCD">    logging.debug(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Added make_pull_request action</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">    print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">🤖[#E57B00][bold] AI developer[/#E57B00][/bold]</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">    if</span><span style="color:#A6ACCD"> USER_GITHUB_TOKEN </span><span style="color:#91B4D5">is</span><span style="color:#5DE4C7"> None</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        USER_GITHUB_TOKEN </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> prompt_user_for_auth()</span></span>
<span class="line"><span style="color:#5DE4C7C0">    else</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#E4F0FBD0">        print</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">✅ [#666666]GitHub token loaded[/#666666]</span><span style="color:#5FB3A1">\n</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Сразу настраиваем git, чтобы пользователь сразу понял, что передал неправильный токен</span></span>
<span class="line"><span style="color:#A6ACCD">    setup_git(sandbox)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    # Клонируем репо</span></span>
<span class="line"><span style="color:#A6ACCD">    repo_url </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> prompt_user_for_github_repo()</span></span>
<span class="line"><span style="color:#A6ACCD">    clone_repo_in_sandbox(sandbox, repo_url)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">    while</span><span style="color:#5DE4C7"> True</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">        user_task </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> prompt_user_for_task(repo_url)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">        thread </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> client.beta.threads.create(</span></span>
<span class="line"><span style="color:#E4F0FB">            messages</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">[</span></span>
<span class="line"><span style="color:#A6ACCD">                {</span></span>
<span class="line"><span style="color:#A6ACCD">                    "</span><span style="color:#5DE4C7">role</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">user</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">                    "</span><span style="color:#5DE4C7">content</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">: </span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Тщательно спланируйте эту задачу и начните работать над ней: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">user_task</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> в репозитории </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">repo_url</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">                },</span></span>
<span class="line"><span style="color:#A6ACCD">            ],</span></span>
<span class="line"><span style="color:#A6ACCD">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">        run </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> client.beta.threads.runs.create(</span></span>
<span class="line"><span style="color:#E4F0FB">            thread_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">thread.id,</span></span>
<span class="line"><span style="color:#E4F0FB">            assistant_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">assistant.id,</span></span>
<span class="line"><span style="color:#A6ACCD">        )</span></span>
<span class="line"></span></code></pre>
<p>Потоки, сообщения и прогоны - это концепция из OpenAI’s Assistants API:</p>
<h3 id="46-создание-песочницы">4.6 Создание песочницы<a aria-hidden="true" tabindex="-1" href="#46-создание-песочницы"><span class="icon icon-link"></span></a></h3>
<p>Все еще находясь внутри главной функции, мы выводим процесс работы ассистента на терминал. Каждый раз, когда разработчик решает использовать одно из действий, пользователь может увидеть в терминале логи о выбранном действии и его успехе/неудаче.</p>
<p>Примечание: продолжительность работы ассистента в значительной степени определяется OpenAI.</p>
<p>В конце мы используем <code>time.sleep()</code>, чтобы указать, как часто мы хотим опрашивать состояние помощника.</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#5DE4C7">import</span><span style="color:#A6ACCD"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic"># Set up logging</span></span>
<span class="line"><span style="color:#A6ACCD">logging.basicConfig(</span><span style="color:#E4F0FB">level</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">logging.DEBUG)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">spinner </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> ""</span></span>
<span class="line"><span style="color:#5DE4C7C0">with</span><span style="color:#A6ACCD"> console.status(spinner):</span></span>
<span class="line"><span style="color:#A6ACCD">    previous_status </span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7"> None</span></span>
<span class="line"><span style="color:#5DE4C7C0">    while</span><span style="color:#5DE4C7"> True</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#5DE4C7C0">        if</span><span style="color:#A6ACCD"> run.status </span><span style="color:#91B4D5">!=</span><span style="color:#A6ACCD"> previous_status:</span></span>
<span class="line"><span style="color:#A6ACCD">            console.print(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"[bold #FF8800]>[/bold #FF8800] Assistant is currently in status: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">run.status</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7"> [#66666666](ожидание OpenAI)[/#66666666]"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">            logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Assistant is currently in status: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">run.status</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">            previous_status </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> run.status</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">        if</span><span style="color:#A6ACCD"> run.status </span><span style="color:#91B4D5">==</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">requires_action</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">            outputs </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> sandbox.openai.actions.run(run)</span></span>
<span class="line"><span style="color:#5DE4C7C0">            if</span><span style="color:#E4F0FBD0"> len</span><span style="color:#A6ACCD">(outputs) </span><span style="color:#91B4D5">></span><span style="color:#5DE4C7"> 0</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">                client.beta.threads.runs.submit_tool_outputs(</span></span>
<span class="line"><span style="color:#E4F0FB">                    thread_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">thread.id,</span></span>
<span class="line"><span style="color:#E4F0FB">                    run_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">run.id,</span></span>
<span class="line"><span style="color:#E4F0FB">                    tool_outputs</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">outputs</span></span>
<span class="line"><span style="color:#A6ACCD">                )</span></span>
<span class="line"><span style="color:#5DE4C7C0">        elif</span><span style="color:#A6ACCD"> run.status </span><span style="color:#91B4D5">==</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">completed</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">            console.print(</span><span style="color:#A6ACCD">"</span><span style="color:#5FB3A1">\n</span><span style="color:#5DE4C7">✅[#666666] Run completed[/#666666]</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">            logging.debug(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Run completed</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">            messages </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> (</span></span>
<span class="line"><span style="color:#A6ACCD">                client.beta.threads.messages.list(</span><span style="color:#E4F0FB">thread_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">thread.id)</span></span>
<span class="line"><span style="color:#A6ACCD">                .data[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">]</span></span>
<span class="line"><span style="color:#A6ACCD">                .content</span></span>
<span class="line"><span style="color:#A6ACCD">            )</span></span>
<span class="line"><span style="color:#A6ACCD">            text_messages </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> [</span></span>
<span class="line"><span style="color:#A6ACCD">                message</span></span>
<span class="line"><span style="color:#5DE4C7C0">                for</span><span style="color:#A6ACCD"> message </span><span style="color:#5DE4C7C0">in</span><span style="color:#A6ACCD"> messages</span></span>
<span class="line"><span style="color:#5DE4C7C0">                if</span><span style="color:#A6ACCD"> message.type </span><span style="color:#91B4D5">==</span><span style="color:#A6ACCD"> "</span><span style="color:#5DE4C7">text</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#A6ACCD">            ]</span></span>
<span class="line"><span style="color:#A6ACCD">            console.print(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Thread finished:</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, text_messages[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].text.value)</span></span>
<span class="line"><span style="color:#A6ACCD">            logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Thread finished: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">text_messages[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].text.value</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">            break</span></span>
<span class="line"><span style="color:#5DE4C7C0">        elif</span><span style="color:#A6ACCD"> run.status </span><span style="color:#91B4D5">in</span><span style="color:#A6ACCD"> [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">queued</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">in_progress</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]:</span></span>
<span class="line"><span style="color:#5DE4C7C0">            pass</span></span>
<span class="line"><span style="color:#5DE4C7C0">        elif</span><span style="color:#A6ACCD"> run.status </span><span style="color:#91B4D5">in</span><span style="color:#A6ACCD"> [</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">cancelled</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">cancelling</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">expired</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">failed</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">]:</span></span>
<span class="line"><span style="color:#5DE4C7C0">            break</span></span>
<span class="line"><span style="color:#5DE4C7C0">        else</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#E4F0FBD0">            print</span><span style="color:#A6ACCD">(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Unknown status: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">run.status</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">            logging.debug(</span><span style="color:#91B4D5">f</span><span style="color:#5DE4C7">"Unknown status: </span><span style="color:#5DE4C7">{</span><span style="color:#A6ACCD">run.status</span><span style="color:#5DE4C7">}</span><span style="color:#5DE4C7">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#5DE4C7C0">            break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">        run </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> client.beta.threads.runs.retrieve(</span></span>
<span class="line"><span style="color:#E4F0FB">            thread_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">thread.id,</span></span>
<span class="line"><span style="color:#E4F0FB">            run_id</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">run.id</span></span>
<span class="line"><span style="color:#A6ACCD">        )</span></span>
<span class="line"><span style="color:#A6ACCD">        time.sleep(</span><span style="color:#5DE4C7">0.5</span><span style="color:#A6ACCD">)</span></span>
<span class="line"></span></code></pre>
<p>Наконец, под функцией main мы пишем код, который будет выполняться, если скрипт является основной выполняемой программой.</p>
<p><code>if __name__ == "__main__": main()</code>.</p>
<h2 id="вывод">Вывод<a aria-hidden="true" tabindex="-1" href="#вывод"><span class="icon icon-link"></span></a></h2>
<p>Спасибо, что прочитали это руководство, и я буду признателен за ваши отзывы!</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок&#38;url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok&#38;title=Создайте ИИ-разработчика, который будет делать за вас запросы на исправление ошибок&#38;summary=Руководство по Python с полным кодом Окончательный код: E2B Cookbook  AI GitHub Developer Что мы будем делать В этом руководстве мы создадим собственног&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/sozdaite-yy-razrabotchyka-kotor-i-budet-delat-za-vas-zapros-na-yspravlenye-oshybok&#38;media=&#38;description=Руководство по Python с полным кодом Окончательный код: E2B Cookbook  AI GitHub Developer Что мы будем делать В этом руководстве мы создадим собственног" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/sozdanye-ar-masok-dlia-lytsa-v-react-native" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Создание AR-масок для лица в React Native </a> <a href="/blog/astro-kvyk-khiuston-u-nas-est-vozobnovliaemost" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Астро + Квик: Хьюстон, у нас есть возобновляемость! </a> </nav>  </div> </article> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.svLg6TOn.js" component-export="default" renderer-url="/_astro/client.D9Vng9vH.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> <astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.BwogX8bT.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  </div> <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>