<!DOCTYPE html><html lang="ru"> <head><title>Представляем Loco: Rails от Rust | Игорь Горлов - Фронтeндер</title><link rel="canonical" href="https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust"><meta name="description" content="Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено мно"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.9.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.sihbnQqJ.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.CzD8Xhhr.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-xdjatz7t-1"] { view-transition-name: blog-image-predstavliaem-loco-rails-ot-rust; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/predstavliaem-loco-rails-ot-rust-Jan-18-2024.C5KDLWHb_iGPrM.avif" type="image/avif"><source srcset="/_astro/predstavliaem-loco-rails-ot-rust-Jan-18-2024.C5KDLWHb_gfYWX.webp" type="image/webp"> <img src="/_astro/predstavliaem-loco-rails-ot-rust-Jan-18-2024.C5KDLWHb_Z106utB.png" alt="Представляем Loco: Rails от Rust" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-xdjatz7t-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/обзор" class="categories__link" data-astro-cid-axzg2cw6> Обзор  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Представляем Loco: Rails от Rust </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/rust" data-astro-cid-axzg2cw6> Rust </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/loco" data-astro-cid-axzg2cw6> Loco </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 18 янв., 2024 by Игорь Горлов </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <!-- <TextAds /> --> <!-- <AdfoxTocAds blockId="adfox_17062261612859555" /> --> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Представляем Loco: Rails от Rust&url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust&title=Представляем Loco: Rails от Rust&summary=Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено мно&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust&media=&description=Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено мно" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open class="toc border-b border-blue text-blue fluid:p-8 overflow-auto cursor-pointer bg-box"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#начало-работы-с-loco">Начало работы с Loco</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#маршрутизация-в-loco">Маршрутизация в Loco</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#модели-в-loco">Модели в Loco</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#обработка-заданий-в-loco">Обработка заданий в Loco</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#развертывание-loco">Развертывание Loco</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#завершение-работы">Завершение работы</a></li></ol></details open><p>Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено множество успешных бизнесов - Airbnb и Shopify - два из многих громких имен, появившихся благодаря ему, хотя в последнее время Shopify начала экспериментировать с другими языками и в конце прошлого года объявила, что будет официально поддерживать Rust.</p>
<p>Это привело к тому, что многие фреймворки пытаются подражать философии Rails - Loco.rs не является исключением. Однако в данном случае он призван решить давнюю проблему, связанную с тем, что в Rust не существует по-настоящему включенного в батарею фреймворка. Давайте поговорим об этом.</p>
<p>Почему Ruby on Rails был популярен? Краткая справка</p>
<p>Ruby on Rails стал популярен потому, что это фреймворк, который делает всю тяжелую работу за вас и абстрагируется от многих тяжелых задач - это означает, что между продумыванием бизнес-логики идеи и переходом к полноценной работе проходит совсем немного времени. Это очень хорошо по нескольким причинам, особенно в веб-разработке: вы можете быстрее создавать продукты, не прибегая к помощи шаблонов, вы можете положиться на фреймворк, который сделает за вас все сложные низкоуровневые вещи, и вам не нужно свободно владеть языком Ruby, чтобы использовать его (хотя это очень помогает, если вы им владеете!). Это то, что находит отклик у многих веб-разработчиков, о чем свидетельствует огромное количество разработчиков, использующих Laravel, PHP-фреймворк, который очень похож на Ruby on Rails.</p>
<p>Это достигается за счет того, что все находится в интерфейсе командной строки: вы используете командную строку для запуска самого веб-сервиса, используете ее для миграции и обработки заданий, а также для создания новых контроллеров, моделей и многого другого. Например, вы можете создать модель базы данных с помощью команды <code>rails generate model test</code>, которая сгенерирует модель. Затем вы можете создать контроллер маршрута с помощью <code>rails generate controller test</code>, который сгенерирует контроллер под названием <code>TestController</code>. То же самое можно сделать для миграций с помощью <code>rake generate migration</code>.</p>
<p>Когда речь заходит о Rust, это несколько противоречит друг другу, поэтому Loco.rs и интересен: Rust - это язык, который позволяет вам вникать в суть дела, когда дело доходит до низкоуровневых деталей, а это значит, что он привлекает программистов, которые не против проделать дополнительную работу, потому что они предпочитают, чтобы все было реализовано по их стандарту, или потому что они хотят понять, как все работает, чтобы, когда что-то сломается, они знали, как это исправить. Кроме того, Loco не является самостоятельным фреймворком - в настоящее время он использует <code>axum</code> под капотом, наряду с <code>sidekiq-rs</code> для обработки заданий и <code>sea-orm</code> для миграций.</p>
<h2 id="начало-работы-с-loco">Начало работы с Loco<a aria-hidden="true" tabindex="-1" href="#начало-работы-с-loco"><span class="icon icon-link"></span></a></h2>
<p>Чтобы начать работу с Rust Loco crate, вам нужно использовать его CLI, который вы можете установить, используя следующее:</p>
<p><code>cargo install loco-cli</code>.</p>
<p>Вы можете начать новый проект с помощью <code>loco new</code> - он спросит вас, как называется ваше приложение, а затем - какое приложение вы хотите. В этой статье мы будем говорить о стартовом приложении Rust SaaS.</p>
<h2 id="маршрутизация-в-loco">Маршрутизация в Loco<a aria-hidden="true" tabindex="-1" href="#маршрутизация-в-loco"><span class="icon icon-link"></span></a></h2>
<p>Хотя Loco использует <code>axum</code> под капотом, он абстрагирует некоторые вещи в конфигурационных файлах, которые вы можете найти в папке <code>config</code>.</p>
<p>Сервис Axum, запускаемый приложением, реализует функцию <code>Hooks</code> из <code>loco_cli</code>, которая требует использования нескольких функций - перейдя в <code>src/app.rs</code>, вы увидите, что у нас есть функции для регистрации маршрутов, получения имени приложения, подключения рабочих и регистрации задач, усечения таблиц и занесения данных в базу. Мы также можем добавить в маршрутизатор дополнительные функции, которые подключаются к CLI - <code>after_routes()</code> для добавления таких вещей, как промежуточное ПО, и <code>before_run()</code>, которая позволяет выполнять операции до запуска самого приложения. Обратите внимание, что все команды, которые мы используем через CLI проекта для создания вещей, будут автоматически добавлены в файл <code>app.rs</code> - нет необходимости делать это самостоятельно!</p>
<p>Чтобы добавить контроллер, нам нужно выполнить команду <code>cargo loco generate controller test</code> из корня проекта, которая сгенерирует контроллер под названием <code>test</code> и одновременно добавит новый файл в папку <code>controllers</code>. Затем мы можем создать любые необходимые маршруты и добавить их к маршрутизатору в том же файле, и он автоматически будет добавлен в приложение - никакой дополнительной работы не требуется! Ваш новый контроллер должен выглядеть примерно так:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">#![allow(clippy::unused_async)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">use loco_rs::prelude::</span><span style="color:#91B4D5">*</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">pub async fn echo(</span><span style="color:#5DE4C7">req_body</span><span style="color:#A6ACCD">: </span><span style="color:#E4F0FB">String</span><span style="color:#A6ACCD">) -> </span><span style="color:#E4F0FB">String</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    req_body</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">pub async fn hello(</span><span style="color:#E4F0FB">State</span><span style="color:#A6ACCD">(_ctx): </span><span style="color:#E4F0FB">State</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">AppContext</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD">) -> </span><span style="color:#E4F0FB">Result</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">String</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> делаем что</span><span style="color:#91B4D5">-</span><span style="color:#A6ACCD">то с контекстом (база данных и т.д.)</span></span>
<span class="line"><span style="color:#A6ACCD">    format::text(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">hello</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">pub fn routes() -> </span><span style="color:#E4F0FB">Routes</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#ADD7FF">    Routes</span><span style="color:#A6ACCD">::</span><span style="color:#5DE4C7">new</span><span style="color:#A6ACCD">()</span></span>
<span class="line"><span style="color:#A6ACCD">        .prefix(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">test</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">        .add(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">https://dev.to/</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, get(hello))</span></span>
<span class="line"><span style="color:#A6ACCD">        .add(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">/echo</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, post(echo))</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Теперь вы можете добавить любые маршруты в этот файл, и они будут помещены под этот контроллер, когда будут добавлены в функцию <code>routes()</code> в файле. С точки зрения маршрутов это означает, что все они будут находиться под одним маршрутом. Вы можете получить доступ к подключению к базе данных from предоставленное <code>State</code> - в отличие от обычного Axum, вам не нужно создавать его самостоятельно.</p>
<p>Самое замечательное в маршрутизации Loco то, что все, что вы знаете об использовании Axum, может быть применено здесь - так что если вы знаете, как писать свои собственные экстракторы, писать промежуточное ПО и другие вещи, все это может быть использовано в Loco, поскольку он, по сути, строится поверх Axum.</p>
<p>После того как вы добавили все контроллеры и маршруты, вы можете использовать <code>cargo loco routes</code>, чтобы отобразить все маршруты, которые есть в вашем приложении.</p>
<h2 id="модели-в-loco">Модели в Loco<a aria-hidden="true" tabindex="-1" href="#модели-в-loco"><span class="icon icon-link"></span></a></h2>
<p>Модели в Loco представляют собой модели баз данных, используемые <code>sea_orm</code>. Чтобы начать работу, выполните следующие действия:</p>
<p><code>cargo loco generate model &#x3C;name-of-model></code>.</p>
<p>В результате будет сгенерирована модель, которую вы можете использовать в своем приложении. Вы также можете инициализировать дополнительные поля, чтобы сгенерировать полную модель:</p>
<p><code>cargo loco generate model movies title:string rating:int</code>.</p>
<p>Обратите внимание, что если вы хотите инициализировать модель с помощью дополнительных полей, вам нужно будет проверить справочную документацию, чтобы узнать, какие поля вам нужно использовать. После того как вы добавите все необходимые модели, вы можете просто выполнить следующие две команды, чтобы получить необходимые миграции и сущности:</p>
<p><code>cargo loco db migrate cargo loco db entities</code>.</p>
<p>Когда вы сгенерируете пустую модель, перейдя к файлу модели, вы, вероятно, обнаружите что-то похожее на это:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#A6ACCD">use sea_orm::entity::prelude::</span><span style="color:#91B4D5">*</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#A6ACCD">use super::_entities::notes::</span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">impl </span><span style="color:#E4F0FB">ActiveModelBehavior</span><span style="color:#A6ACCD"> for </span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> расширить activemodel ниже (сохраните комментарий для генераторов)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Когда мы используем эту модель в нашем контроллере, обычно мы не ссылаемся на структуру, содержащую саму модель - вместо этого мы ссылаемся на <code>ActiveModel</code> или <code>Entity</code>/<code>Model</code> - пустой файл модели выглядит следующим образом:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#A6ACCD">use sea_orm::entity::prelude::{</span><span style="color:#E4F0FB">ActiveModelBehavior</span><span style="color:#A6ACCD">};</span></span>
<span class="line"><span style="color:#A6ACCD">use super::_entities::notes::</span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">impl </span><span style="color:#E4F0FB">ActiveModelBehavior</span><span style="color:#A6ACCD"> for </span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> расширить activemodel ниже (сохраните комментарий для генераторов)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Мы можем расширить поведение нашей ActiveModel, добавив метод <code>before_save()</code>, как упоминалось ранее, следующим образом:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#A6ACCD">use sea_orm::entity::prelude::{</span><span style="color:#E4F0FB">ActiveModelBehavior</span><span style="color:#A6ACCD">};</span></span>
<span class="line"><span style="color:#A6ACCD">use super::_entities::notes::</span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">impl </span><span style="color:#E4F0FB">ActiveModelBehavior</span><span style="color:#A6ACCD"> for </span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> расширяем activemodel ниже (сохраняем комментарий для генераторов)</span></span>
<span class="line"><span style="color:#A6ACCD">    async fn before_save</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">C</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD">(</span><span style="color:#ADD7FF;font-style:italic">self</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">_db</span><span style="color:#A6ACCD">: </span><span style="color:#91B4D5">&#x26;</span><span style="color:#E4F0FB">C</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">insert</span><span style="color:#A6ACCD">: bool) -> </span><span style="color:#E4F0FB">Result</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">Self</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">DbErr</span><span style="color:#91B4D5">></span></span>
<span class="line"><span style="color:#A6ACCD">    where</span></span>
<span class="line"><span style="color:#5DE4C7">        C</span><span style="color:#A6ACCD">: </span><span style="color:#E4F0FB">ConnectionTrait</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">    {</span></span>
<span class="line"><span style="color:#A6ACCD">        println!(</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Это происходит до того, как мы что-то сохраним!</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FB">        Ok</span><span style="color:#A6ACCD">(</span><span style="color:#ADD7FF;font-style:italic">self</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">    }</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Реализация трейта <code>ActiveModelBehaviour</code> (из <code>sea_orm</code>) позволяет нам определить поведение для <code>ActiveModel</code> - более конкретно, мы можем добавить методы до и после сохранения модели, а также до и после удаления модели. Мы также можем расширить поведение нашей модели, добавив к ней дополнительные методы:</p>
<p><code>impl super::_entities::users::Model { // ... ваши собственные методы }</code>.</p>
<p>Теперь мы можем использовать ее в функции-обработчике, загрузив элемент из базы данных - и затем делать с данными все, что нам нужно:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#A6ACCD">async fn load_item(</span><span style="color:#5DE4C7">ctx</span><span style="color:#A6ACCD">: </span><span style="color:#91B4D5">&#x26;</span><span style="color:#E4F0FB">AppContext</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">id</span><span style="color:#A6ACCD">: i32) -> </span><span style="color:#E4F0FB">Result</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">Model</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    let item </span><span style="color:#91B4D5">=</span><span style="color:#ADD7FF"> Entity</span><span style="color:#A6ACCD">::find_by_id(id).one(</span><span style="color:#91B4D5">&#x26;</span><span style="color:#A6ACCD">ctx.db).await?;</span></span>
<span class="line"><span style="color:#A6ACCD">    item.ok_or_else(</span><span style="color:#91B4D5">||</span><span style="color:#ADD7FF"> Error</span><span style="color:#A6ACCD">::</span><span style="color:#E4F0FB">NotFound</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">pub async fn update(</span></span>
<span class="line"><span style="color:#E4F0FB">    Path</span><span style="color:#A6ACCD">(id): </span><span style="color:#E4F0FB">Path</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#A6ACCD">i32</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#E4F0FB">    State</span><span style="color:#A6ACCD">(ctx): </span><span style="color:#E4F0FB">State</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">AppContext</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#E4F0FB">    Json</span><span style="color:#A6ACCD">(params): </span><span style="color:#E4F0FB">Json</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">Params</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">) -> </span><span style="color:#E4F0FB">Result</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">Json</span><span style="color:#91B4D5">&#x3C;</span><span style="color:#E4F0FB">Model</span><span style="color:#91B4D5">>></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> используем sea_orm для загрузки элемента на основе id</span></span>
<span class="line"><span style="color:#A6ACCD">    let item </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> load_item(</span><span style="color:#91B4D5">&#x26;</span><span style="color:#A6ACCD">ctx, id).await?;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> превращаем элемент в </span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD">, которую затем можем использовать</span></span>
<span class="line"><span style="color:#A6ACCD">    let mut item </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> item.into_active_model();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> обновляем параметры текущего элемента новыми свойствами</span></span>
<span class="line"><span style="color:#A6ACCD">    params.update(</span><span style="color:#91B4D5">&#x26;</span><span style="color:#A6ACCD">mut item);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> отправляем новый элемент обратно в базу данных</span></span>
<span class="line"><span style="color:#A6ACCD">    let item </span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD"> item.update(</span><span style="color:#91B4D5">&#x26;</span><span style="color:#A6ACCD">ctx.db).await?;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">    //</span><span style="color:#A6ACCD"> возвращаем обновленный элемент</span></span>
<span class="line"><span style="color:#A6ACCD">    format::json(item)</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Однако это далеко не все, что может предложить Loco.rs. Мы также можем использовать структуру <code>loco_rs</code> Validator, чтобы иметь возможность проверить новую модель до того, как с ней нужно будет что-то делать! Например, нам нужно проверить, является ли электронное письмо действительным. Вы можете проверить это ниже:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">#[derive(Debug, Validate, Deserialize)]</span></span>
<span class="line"><span style="color:#A6ACCD">pub struct </span><span style="color:#E4F0FB">ModelValidator</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    #[validate(length(min = 2, message = "Имя должно быть не менее 2 символов."))]</span></span>
<span class="line"><span style="color:#A6ACCD">    pub </span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">: </span><span style="color:#E4F0FB">String</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">    #[validate(custom = "validation::is_valid_email")]</span></span>
<span class="line"><span style="color:#A6ACCD">    pub </span><span style="color:#5DE4C7">email</span><span style="color:#A6ACCD">: </span><span style="color:#E4F0FB">String</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">impl </span><span style="color:#E4F0FB">From</span><span style="color:#91B4D5">&#x3C;&#x26;</span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#91B4D5">></span><span style="color:#A6ACCD"> for </span><span style="color:#E4F0FB">ModelValidator</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#A6ACCD">    fn from(</span><span style="color:#5DE4C7">value</span><span style="color:#A6ACCD">: </span><span style="color:#91B4D5">&#x26;</span><span style="color:#E4F0FB">ActiveModel</span><span style="color:#A6ACCD">) -> </span><span style="color:#E4F0FB">Self</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">        Self</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#5DE4C7">            name</span><span style="color:#A6ACCD">: value.name.as_ref().to_string(),</span></span>
<span class="line"><span style="color:#5DE4C7">            email</span><span style="color:#A6ACCD">: value.email.as_ref().to_string(),</span></span>
<span class="line"><span style="color:#A6ACCD">        }</span></span>
<span class="line"><span style="color:#A6ACCD">    }</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<h2 id="обработка-заданий-в-loco">Обработка заданий в Loco<a aria-hidden="true" tabindex="-1" href="#обработка-заданий-в-loco"><span class="icon icon-link"></span></a></h2>
<p>Как и во всем остальном в Loco, вы также можете генерировать рабочих и задания через CLI. Выполнив команду <code>cargo loco generate task</code> или <code>cargo loco generate worker</code>, вы сможете сгенерировать задание или рабочего по своему усмотрению.</p>
<p>Под капотом Loco использует <code>sidekiq-rs</code> для обработки заданий - это Rust-реализация его Ruby-аналога, <code>sidekiq.rb</code>. Как только рабочий будет создан, перейдите в папку <code>workers</code> и проверьте файл, который вы создали - в нем будет структура для самого рабочего, структура, содержащая аргументы, которые будет принимать рабочий, реализация трейта <code>AppWorker</code> for рабочего, а затем реализацию асинхронного трейта, который позволяет рабочему что-то делать.</p>
<p>Затем вы можете запустить его следующим образом:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#ADD7FF">ReportWorkerWorker</span><span style="color:#A6ACCD">::perform(</span><span style="color:#91B4D5">&#x26;</span><span style="color:#A6ACCD">boot.app_context, </span><span style="color:#E4F0FB">ReportWorkerWorkerArgs</span><span style="color:#A6ACCD">{}).await.unwrap();</span></span>
<span class="line"></span></code></pre>
<p>Как видите, нам не нужно инициализировать структуру, чтобы использовать ее - мы можем вызвать метод из структуры напрямую, и он будет работать, если аргументы действительны - как вы видите здесь, аргументы не требуются, поскольку структура args не имеет никаких полей.</p>
<h2 id="развертывание-loco">Развертывание Loco<a aria-hidden="true" tabindex="-1" href="#развертывание-loco"><span class="icon icon-link"></span></a></h2>
<p>В настоящее время Loco.rs позволяет вам создать развертывание с помощью следующей команды:</p>
<p><code>cargo loco generate deployment</code>.</p>
<p>Это позволит вам выбрать между Docker и Shuttle. При выборе Docker будет сгенерирован Dockerfile, который вы можете использовать для развертывания в любом месте, а при выборе Shuttle будет автоматически сгенерировано все необходимое для развертывания Shuttle - никакой дополнительной работы не требуется! Затем вы можете использовать Shuttle CLI для запуска нового проекта и его развертывания:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="toml"><code><span class="line"><span style="color:#D0679D">// Please note that if you want to avoid using the --name flag, you should use the name key in the Shuttle.toml file</span></span>
<span class="line"><span style="color:#D0679D">cargo shuttle start --name &#x3C;name-of-project></span></span>
<span class="line"><span style="color:#D0679D">cargo shuttle deploy --name &#x3C;name-of-project></span></span>
<span class="line"></span></code></pre>
<h2 id="завершение-работы">Завершение работы<a aria-hidden="true" tabindex="-1" href="#завершение-работы"><span class="icon icon-link"></span></a></h2>
<p>Спасибо за чтение! Loco - это отличный фреймворк, который подает большие надежды и очень быстро развивается. Создавать Rest API на Rust еще никогда не было так просто!</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Представляем Loco: Rails от Rust&url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust&title=Представляем Loco: Rails от Rust&summary=Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено мно&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/predstavliaem-loco-rails-ot-rust&media=&description=Хотя Ruby on Rails уже не так популярен, как раньше, во времена своего расцвета он был силой, с которой приходилось считаться. На его основе было построено мно" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/model-predstavlenye-kontroller-v-rails-hlubokoe-pohruzhenye-v-arkhytekturu-mvc" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Модель, представление, контроллер в Rails: Глубокое погружение в архитектуру MVC </a> <a href="/blog/kak-yspolzovat-shoulda-matchers-s-rspec-dlia-ruby-on-rails" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Как использовать Shoulda Matchers с RSpec для Ruby on Rails </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>