<!DOCTYPE html><html lang="ru"> <head><title>Как тестировать хуки React | Игорь Горлов - Фронтeндер</title><link rel="canonical" href="https://igorlov.ru/blog/kak-testyrovat-khuky-react"><meta name="description" content="Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testi"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.9.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.sihbnQqJ.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.CzD8Xhhr.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-xdjatz7t-1"] { view-transition-name: blog-image-kak-testyrovat-khuky-react; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/kak-testyrovat-khuky-react-Dec-21-2023.iKrFdwgY_QRJaf.avif" type="image/avif"><source srcset="/_astro/kak-testyrovat-khuky-react-Dec-21-2023.iKrFdwgY_Z1IpkrK.webp" type="image/webp"> <img src="/_astro/kak-testyrovat-khuky-react-Dec-21-2023.iKrFdwgY_Z1eabLf.png" alt="Как тестировать хуки React" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-xdjatz7t-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/учебник" class="categories__link" data-astro-cid-axzg2cw6> Учебник  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Как тестировать хуки React </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/testing" data-astro-cid-axzg2cw6> Testing </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/тестирование" data-astro-cid-axzg2cw6> Тестирование </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 21 дек., 2023 by Игорь Горлов </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <!-- <TextAds /> --> <!-- <AdfoxTocAds blockId="adfox_17062261612859555" /> --> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Как тестировать хуки React&url=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/kak-testyrovat-khuky-react&title=Как тестировать хуки React&summary=Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testi&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/kak-testyrovat-khuky-react&media=&description=Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testi" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open class="toc border-b border-blue text-blue fluid:p-8 overflow-auto cursor-pointer bg-box"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#что-такое-react-hooks">Что такое React Hooks?</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#как-создать-react-приложение-с-использованием-react-hooks">Как создать React-приложение с использованием React Hooks</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#что-такое-jest">Что такое Jest?</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#что-такое-энзим">Что такое энзим?</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-react-hooks-с-помощью-enzyme">Тестирование React Hooks с помощью Enzyme</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-хука-usestate-с-помощью-enzyme">Тестирование хука useState с помощью Enzyme</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-хуков-react-с-помощью-библиотеки-react-testing-library">Тестирование хуков React с помощью библиотеки React Testing Library</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-функций-async-hook">Тестирование функций async Hook</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-хуков-с-внешними-зависимостями">Тестирование хуков с внешними зависимостями</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-хуков-вызывающих-побочные-эффекты">Тестирование хуков, вызывающих побочные эффекты</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#тестирование-пользовательских-хуков">Тестирование пользовательских хуков</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#сравнение-библиотек-тестирования-enzyme-jest-и-react">Сравнение библиотек тестирования Enzyme, Jest и React</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="text-blue text-blue-h3" href="#метрики-enzyme-jest-react-testing-library">Метрики Enzyme Jest React Testing Library</a></li></ol></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#заключение">Заключение</a></li></ol></details open><p>Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testing Library, обсудить общие проблемы, возникающие при тестировании React Hooks, и их решения, а также предоставить обновленную информацию, связанную с последней версией React v18.</p>
<figure class="igorlov-figure"><img  src="/_astro/How-to-test-React-Hooks.BUq06LFf_KBpMJ.webp" alt="How-to-test-React-Hooks.png" width="895" height="597" loading="lazy" decoding="async"><figcaption>How-to-test-React-Hooks.png</figcaption></figure>
<p>Стабильный релиз React Hooks в React v16.8.0 получил положительные отзывы от сообщества. Вместе с этим стабильным релизом появилась необходимость эффективно тестировать React Hooks.</p>
<p>Важность тестирования во фронтенде невозможно переоценить. Каждая команда и компания использует разработку, управляемую тестами, чтобы вселить уверенность в свое программное обеспечение. В этой статье представлено практическое руководство по тестированию React Hooks с помощью таких инструментов, как React Testing Library, Jest и Enzyme.</p>
<h2 id="что-такое-react-hooks">Что такое React Hooks?<a aria-hidden="true" tabindex="-1" href="#что-такое-react-hooks"><span class="icon icon-link"></span></a></h2>
<p>React Hooks, по сути, обеспечивают способ создания компонентов с функциями, такими как состояние, без необходимости использования компонентов класса.</p>
<p>Стандартные и пользовательские React Hooks решают многие проблемы, с которыми разработчики React сталкивались на протяжении многих лет. Эти проблемы неизбежно заставляли нас использовать некоторые сложные паттерны в качестве обходных путей, такие как реквизиты рендеринга и компоненты более высокого порядка, что могло привести к созданию сложных кодовых баз.</p>
<p>Например, до появления Hooks в React не было поддержки многократно используемой логики состояния между компонентами <code>класса</code>. Это иногда приводило к огромным компонентам, дублированию логики в конструкторе и необходимости использовать методы жизненного цикла.</p>
<p>Hooks призваны решить все эти проблемы, позволяя вам писать многократно используемые компоненты с доступом к состоянию, методам жизненного цикла и ссылкам.</p>
<h2 id="как-создать-react-приложение-с-использованием-react-hooks">Как создать React-приложение с использованием React Hooks<a aria-hidden="true" tabindex="-1" href="#как-создать-react-приложение-с-использованием-react-hooks"><span class="icon icon-link"></span></a></h2>
<p>Прежде чем мы перейдем к рассмотрению того, как писать тесты для React Hooks, давайте посмотрим, как построить React-приложение с использованием Hooks. Мы создадим приложение, которое будет показывать гонки Формулы-1 2018 года и победителей каждого года.<br>
Вы можете увидеть и взаимодействовать со всем приложением через CodeSandbox:</p>
<p>В приведенном выше приложении мы используем хуки <code>useState</code> и <code>useEffect</code>. Если вы перейдете в файл <code>index.js</code>, в функции <code>App</code> вы увидите экземпляр, в котором используется <code>useState</code>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">// Устанавливаем список гонок в пустой массив</span></span>
<span class="line"><span style="color:#91B4D5">let</span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">races</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">setRaces</span><span style="color:#A6ACCD">] </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> useState</span><span style="color:#A6ACCD">([]);</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">// Устанавливаем победителя для определенного года</span></span>
<span class="line"><span style="color:#91B4D5">let</span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">winner</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">setWinner</span><span style="color:#A6ACCD">] </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> useState</span><span style="color:#A6ACCD">();</span></span>
<span class="line"></span></code></pre>
<p>useState возвращает пару значений, то есть текущее значение состояния и функцию, позволяющую его обновить. Его можно инициализировать любым типом значения (строка, массив и т. д.), в отличие от state в классах, где это должен быть объект.</p>
<p>Между тем, хук <code>useEffect</code> добавляет возможность выполнять побочные эффекты из компонента функции. По сути, он позволяет вам выполнять операции, которые обычно выполняются в методах жизненного цикла <code>componentDidMount</code>, <code>componentDidUpdate</code> и <code>componentWillUnmount</code>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">// При первом рендере компонента получаем данные из API.</span></span>
<span class="line"><span style="color:#E4F0FBD0">useEffect</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">	fetch</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">`</span><span style="color:#5DE4C7">https://ergast.com/api/f1/2018/results/1.json</span><span style="color:#A6ACCD">`</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">		.</span><span style="color:#E4F0FBD0">then</span><span style="color:#A6ACCD">((</span><span style="color:#E4F0FB">response</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#E4F0FB"> response</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">json</span><span style="color:#A6ACCD">())</span></span>
<span class="line"><span style="color:#A6ACCD">		.</span><span style="color:#E4F0FBD0">then</span><span style="color:#A6ACCD">((</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">			setRaces</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">MRData</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">RaceTable</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">Races</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	fetch</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">`</span><span style="color:#5DE4C7">https://ergast.com/api/f1/2018/driverStandings.json</span><span style="color:#A6ACCD">`</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#A6ACCD">		.</span><span style="color:#E4F0FBD0">then</span><span style="color:#A6ACCD">((</span><span style="color:#E4F0FB">response</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#E4F0FB"> response</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">json</span><span style="color:#A6ACCD">())</span></span>
<span class="line"><span style="color:#A6ACCD">		.</span><span style="color:#E4F0FBD0">then</span><span style="color:#A6ACCD">((</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">			let</span><span style="color:#E4F0FB"> raceWinner</span><span style="color:#91B4D5"> =</span></span>
<span class="line"><span style="color:#E4F0FB">				data</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">MRData</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">StandingsTable</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">StandingsLists</span><span style="color:#A6ACCD">[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].</span><span style="color:#E4F0FB">DriverStandings</span><span style="color:#A6ACCD">[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].</span><span style="color:#E4F0FB">Driver</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">familyName</span><span style="color:#91B4D5"> +</span></span>
<span class="line"><span style="color:#A6ACCD">				'</span><span style="color:#A6ACCD"> '</span><span style="color:#91B4D5"> +</span></span>
<span class="line"><span style="color:#E4F0FB">				data</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">MRData</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">StandingsTable</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">StandingsLists</span><span style="color:#A6ACCD">[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].</span><span style="color:#E4F0FB">DriverStandings</span><span style="color:#A6ACCD">[</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">].</span><span style="color:#E4F0FB">Driver</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">givenName</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FBD0">			setWinner</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">raceWinner</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"><span style="color:#A6ACCD">}, []);</span></span>
<span class="line"></span></code></pre>
<p>В приложении мы используем хук <code>useEffect</code> для выполнения вызовов API и получения данных о гонках F1, а затем используем функции <code>setRaces</code> и <code>setWinner</code> для установки соответствующих значений в состояние.</p>
<p>Это лишь пример того, как хуки можно использовать в комбинации для создания приложения. Мы используем хук <code>useEffect</code> для получения данных из какого-либо источника и <code>useState</code> для установки полученных данных в состояние.</p>
<h2 id="что-такое-jest">Что такое Jest?<a aria-hidden="true" tabindex="-1" href="#что-такое-jest"><span class="icon icon-link"></span></a></h2>
<p>Jest - это фреймворк для тестирования JavaScript с акцентом на простоту, который позволяет легко писать тесты для ваших JavaScript-приложений. Он также подходит для тестирования приложений на TypeScript, React, React Native и Vue.</p>
<p>Jest поставляется с готовой конфигурацией для JavaScript-файлов и элегантным API, который используется для создания изолированных тестов, сравнения моментальных снимков, подражания тестам, покрытия тестами и многого другого.</p>
<p>Зачем использовать Jest с Enzyme или библиотекой тестирования React?</p>
<p>React Testing Library и Enzyme - это утилиты для тестирования, которые предоставляют методы для доступа к элементам DOM. Однако они не работают с утверждениями, которые проверяют, истинно ли определенное условие, и выбрасывают ошибку, если оно не истинно.</p>
<p>Чтобы работать с утверждениями, вам нужен прогонщик тестов и фреймворк. Именно здесь на помощь приходит Jest. Jest действует как прогонщик тестов, который определяет тесты, выполняет их и решает, прошли они или нет. Он также предоставляет функции для утверждений, реализации кода и тестовых наборов.</p>
<p>Jest считается де-факто фреймворком тестирования для React-приложений, что делает его популярным выбором в экосистеме React. Простота использования, широкие возможности и активное сообщество способствуют его популярности.широкое распространение для тестирования.</p>
<h2 id="что-такое-энзим">Что такое энзим?<a aria-hidden="true" tabindex="-1" href="#что-такое-энзим"><span class="icon icon-link"></span></a></h2>
<p>Enzyme - это утилита для тестирования на JavaScript для React, которая упрощает утверждение, манипулирование и обход вывода компонентов React. Она также предоставляет набор удобных методов для работы с компонентами React, позволяя разработчикам более эффективно писать тесты для своих React-приложений.</p>
<p>Некоторые примечательные особенности Enzyme включают:</p>
<p>Неглубокий рендеринг: Рендеринг только текущего компонента без рендеринга его дочерних компонентов. Это может быть полезно при тестировании компонента как единицы и для того, чтобы ваши тесты не утверждали косвенно поведение дочерних компонентов Полный рендеринг DOM: Отрисовывает полный DOM и позволяет взаимодействовать с дочерними компонентами, что делает его подходящим для более комплексных интеграционных тестов Mocking functions and components: Это полезно, когда вы хотите изолировать тестируемый компонент от его зависимостей</p>
<p>Давайте посмотрим, как мы можем использовать Enzyme для тестирования React Hooks.</p>
<h2 id="тестирование-react-hooks-с-помощью-enzyme">Тестирование React Hooks с помощью Enzyme<a aria-hidden="true" tabindex="-1" href="#тестирование-react-hooks-с-помощью-enzyme"><span class="icon icon-link"></span></a></h2>
<p>Для начала создадим проект с помощью Create React App следующим образом:</p>
<p><code>npx create-react-app my-app cd my-app</code>
Далее мы установим тестовую библиотеку Enzyme вместе с адаптером React следующим образом:</p>
<p><code>npm i --save-dev enzyme enzyme-adapter-react-16</code>
Теперь создайте файл <code>setupTests.js</code> в папке <code>src</code>. Добавьте в него следующий фрагмент для настройки адаптера Enzyme:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">Enzyme</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">enzyme</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">Adapter</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">enzyme-adapter-react-16</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">Enzyme</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">configure</span><span style="color:#A6ACCD">({</span><span style="color:#ADD7FF"> adapter</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> new</span><span style="color:#E4F0FBD0"> Adapter</span><span style="color:#A6ACCD">()</span><span style="color:#A6ACCD"> });</span></span>
<span class="line"></span></code></pre>
<p>Код в файле <code>setupTests.js</code> будет выполнен перед выполнением нашего теста.</p>
<h2 id="тестирование-хука-usestate-с-помощью-enzyme">Тестирование хука <code>useState</code> с помощью Enzyme<a aria-hidden="true" tabindex="-1" href="#тестирование-хука-usestate-с-помощью-enzyme"><span class="icon icon-link"></span></a></h2>
<p>Чтобы протестировать хук <code>useState</code>, давайте обновим файл <code>app.js</code> следующим образом:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">React</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#ADD7FF"> App</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">name</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">setName</span><span style="color:#A6ACCD">] </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FB"> React</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">useState</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">''</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">	return</span><span style="color:#A6ACCD"> (</span></span>
<span class="line"><span style="color:#E4F0FB">		&#x3C;</span><span style="color:#5DE4C7">form</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">			&#x3C;</span><span style="color:#5DE4C7">div</span><span style="color:#91B4D5;font-style:italic"> className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">row</span><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">				&#x3C;</span><span style="color:#5DE4C7">div</span><span style="color:#91B4D5;font-style:italic"> className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">col-md-6</span><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">					&#x3C;</span><span style="color:#5DE4C7">input</span></span>
<span class="line"><span style="color:#91B4D5;font-style:italic">						type</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">text</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#91B4D5;font-style:italic">						placeholder</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">Введите ваше имя</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#91B4D5;font-style:italic">						className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">input</span><span style="color:#A6ACCD">"</span></span>
<span class="line"><span style="color:#91B4D5;font-style:italic">						onChange</span><span style="color:#91B4D5">=</span><span style="color:#E4F0FB">{</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">e</span><span style="color:#A6ACCD">)</span><span style="color:#91B4D5"> =></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">							setName</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">e</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">target</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">value</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">						}</span><span style="color:#E4F0FB">}</span></span>
<span class="line"><span style="color:#E4F0FB">					/></span></span>
<span class="line"><span style="color:#E4F0FB">				&#x3C;/</span><span style="color:#5DE4C7">div</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">			&#x3C;/</span><span style="color:#5DE4C7">div</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">			&#x3C;</span><span style="color:#5DE4C7">div</span><span style="color:#91B4D5;font-style:italic"> className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">row</span><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">				&#x3C;</span><span style="color:#5DE4C7">div</span><span style="color:#91B4D5;font-style:italic"> className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">col-md-6</span><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">					&#x3C;</span><span style="color:#5DE4C7">button</span><span style="color:#91B4D5;font-style:italic"> type</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">submit</span><span style="color:#A6ACCD">"</span><span style="color:#91B4D5;font-style:italic"> className</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">btn btn-primary</span><span style="color:#A6ACCD">"</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">						Добавить имя</span></span>
<span class="line"><span style="color:#E4F0FB">					&#x3C;/</span><span style="color:#5DE4C7">button</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">				&#x3C;/</span><span style="color:#5DE4C7">div</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">			&#x3C;/</span><span style="color:#5DE4C7">div</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#E4F0FB">		&#x3C;/</span><span style="color:#5DE4C7">form</span><span style="color:#E4F0FB">></span></span>
<span class="line"><span style="color:#A6ACCD">	);</span></span>
<span class="line"><span style="color:#A6ACCD">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7">export default </span><span style="color:#E4F0FB">App</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span></code></pre>
<p>Здесь у нас есть базовое поле ввода и элемент кнопки. Обратите внимание, что мы использовали <code>React.useState()</code> вместо <code>useState()</code>. Это нужно нам для поддержки имитации хука <code>useState</code> в нашем тесте Enzyme:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">React</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> shallow</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">enzyme</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">App</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">./App</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> setState</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">fn</span><span style="color:#A6ACCD">();</span></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> useStateSpy</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">spyOn</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">React</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">useState</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FB">useStateSpy</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mockImplementation</span><span style="color:#A6ACCD">((</span><span style="color:#E4F0FB">initialState</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">initialState</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">setState</span><span style="color:#A6ACCD">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> wrapper</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> shallow</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">App</span><span style="color:#E4F0FB"> /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span></code></pre>
<p>Здесь мы успешно сымитировали хук <code>useState</code> и можем приступить к тестированию обновления состояния при изменении ввода следующим образом:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E4F0FBD0">it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">should update state on input change</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> newInputValue</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">React is Awesome</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">	wrapper</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">find</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">.input</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">simulate</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">change</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, {</span></span>
<span class="line"><span style="color:#ADD7FF">		target</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> {</span><span style="color:#ADD7FF"> value</span><span style="color:#A6ACCD">:</span><span style="color:#E4F0FB"> newInputValue</span><span style="color:#A6ACCD"> },</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">setState</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toHaveBeenCalledWith</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">newInputValue</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Enzyme поддерживает React Hooks, хотя в <code>.shallow()</code> есть некоторые недостатки, связанные с проблемами, возникшими в React’s shallow renderer. При неглубоком рендере React не вызываются <code>useEffect()</code> и <code>useLayoutEffect()</code>.</p>
<h2 id="тестирование-хуков-react-с-помощью-библиотеки-react-testing-library">Тестирование хуков React с помощью библиотеки React Testing Library<a aria-hidden="true" tabindex="-1" href="#тестирование-хуков-react-с-помощью-библиотеки-react-testing-library"><span class="icon icon-link"></span></a></h2>
<p>Библиотека React Testing Library - это легкое решение для тестирования компонентов React. Она расширяет <code>react-dom</code> и <code>react-dom/test-utils</code> для предоставления легких вспомогательных функций. Она поощряет вас писать тесты, которые очень похожи на то, как используются ваши компоненты React.</p>
<p>Основная цель React Testing Library - повысить уверенность разработчиков в своих тестах, тестируя компоненты так, как их использует пользователь. Она уже установлена в CRA, что делает ее легкодоступной - и, следовательно, широко используемой - библиотекой тестов для React.</p>
<p>Давайте посмотрим пример написания тестов для Hooks с помощью библиотеки React Testing Library.</p>
<p>В приведенном выше приложении мы используем три типа хуков - <code>useState</code>, <code>useEffect</code> и <code>useRef</code>. Мы будем писать тесты для всех них.</p>
<p>Для реализации хука <code>useRef</code> мы, по сути, создаем экземпляр <code>ref</code> с помощью <code>useRef</code> и устанавливаем его на поле ввода. Это означает, что теперь мы можем получить доступ к значению ввода через ссылку. Между тем, тест <code>useEffect</code> Hook, по сути, устанавливает значение состояния <code>name</code> в <code>localStorage</code>.</p>
<p>Давайте продолжим писать тесты для всех описанных выше реализаций. Мы будем писать тесты для проверки этого:</p>
<p>Начальное состояние <code>count</code> равно <code>0</code> Кнопки <code>increment</code> и <code>decrement</code> работают Отправка имени через поле ввода изменяет значение состояния <code>name</code> Состояние <code>name</code> сохраняется в <code>localStorage</code>.</p>
<p>Перейдите в папку <code>__tests__</code>, чтобы увидеть файл <code>hooktest.js</code>, содержащий набор тестов и строку кода <code>import</code> ниже:</p>
<p><code>// hooktest.js import { render, fireEvent, getByTestId} from "react-testing-library";</code></p>
<p>В этой строке кода:</p>
<p><code>render</code> поможет рендерить наш компонент. Он рендерит в контейнер, который добавляется к <code>document.body</code> <code>getByTestId</code> получает элемент DOM по <code>data-TestId</code> <code>fireEvent</code> используется для ”запуска” событий DOM. Он прикрепляет обработчик событий к документу и обрабатывает некоторые события DOM через делегирование событий - например, нажатие кнопки</p>
<p>Далее добавьте приведенный ниже набор тестов в файл <code>hooktest.js</code>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">// hooktest.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">App loads with initial state of 0</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> render</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">App</span><span style="color:#E4F0FB"> /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> countValue</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">countvalue</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">countValue</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">textContent</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Тест проверяет, что начальное состояние count установлено в <code>0</code>, сначала получая элемент с помощью помощника <code>getByTestId</code>. Затем он проверяет, равно ли содержимое <code>0</code>, используя функции <code>expect()</code> и <code>toBe()</code>.</p>
<p>Далее мы напишем тест, чтобы проверить, работают ли кнопки увеличения и уменьшения:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">// hooktest.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Кнопки инкремента и декремента работают</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> render</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">App</span><span style="color:#E4F0FB"> /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> countValue</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">countvalue</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> increment</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">incrementButton</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> decrement</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">decrementButton</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">countValue</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">textContent</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">	fireEvent</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">click</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">increment</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">countValue</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">textContent</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">1</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">	fireEvent</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">click</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">decrement</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">countValue</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">textContent</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">0</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В приведенном выше тесте мы проверяем, что состояние устанавливается в <code>1</code>, если нажата кнопка <code>onButton</code>, и что состояние устанавливается в <code>0</code>, если нажата кнопка <code>offButton</code>.</p>
<p>На следующем этапе мы напишем тест для проверки того, действительно ли ввод имени через поле ввода изменяет значение состояния <code>name</code>, а также для проверки того, что оно успешно сохраняется в <code>localStorage</code>:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#767C9DB0;font-style:italic">// hooktest.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Ввод имени через поле ввода изменяет значение состояния имени</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">rerender</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> render</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">App</span><span style="color:#E4F0FB"> /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> nameValue</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">namevalue</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> inputName</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">inputName</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> submitButton</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> getByTestId</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">container</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">submitRefButton</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> newName</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Ben</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">	fireEvent</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">change</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">inputName</span><span style="color:#A6ACCD">, {</span><span style="color:#ADD7FF"> target</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> {</span><span style="color:#ADD7FF"> value</span><span style="color:#A6ACCD">:</span><span style="color:#E4F0FB"> newName</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> });</span></span>
<span class="line"><span style="color:#E4F0FB">	fireEvent</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">click</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">submitButton</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">nameValue</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">textContent</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toEqual</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">newName</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	rerender</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">&#x3C;</span><span style="color:#5DE4C7">App</span><span style="color:#E4F0FB"> /></span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">window</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">localStorage</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">getItem</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">name</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">newName</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В тестовом утверждении выше мы использовали метод <code>fireEvent.change</code> для ввода значения в поле <code>input</code>, после чего вызвали событие для нажатия на кнопку <code>submitButton</code>.</p>
<p>Затем тест проверяет, равно ли значение ref после нажатия кнопки <code>newName</code>. Наконец, используя метод <code>rerender</code>, мы имитируем перезагрузку приложения и проверяем, сохранилось ли заданное ранее имя в <code>localStorage</code>.</p>
<h2 id="тестирование-функций-async-hook">Тестирование функций async Hook<a aria-hidden="true" tabindex="-1" href="#тестирование-функций-async-hook"><span class="icon icon-link"></span></a></h2>
<p>Чтобы реализовать тесты для асинхронных хуков, мы можем использовать функцию <code>waitForNextUpdate</code> из библиотеки тестирования хуков React.</p>
<p>Асинхронные методы возвращают обещания, поэтому не забывайте вызывать их с помощью <code>await</code> или <code>.then</code>. Библиотека тестирования React Hooks предоставляет метод <code>waitFor</code> для тестирования асинхронных хуков.</p>
<p>Асинхронный хук, который мы будем тестировать, принимает в качестве параметра URL API, делает асинхронный запрос с помощью Axios и возвращает объект ответа.</p>
<p>Создайте файл <code>useFetchData.js</code> в папке <code>src</code> и добавьте в него следующее:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">axios</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">axios</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> endpoint</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">https://jsonplaceholder.typicode.com/posts/1</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7">export default </span><span style="color:#91B4D5">function</span><span style="color:#ADD7FF"> Endpoint</span><span style="color:#A6ACCD">()</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> [</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB"> setData</span><span style="color:#A6ACCD">]</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FB"> React</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">useState</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">		state</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">LOADING</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">		error</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> ''</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">		data</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> [],</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#ADD7FF"> fetchData</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7"> async </span><span style="color:#A6ACCD">()</span><span style="color:#91B4D5"> =></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#D0679D">		try</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">			const</span><span style="color:#E4F0FB"> result</span><span style="color:#91B4D5"> =</span><span style="color:#5DE4C7C0"> await</span><span style="color:#E4F0FB"> axios</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">get</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">endpoint</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#E4F0FBD0">			setData</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">				state</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">SUCCESS</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">				error</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> ''</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">				data</span><span style="color:#A6ACCD">:</span><span style="color:#E4F0FB"> result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">data</span><span style="color:#A6ACCD">,</span><span style="color:#767C9DB0;font-style:italic"> // Получаем доступ к данным напрямую</span></span>
<span class="line"><span style="color:#A6ACCD">			});</span></span>
<span class="line"><span style="color:#A6ACCD">		}</span><span style="color:#D0679D"> catch</span><span style="color:#A6ACCD"> (</span><span style="color:#E4F0FB">err</span><span style="color:#A6ACCD">)</span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">			setData</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">				data</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> [],</span></span>
<span class="line"><span style="color:#ADD7FF">				state</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">ERROR</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">				error</span><span style="color:#A6ACCD">:</span><span style="color:#E4F0FB"> err</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">			});</span></span>
<span class="line"><span style="color:#A6ACCD">		}</span></span>
<span class="line"><span style="color:#A6ACCD">	};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">	React</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">useEffect</span><span style="color:#A6ACCD">(()</span><span style="color:#91B4D5"> =></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">		fetchData</span><span style="color:#A6ACCD">();</span></span>
<span class="line"><span style="color:#A6ACCD">	},</span><span style="color:#A6ACCD"> []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#5DE4C7C0">	return</span><span style="color:#E4F0FB"> data</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Теперь давайте протестируем наш асинхронный хук. Создайте файл <code>useFetchData.test.js</code> в папке <code>src</code> и добавьте в него следующее:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> renderHook</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">@testing-library/react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">useFetchData</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">./useFetchData</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">axios</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">axios</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> act</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">react-dom/test-utils</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mock</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">axios</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> useApiMockData</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> [</span></span>
<span class="line"><span style="color:#A6ACCD">	{</span><span style="color:#ADD7FF"> id</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 1</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> name</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Leanne Graham</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD"> },</span></span>
<span class="line"><span style="color:#A6ACCD">	{</span><span style="color:#ADD7FF"> id</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 2</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> name</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Ervin Howell</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD"> },</span></span>
<span class="line"><span style="color:#A6ACCD">];</span></span>
<span class="line"></span></code></pre>
<p>Здесь мы используем метод <code>jest.mock</code> для подражания Axios для тестирования асинхронных действий. Кроме того, мы смоделировали некоторые типичные данные ответа для нашего теста.</p>
<p>Далее мы напишем тест для успешных и неудачных запросов к API:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E4F0FBD0">describe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">useFetchData Hook</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">	it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">начальное и успешное состояние</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">		axios</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">get</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mockResolvedValue</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">useApiMockData</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#91B4D5">		const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> renderHook</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#E4F0FBD0"> useFetchData</span><span style="color:#A6ACCD">());</span></span>
<span class="line"><span style="color:#E4F0FBD0">		act</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">state</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">SUCCESS</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">error</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> ''</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">data</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> [];</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"><span style="color:#E4F0FBD0">		expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toMatchObject</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">			data</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> [],</span></span>
<span class="line"><span style="color:#ADD7FF">			error</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> ''</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">			state</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">SUCCESS</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">	it</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">error state</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">		const</span><span style="color:#E4F0FB"> errorMessage</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Network Error</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">		axios</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">get</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mockImplementationOnce</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#ADD7FF"> Promise</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">reject</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7">new</span><span style="color:#E4F0FBD0"> Error</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">errorMessage</span><span style="color:#A6ACCD">)));</span></span>
<span class="line"><span style="color:#91B4D5">		const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> renderHook</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#E4F0FBD0"> useFetchData</span><span style="color:#A6ACCD">());</span></span>
<span class="line"><span style="color:#E4F0FBD0">		act</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">state</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">ERROR</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">error</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Fetch failed</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">			result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">data</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> [];</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"><span style="color:#E4F0FBD0">		expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toMatchObject</span><span style="color:#A6ACCD">({</span></span>
<span class="line"><span style="color:#ADD7FF">			data</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> [],</span></span>
<span class="line"><span style="color:#ADD7FF">			error</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Fetch failed</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#ADD7FF">			state</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">ERROR</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">		});</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В блоке кода above, мы имитируем наш вызов Axios и обновления состояния. Обратите внимание, как метод <code>act()</code> оборачивает код, который вызывает любые обновления состояния в результате асинхронного запроса. Теперь, когда мы запускаем наш тест, мы видим, что все проходит, как показано на изображении ниже:</p>
<figure class="igorlov-figure"><img  src="/_astro/Tests-passing-successfully.B4z3PY2K_1TBph9.webp" alt="Tests-passing-successfully.png" width="895" height="422" loading="lazy" decoding="async"><figcaption>Tests-passing-successfully.png</figcaption></figure>
<p>Общие подводные камни и решения при тестировании React Hooks</p>
<p>Тестирование React Hooks может быть довольно сложным. В этом разделе мы рассмотрим некоторые распространенные подводные камни, с которыми вы можете столкнуться, и решения для их устранения.</p>
<h2 id="тестирование-хуков-с-внешними-зависимостями">Тестирование хуков с внешними зависимостями<a aria-hidden="true" tabindex="-1" href="#тестирование-хуков-с-внешними-зависимостями"><span class="icon icon-link"></span></a></h2>
<p>В вашем React-приложении есть определенные сценарии, когда ваш React Hook может зависеть от определенных операций, пакетов или API. Это может быть сложно изолировать и протестировать. Если эти зависимости являются внешними API, которые могут измениться в любой момент, моделирование поведения становится еще более сложным.</p>
<p>Решением этой проблемы является имитация зависимостей. Издевательство заключается в замене реальных компонентов или функций их имитационными версиями при выполнении тестов.</p>
<p>Ниже приведен пример имитации API-запроса:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">axios</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">axios</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#E4F0FB">jest</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mock</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">axios</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#91B4D5">const</span><span style="color:#E4F0FB"> mockedData</span><span style="color:#91B4D5"> =</span><span style="color:#A6ACCD"> [</span></span>
<span class="line"><span style="color:#A6ACCD">	{</span><span style="color:#ADD7FF"> id</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 1</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> name</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Джимми</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> isVerified</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> true</span><span style="color:#A6ACCD"> },</span></span>
<span class="line"><span style="color:#A6ACCD">	{</span><span style="color:#ADD7FF"> id</span><span style="color:#A6ACCD">:</span><span style="color:#5DE4C7"> 2</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> name</span><span style="color:#A6ACCD">:</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Томми</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> isVerified</span><span style="color:#A6ACCD">:</span><span style="color:#D0679D"> false</span><span style="color:#A6ACCD"> },</span></span>
<span class="line"><span style="color:#A6ACCD">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">describe</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Mocking an API</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">	test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">должен получить данные из API</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FB">		axios</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">get</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">mockResolvedValue</span><span style="color:#A6ACCD">({</span><span style="color:#ADD7FF"> data</span><span style="color:#A6ACCD">:</span><span style="color:#E4F0FB"> mockedData</span><span style="color:#A6ACCD"> });</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В приведенном выше блоке кода мы импортировали зависимость, которую будет использовать наше приложение - в данном случае <code>axios</code>. Затем мы имитировали зависимость с помощью Jest и сымитировали ожидаемый результат</p>
<h2 id="тестирование-хуков-вызывающих-побочные-эффекты">Тестирование хуков, вызывающих побочные эффекты<a aria-hidden="true" tabindex="-1" href="#тестирование-хуков-вызывающих-побочные-эффекты"><span class="icon icon-link"></span></a></h2>
<p>Побочные эффекты - это любые действия, которые происходят вне области действия выполняемой функции. Примером побочного эффекта может служить получение данных или манипуляции с DOM браузера. Тестирование побочных эффектов может быть сложным, поскольку они в основном асинхронны по своей природе, что может привести к непредсказуемым результатам тестирования.</p>
<p>Решением этой проблемы является использование функции <code>waitFor</code> из библиотеки тестирования React с <code>async/await</code> для ожидания завершения асинхронных операций перед выполнением утверждений:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> waitFor</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">@testing-library/react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">should trigger side effect</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">	// Триггер побочного эффекта</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#E4F0FB"> resultPromise</span><span style="color:#91B4D5"> =</span><span style="color:#E4F0FBD0"> someAsyncFunction</span><span style="color:#A6ACCD">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">	// Ждем разрешения обещания</span></span>
<span class="line"><span style="color:#5DE4C7C0">	await</span><span style="color:#E4F0FBD0"> waitFor</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#E4F0FBD0">		expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">resultPromise</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FB">resolves</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#767C9DB0;font-style:italic">/* ожидаемое значение */</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">	});</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Блок кода выше показывает, как использовать функцию <code>waitFor</code> с <code>async/await</code> для ожидания асинхронного кода.</p>
<h2 id="тестирование-пользовательских-хуков">Тестирование пользовательских хуков<a aria-hidden="true" tabindex="-1" href="#тестирование-пользовательских-хуков"><span class="icon icon-link"></span></a></h2>
<p>Тестирование пользовательских хуков в React также может быть сложным, потому что пользовательские хуки отличаются от компонентов. При попытке протестировать их с помощью функции <code>render()</code> из библиотеки React Testing Library вы получите ошибку, которая связана с тем, что React Hooks нельзя использовать вне компонентов React.</p>
<p>Решением этой проблемы является использование функции <code>renderHook()</code> вместо функции <code>render()</code>. Функция <code>renderHook()</code> предоставляет среду для рендеринга хуков вне компонентов, как показано в блоке кода ниже:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> renderHook</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">@testing-library/react</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">useCustomHook</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">./useCustomHook</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">должно что-то сделать</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#91B4D5">	const</span><span style="color:#A6ACCD"> { </span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD"> } </span><span style="color:#91B4D5">=</span><span style="color:#E4F0FBD0"> renderHook</span><span style="color:#A6ACCD">(() </span><span style="color:#91B4D5">=></span><span style="color:#E4F0FBD0"> useCustomHook</span><span style="color:#A6ACCD">());</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">	// Утверждения, основанные на возвращаемом хуком значении</span></span>
<span class="line"><span style="color:#E4F0FBD0">	expect</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">result</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">current</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">someValue</span><span style="color:#A6ACCD">).</span><span style="color:#E4F0FBD0">toBe</span><span style="color:#A6ACCD">(</span><span style="color:#767C9DB0;font-style:italic">/* ожидаемое значение */</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>В приведенном выше коде мы импортировали функцию <code>renderHook()</code> и пользовательский хук. После этого мы успешно и без ошибок выполнили наши тесты.</p>
<h2 id="сравнение-библиотек-тестирования-enzyme-jest-и-react">Сравнение библиотек тестирования Enzyme, Jest и React<a aria-hidden="true" tabindex="-1" href="#сравнение-библиотек-тестирования-enzyme-jest-и-react"><span class="icon icon-link"></span></a></h2>
<p>Давайте сравним Enzyme, Jest и React Testing Library с помощью таких показателей, как производительность тестирования, возможности мокинга, масштабируемость и многое другое:</p>
<h3 id="метрики-enzyme-jest-react-testing-library">Метрики Enzyme Jest React Testing Library<a aria-hidden="true" tabindex="-1" href="#метрики-enzyme-jest-react-testing-library"><span class="icon icon-link"></span></a></h3>
<p>Производительность Выполняется хорошо, но обширный набор функций может повлиять на производительность. Некоторые факторы, такие как размер проекта, также могут ограничивать производительность Высокая производительность Известен своей легковесной конструкцией, которая способствует лучшей производительности при рендеринге и запросах</p>
<p>Удобство использования Предоставляет богатые возможности для тестирования и манипулирования компонентами Общецелевой фреймворк для тестирования, предлагающий полный набор функций Упор делается на простоту, тестирование, ориентированное на пользователя, и эффективные запросы к компонентам</p>
<p>Тестирование моментальных снимков Поддерживается с помощью пакета enzyme-to-json Поддерживается Может работать с тестированием моментальных снимков, но он не был для этого предназначен</p>
<p>Мощные возможности и утилиты для имитации Мощные возможности и утилиты для имитации Поставляется со встроенными возможностями для имитации Ограниченное количество встроенных возможностей для имитации</p>
<p>Обновления и сопровождение Активно поддерживается Активно поддерживается Активно поддерживается</p>
<p>Масштабируемость Становится менее масштабируемым для больших приложений Масштабируется хорошо для приложений любого размера Масштабируется хорошо для приложений любого размера</p>
<p>Эта таблица должна дать вам лучшее представление о том, когда и как использовать каждый инструмент. Помните, что, как мы уже говорили, Jest - это отличный инструмент для использования вместе с Enzyme или React Testing Library. Например, вы можете использовать Jest для обработки ассетовричины использования библиотеки React Testing Library для управления взаимодействием с компонентами React.</p>
<h2 id="заключение">Заключение<a aria-hidden="true" tabindex="-1" href="#заключение"><span class="icon icon-link"></span></a></h2>
<p>В этой статье мы рассмотрели, как использовать React Hooks, и обсудили, как писать тесты для React Hooks и React-компонентов с помощью Jest, Enzyme и React Testing Library. Мы также сравнили эти три варианта тестирования React-компонентов, чтобы лучше понять, как каждый инструмент может вписаться в нашу стратегию тестирования.</p>
<p>Кроме того, мы рассказали о некоторых проблемах тестирования React Hooks и решениях, которые можно применить для их устранения. Вы можете ознакомиться с демо-проектом, который мы использовали для изучения тестирования React Hooks, на CodeSandbox.</p>
<p>Хотите узнать больше? Ознакомьтесь с этой статьей о том, как избежать распространенных ошибок при работе с React Hooks. Если у вас есть вопросы или комментарии, вы можете поделиться ими ниже.</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Как тестировать хуки React&url=https://igorlov.ru/blog/kak-testyrovat-khuky-react" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/kak-testyrovat-khuky-react&title=Как тестировать хуки React&summary=Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testi&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/kak-testyrovat-khuky-react&media=&description=Примечание редактора: Эта статья была обновлена 18 декабря 2023 года Айзеком Окоро, чтобы добавить более подробный обзор и сравнение Jest, Enzyme и React Testi" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/sozdanye-konstruktora-tenei-y-boksov-v-30-strokakh-koda-shablona-html-web-component-1-dopolnyteln-i-fail-bez-js-y-uzlov" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Создание конструктора теней и боксов в ~30 строках кода шаблона HTML Web Component + 1 дополнительный файл (без JS и узлов!) </a> <a href="/blog/skolko-javascript-dostatochno-dlia-yzuchenyia-reactjs" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Сколько JavaScript достаточно для изучения ReactJS? </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>