<!DOCTYPE html><html lang="ru"> <head><title>Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3) | Игорь Горлов - Фронтeндер</title><link rel="canonical" href="https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3"><meta name="description" content="Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного"><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.9.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.CyGIBtQS.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.C0aKA9dM.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-r75ddqls-1"] { view-transition-name: blog-image-chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/обзор" class="categories__link" data-astro-cid-axzg2cw6> Обзор  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3) </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/nodejs" data-astro-cid-axzg2cw6> Node.js </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 18 дек., 2023 by Игорь Горлов </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3-Dec-18-2023.DHpTbY6i_Z2lsEHy.avif" type="image/avif"><source srcset="/_astro/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3-Dec-18-2023.DHpTbY6i_1RFC5s.webp" type="image/webp"> <img src="/_astro/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3-Dec-18-2023.DHpTbY6i_Z5Tz19.png" alt="Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3)" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-r75ddqls-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div id="adfox_17062261612859555"></div> <script>(function(){const blockId = "adfox_17062261612859555";

	window.yaContextCb = window.yaContextCb || [];
	window.yaContextCb.push(() => {
		Ya.adfoxCode.createAdaptive(
			{
				ownerId: 1493338,
				containerId: blockId,
				params: {
					p1: 'dawgg',
					p2: 'p',
				},
			},
			['desktop', 'tablet', 'phone'],
			{
				tabletWidth: 830,
				phoneWidth: 480,
				isAutoReloads: true,
			},
		);
	});
})();</script> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3)&url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3&title=Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3)&summary=Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3&media=&description=Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <details open  class="toc border border-blue text-blue fluid:p-8 cursor-pointer rounded-[50px]"><summary class="toc__title text-xl font-medium">Содержание</summary><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#начало-работы-с-nodejs-v20">Начало работы с Node.js v20</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#экспериментальная-модель-разрешений">Экспериментальная модель разрешений</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#стабильный-прогонщик-тестов">Стабильный прогонщик тестов</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#движок-v8-javascript-обновлен-до-версии-113">Движок V8 JavaScript обновлен до версии 11.3</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#синхронный-импортmetaresolve">Синхронный импорт.meta.resolve()</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#экспериментальные-одноисполняемые-приложения-sea">Экспериментальные одноисполняемые приложения (SEA)</a></li><li class="toc-item toc-item-h2"><a class="text-blue text-blue-h2" href="#производительность">Производительность</a></li></ol></details open ><p>Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного безопаснее и работать лучше.</p>
<p>Важно знать, что поскольку это четный выпуск, он должен стать версией долгосрочной поддержки (LTS) в октябре 2023 года и будет поддерживаться до апреля 2026 года. Однако команда Node.js активно ищет отзывы сообщества, чтобы выявить и устранить любые проблемы до того, как она будет переведена в разряд LTS.</p>
<p>В новом выпуске Node.js появились такие интересные обновления и функции, которые наверняка оценят разработчики, как экспериментальная модель разрешений, синхронный <code>import.meta.resolve</code>, стабильный прогон тестов, обновление движка V8 JavaScript до версии 11.3, улучшение производительности и исправление ошибок, а также многое другое.</p>
<p>В этой статье вы познакомитесь с изменениями, внесенными в Node.js v20, и подробно рассмотрите ее новые функции и возможности.</p>
<h2 id="начало-работы-с-nodejs-v20">Начало работы с Node.js v20<a aria-hidden="true" tabindex="-1" href="#начало-работы-с-nodejs-v20"><span class="icon icon-link"></span></a></h2>
<p>Установка Node.js v20 довольно похожа на установку других версий Node.js. Все, что вам нужно сделать, это:</p>
<p>Загрузить пакет установщика с официального сайта Node.js. После загрузки программы установки запустите ее и следуйте инструкциям, чтобы завершить процесс установки. Этот процесс довольно прост, и вам просто нужно согласиться с лицензионным соглашением и нажать кнопку ”Далее”. Перезагрузите систему/машину после завершения процесса установки, чтобы убедиться, что все изменения вступили в силу. Проверьте установку Node.js, выполнив следующую команду:</p>
<figure class="igorlov-figure"><img  src="/_astro/verify-node-v20-instalation.DjdH5M9L_Z1jJfP.webp" alt="verify-node-v20-instalation.jpg" width="1600" height="225" loading="lazy" decoding="async"><figcaption>verify-node-v20-instalation.jpg</figcaption></figure>
<p>Если вы видите номер версии (v20.0.0), это означает, что Node.js установлен правильно, и вы готовы начать работу с Node.js v20.</p>
<p>Node.js v20 прибыл! Ознакомьтесь с Permission Model, синхронным import.meta.resolve, стабильным тестовым бегуном и другими интересными функциями и обновлениями здесь ⬇️Click to Tweet Что нового в Node.js v20?</p>
<p>Давайте рассмотрим 5 основных обновлений, представленных в этом выпуске Node.js. К ним относятся:</p>
<h2 id="экспериментальная-модель-разрешений">Экспериментальная модель разрешений<a aria-hidden="true" tabindex="-1" href="#экспериментальная-модель-разрешений"><span class="icon icon-link"></span></a></h2>
<p>Введение экспериментальной модели разрешений в Node.js v20 - это значительное дополнение, которое дает разработчикам больше контроля над доступом к определенным ресурсам во время выполнения.</p>
<p>Эта новая возможность полезна, когда безопасность и использование ресурсов критически важны, например, в производственной среде.</p>
<p>Модель разрешений включает в себя несколько возможностей, в том числе ограничение доступа к файловой системе, child_process, worker_threads и родным аддонам.</p>
<p>Разработчики могут использовать такие флаги, как <code>--allow-fs-read</code>, <code>--allow-fs-write</code> и <code>--allow-child-process</code>, чтобы указать, какие ресурсы доступны. Чтобы активировать эти флаги, разработчикам необходимо использовать флаг <code>--experimental-permission</code> в сочетании с необходимыми разрешениями.</p>
<p>Вот пример использования модели разрешений для разрешения доступа на чтение и запись ко всей файловой системе:</p>
<p><code>$ node --experimental-permission --allow-fs-read=* --allow-fs-write=* index.js</code>.</p>
<p>Разработчики также могут использовать модель разрешений для указания доступа к определенным папкам и файлам. Например, следующая команда разрешает доступ на запись в папку /tmp/:</p>
<p><code>$ node --experimental-permission --allow-fs-write=/tmp/ --allow-fs-read=/home/index.js index.js</code>.</p>
<p>Одним из существенных преимуществ модели разрешений является возможность более детального контроля над доступом к файловой системе. Например, разработчики могут указывать пути и шаблоны подстановочных знаков, чтобы разрешить доступ к определенным папкам или файлам.</p>
<p><code>$ node --experimental-permission --allow-fs-read=/home/user/* index.js</code></p>
<p>Приведенная выше команда предоставляет доступ на чтение ко всем папкам внутри каталога /home/user/.</p>
<p>Свойство permission объекта процесса также можно использовать для проверки того, было ли предоставлено определенное разрешение во время выполнения. Например, если вы хотите проверить, имеет ли ваш процесс Node.js доступ на чтение к определенной папке, /home/user/documents, вы можете использовать следующий код:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#A6ACCD">if (</span><span style="color:#E4F0FB">process</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FB">permission</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">has</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">fs.read</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">/home/user/documents</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">)) {</span></span>
<span class="line"><span style="color:#E4F0FB">	console</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">log</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Read access granted to /home/user/documents</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">} else {</span></span>
<span class="line"><span style="color:#E4F0FB">	console</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">log</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Read access not granted to /home/user/documents</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">}</span></span>
<span class="line"></span></code></pre>
<p>Используя модель разрешений, вы получаете более тонкий контроль над доступом процессов Node.js к файловой системе, что может привести к повышению безопасности и более эффективному использованию ресурсов.</p>
<p>Важно отметить, что модель разрешений все еще является экспериментальной и может измениться в будущих выпусках Node.js. Рекомендуется постоянно обновлять документацию по модели разрешений и проявлять осторожность при использовании этих экспериментальных возможностей.</p>
<h2 id="стабильный-прогонщик-тестов">Стабильный прогонщик тестов<a aria-hidden="true" tabindex="-1" href="#стабильный-прогонщик-тестов"><span class="icon icon-link"></span></a></h2>
<p>Node.js v20 включает стабильную версию модуля test_runner, который позволяет разработчикам быстро и легко создавать и запускать наборы тестов JavaScript без установки дополнительных зависимостей.</p>
<p>Стабильная версия test runner теперь включает несколько строительных блоков, таких как <code>describe</code>, <code>it</code>/<code>test</code> и hooks, для создания и структурирования тестовых файлов, а также mocking, watch mode и возможность параллельного запуска нескольких тестовых файлов с помощью команды <code>node --test</code>.</p>
<p>Вот пример использования бегуна тестов:</p>
<pre class="astro-code poimandres" style="background-color:#1b1e28;color:#a6accd; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#5DE4C7">import </span><span style="color:#A6ACCD">{</span><span style="color:#ADD7FF"> test</span><span style="color:#A6ACCD">,</span><span style="color:#ADD7FF"> mock</span><span style="color:#A6ACCD"> }</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">node:test</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">assert</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">node:assert</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"><span style="color:#5DE4C7">import </span><span style="color:#ADD7FF">fs</span><span style="color:#A6ACCD"> from</span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">node:fs</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FB">mock</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">method</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">fs</span><span style="color:#A6ACCD">, </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">readFile</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> () </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> '</span><span style="color:#5DE4C7">Hello World</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E4F0FBD0">test</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">synchronous passing test</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">, </span><span style="color:#5DE4C7">async</span><span style="color:#A6ACCD"> (</span><span style="color:#E4F0FB">t</span><span style="color:#A6ACCD">) </span><span style="color:#91B4D5">=></span><span style="color:#A6ACCD"> {</span></span>
<span class="line"><span style="color:#767C9DB0;font-style:italic">	// Этот тест проходит, потому что не выбрасывает исключение.</span></span>
<span class="line"><span style="color:#E4F0FB">	assert</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">strictEqual</span><span style="color:#A6ACCD">(</span><span style="color:#5DE4C7C0">await</span><span style="color:#E4F0FB"> fs</span><span style="color:#A6ACCD">.</span><span style="color:#E4F0FBD0">readFile</span><span style="color:#A6ACCD">(</span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">a.txt</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">), </span><span style="color:#A6ACCD">'</span><span style="color:#5DE4C7">Hello World</span><span style="color:#A6ACCD">'</span><span style="color:#A6ACCD">);</span></span>
<span class="line"><span style="color:#A6ACCD">});</span></span>
<span class="line"></span></code></pre>
<p>Бегунок тестирования предлагает настраиваемые и пользовательские отчеты о тестах с помощью флага <code>--test-reporter</code>, экспериментальное покрытие тестов с помощью флага <code>--experimental-test-coverage</code> и возможности мокинга.</p>
<p>Хотя он не предназначен для замены полнофункциональных тестовых фреймворков, таких как Jest или Mocha, стабильный тестовый прогон предлагает простой и быстрый способ создания тестовых наборов. Он был значительно улучшен с момента своего появления в Node.js v19, и благодаря тестированию и обратной связи с конечными пользователями теперь отмечен как стабильный в Node.js v20.</p>
<p>Более подробную информацию можно найти в этом объединенном запросе.</p>
<h2 id="движок-v8-javascript-обновлен-до-версии-113">Движок V8 JavaScript обновлен до версии 11.3<a aria-hidden="true" tabindex="-1" href="#движок-v8-javascript-обновлен-до-версии-113"><span class="icon icon-link"></span></a></h2>
<p>Движок V8 JavaScript, на котором работает Node.js, был обновлен до версии 11.3 в Node.js v20. Это повышает производительность и вводит новые возможности языка. Некоторые из новых возможностей этого обновления включают:</p>
<p><code>String.prototype.isWellFormed</code> и <code>toWellFormed</code>: Эти методы особенно полезны для обеспечения правильного формата строк. Они помогают убедиться в том, что вводимые пользователем строки имеют правильный формат UTF-16, что уменьшает количество ошибок в эпоху эмодзи. Методы, изменяющие Array и TypedArray путем копирования: Это может быть полезно для создания измененных копий массивов, не затрагивая исходные данные, что особенно актуально в случаях, когда необходимо сохранить исходные данные для сравнения или других целей. Изменяемый <code>ArrayBuffer</code> и увеличиваемый <code>SharedArrayBuffer</code>: обеспечивает большую гибкость, позволяя эффективнее распределять память. Флаг RegExp v с нотацией множеств и свойствами строк: добавляет функциональность для регулярных выражений. Вызов хвоста WebAssembly: предоставляет возможность оптимизировать определенные типы вызовов функций.</p>
<p>Эти обновления демонстрируют постоянное стремление сообщества разработчиков Node.js к повышению производительности и функциональности.</p>
<h2 id="синхронный-импортmetaresolve">Синхронный импорт.meta.resolve()<a aria-hidden="true" tabindex="-1" href="#синхронный-импортmetaresolve"><span class="icon icon-link"></span></a></h2>
<p>В Node.js v20 появилась функция <code>import.meta.resolve()</code>, которая упрощает написание скриптов, не чувствительных к местоположению. Эта функция возвращается синхронно, аналогично поведению браузера, что обеспечивает более эффективное выполнение.</p>
<p>Крючки resolve загрузчика пользователя по-прежнему могут быть определены как асинхронные функции, но <code>import.meta.resolve()</code> все равно будет возвращаться синхронно для кода приложения, даже если загружены асинхронные крючки resolve.</p>
<p>Синхронное поведение <code>import.meta.resolve()</code> позволяет более эффективно выполнять код, особенно при работе с большими объемами данных. Автор может определить хуки resolve как асинхронные или синхронные функции, в зависимости от ваших предпочтений. Код приложения все равно будет выполняться синхронно, независимо от того, загружены ли асинхронные resolve hooks.</p>
<h2 id="экспериментальные-одноисполняемые-приложения-sea">Экспериментальные одноисполняемые приложения (SEA)<a aria-hidden="true" tabindex="-1" href="#экспериментальные-одноисполняемые-приложения-sea"><span class="icon icon-link"></span></a></h2>
<p>Experimental Single Executable Applications (SEA) - это новая возможность, представленная в Node.js v20, которая позволяет упаковывать ваше приложение с бинарным файлом Node.js, позволяя конечным пользователям распространять и запускать его как один исполняемый файл.</p>
<p>Это была давняя просьба сообщества, и команда дорабатывала подход в течение последнего года.</p>
<p>В Node.js v20 создание единого исполняемого приложения требует инъекции блоба, подготовленного Node.js из конфигурации JSON, а не инъекции необработанного JS-файла.</p>
<p>Блоб - это файл, содержащий двоичные данные, в данном случае подготовленные Node.js, и он внедряется в двоичный файл. Это изменение было сделано для того, чтобы сделать возможным встраивание нескольких сосуществующих ресурсов в SEA, что открывает новые возможности использования.</p>
<p>Вот пример файла sea-config.json:</p>
<p><code>{ "main": "myscript.js", "output": "sea-prep.blob" }</code></p>
<p>При выполнении команды <code>node --experimental-sea-config sea-config.json</code>, блоб записывается в файл sea-prep.blob, который затем можно внедрить в бинарник.</p>
<p>Функция SEA позволяет разработчикам распространять приложения Node.js, не требуя от пользователей установки Node.js. Функциональность была создана Даршаном Сеном, который получил награду ”Выдающийся вклад нового участника” в рамках JavaScriptLandia Awards на OpenJS World.</p>
<p>Microsoft, член OpenJS Foundation, изучает эту функцию как способ уменьшить количество векторных атак и расширить возможности архитектуры Node.js для более удобной работы. Пока функция SEA находится в стадии разработки.Экспериментальный, он представляет собой новое захватывающее развитие для сообщества Node.js.</p>
<h2 id="производительность">Производительность<a aria-hidden="true" tabindex="-1" href="#производительность"><span class="icon icon-link"></span></a></h2>
<p>Node.js v20 поставляется со значительными улучшениями в среде выполнения, при этом вновь сформированная команда Node.js по производительности уделяет особое внимание производительности. Улучшения включают в себя оптимизацию основных частей среды выполнения, таких как URL, <code>fetch()</code> и <code>EventTarget</code>.</p>
<p>Одним из заметных улучшений является снижение стоимости инициализации <code>EventTarget</code>, которая была сокращена вдвое, что привело к ускорению доступа ко всем использующим его подсистемам. Кроме того, вызовы V8 Fast API были использованы для повышения производительности в таких API, как <code>URL.canParse()</code> и таймеры.</p>
<p>Еще одно специфическое изменение - включение обновленной версии 2.0 Ada, быстрого и соответствующего спецификациям парсера URL, написанного на C++.</p>
<p>Знаете ли вы, что в Node.js v20 появился стабильный нативный прогонщик тестов? Пора тестировать свой код более эффективно! Проверьте это ⬇️Click to Tweet Summary</p>
<p>В этой статье вы узнали о некоторых основных возможностях (экспериментальных и стабильных) и улучшениях Node.js v20, таких как улучшения движка V8 JavaScript, производительность, тестовая программа и введение экспериментальной модели разрешений, а также приложения с одним исполнением.</p>
<p>Важно знать, что Node.js v14 выйдет из эксплуатации в апреле 2023 года, поэтому рекомендуется начать планировать обновление до Node.js v18 (LTS) или vNode.js 20 (скоро будет LTS).</p>
<p>Хотите попробовать последнюю версию Node.js? Вы можете сделать это, развернув свое Node.js-приложение на Kinsta и получив свои первые $20. Мы уже поддерживаем Node.js v20, а это значит, что вы можете протестировать ее новые функции и возможности уже сегодня.</p>
<p>Теперь ваша очередь! Какие функции или улучшения в Node.js v20 кажутся вам наиболее интересными? Может быть, мы упустили из виду какие-то значимые из них? Сообщите нам об этом в комментариях.</p>
<p>Соберите все свои приложения, базы данных и сайты WordPress под одной крышей. Наша многофункциональная и высокопроизводительная облачная платформа включает в себя:</p>
<p>Простая настройка и управление на панели MyKinsta Круглосуточная экспертная поддержка Лучшее оборудование и сеть Google Cloud Platform на базе Kubernetes для максимальной масштабируемости Интеграция Cloudflare корпоративного уровня для скорости и безопасности Глобальный охват аудитории с 35 центрами обработки данных и 275 точками доступа по всему миру</p>
<p>Начните с бесплатной пробной версии нашего хостинга приложений или хостинга баз данных. Изучите наши тарифные планы или обратитесь в отдел продаж, чтобы подобрать оптимальный вариант.</p>
<p><a href="https://kinsta.com/blog/node-js-20/" rel="noopener noreferrer nofollow" target="_blank">Источник</a></p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3)&url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3&title=Что нового в Node.js v20 (Test Runner, Permission Model, SEA, V8 JS Engine 11.3)&summary=Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/chto-novoho-v-node-js-v20-test-runner-permission-model-sea-v8-js-engine-11-3&media=&description=Node.js v20 уже доступен! 18 апреля 2023 года она была обнародована и теперь может использоваться всеми желающими. С этим выпуском Node.js должен стать намного" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/chto-novoho-v-rails-7-1" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Что нового в Rails 7.1 </a> <a href="/blog/dekorator-chto-to-takoe-y-kohda-ykh-yspolzovat" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Декораторы - что это такое и когда их использовать </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>