<!DOCTYPE html><html lang="ru"> <head><title>Создание игры Minesweeper в SolidJS Игровая доска - Igor Gorlov</title><link rel="canonical" href="https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska"><meta name="description" content="Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому."><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.10.0"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.Dg72Zwgc.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.CzD8Xhhr.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-xdjatz7t-1"] { view-transition-name: blog-image-sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/undefined-Mar-18-2023.BbyFCf0V_Z12SUxm.avif" type="image/avif"><source srcset="/_astro/undefined-Mar-18-2023.BbyFCf0V_Z1rQuMo.webp" type="image/webp"> <img src="/_astro/undefined-Mar-18-2023.BbyFCf0V_Z10ryHU.png" alt="Создание игры Minesweeper в SolidJS - Игровая доска" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-xdjatz7t-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/как-закодить" class="categories__link" data-astro-cid-axzg2cw6> Как закодить  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Создание игры Minesweeper в SolidJS - Игровая доска </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/gamedev" data-astro-cid-axzg2cw6> Gamedev </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/javascript" data-astro-cid-axzg2cw6> JavaScript </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/solidjs" data-astro-cid-axzg2cw6> Solidjs </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 18 мар., 2023 by Igor Gorlov </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <!-- <TextAds /> --> <!-- <AdfoxTocAds blockId="adfox_17062261612859555" /> --> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Создание игры Minesweeper в SolidJS - Игровая доска&url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska&title=Создание игры Minesweeper в SolidJS - Игровая доска&summary=Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому.&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska&media=&description=Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <p>Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому. Таким образом, я терпеливо ждал чего-то, что могло бы возродить мое вдохновение и интерес, что в конечном итоге пришло в виде старой, но затягивающей игры Minesweeper :)</p>
<p>Моя дочь недавно открыла для себя Minesweeper на своем компьютере, и, к моему удивлению, она стала для нас увлекательным совместным занятием. Я сижу рядом с ней, время от времени предлагая свои два цента, и поражаюсь тому, как быстро она уловила логику игры. Она играет все быстрее и быстрее, с каждым днем ставя рекорды.</p>
<p>Сидя там, я не мог не задуматься о коде, лежащем в основе игры. В частности, я размышлял о расположении игрового поля. Это двумерный массив или плоский массив? Как вычисляются числа? Каким волшебником нужно быть, чтобы создать такую штуку?</p>
<p>Этого достаточно, чтобы разжечь огонь под моей задницей и заставить меня действовать :)</p>
<p>Итак, хотите поучаствовать в создании игры Minesweeper с помощью SolidJS?<br>Поехали!</p>
<p>Эй! Для получения большего количества материалов, подобных тому, что вы собираетесь прочитать, проверьте @mattibarzeev на Twitter 🍻</p>
<p>Код можно найти в этом репозитории GitHub:<br><a href="https://github.com/mbarzeev/solid-minesweeper" rel="noopener noreferrer nofollow" target="_blank">https://github.com/mbarzeev/solid-minesweeper</a></p>
<h2 class="wp-block-heading">Игровая доска</h2>
<p>Доска сделана из массива с 16 ячейками. Это позволит нам создать доску 4х4. В настоящее время она жестко закодирована, позже мы сможем сделать на ней несколько случайных расположений:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="javascript" class="language-javascript">const boardArray: number[] = [0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0];
</code></pre>
<!-- /wp:code -->
<p>Содержимое массива состоит из 0 и 1, где 1 означает плитку с миной, а 0 - пустую плитку.<br>Для отображения я использую компонент <code>&#x3C;For></code> из Solid:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">const App: Component = () => {
   return (
       &#x3C;div class={styles.App}>
           &#x3C;header class={styles.header}>
               &#x3C;For each={boardArray}>
                   {(item: number, index: () => number) => &#x3C;div>{item}&#x3C;/div>}
               &#x3C;/For>
           &#x3C;/header>
       &#x3C;/div>
   );
};
</code></pre>
<!-- /wp:code -->
<p>В результате получается вот что:</p>
<!-- wp:image -->
<figure class="wp-block-image"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--9Khjud6X--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/8vb97fmms941jy0u2uhn.png" alt="Описание изображения"></figure>
<!-- /wp:image -->
<p>Подождите… дальше будет лучше.</p>
<p>Очевидно, нам нужен способ расположить их в сетке 4x4, и для этого я использую … css-сетку :)<br>Я помещу мой &#x3C;For …> тег внутрь div, который имеет класс board css, и вот определение этого класса:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="css" class="language-css">.board {
 --tile-dimension: 30px;
 --row-length: 4;


 display: grid;
 grid-template-columns: repeat(auto-fit, minmax(var(--tile-dimension), 1fr));
 max-width: calc(var(--row-length) * var(--tile-dimension));
}
</code></pre>
<!-- /wp:code -->
<p>Теперь это выглядит следующим образом:</p>
<!-- wp:image -->
<figure class="wp-block-image"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--gazEyZBV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/aa4n0ag2w4dofudp903g.png" alt="Описание изображения"></figure>
<!-- /wp:image -->
<p>Да, больше похоже на это.<br>Мы знаем, что эти пустые клетки должны указывать на количество мин, которые находятся рядом с ними во всех 8 направлениях. Как мы это сделаем?</p>
<h2 class="wp-block-heading">Простой алгоритм игры Minesweeper</h2>
<p>Здесь я использую подход ”грубой силы”, хотя может оказаться, что это самый эффективный способ достижения цели. Я проверяю каждую плитку на наличие мин рядом с ней, но поскольку массив плоский, нам нужно быть умными. Позвольте мне сначала поместить здесь код, а затем объяснить, что происходит в функции “getMinesCount()“.<br>Вот рендеринг, где мы передаем индекс текущей ячейки в функцию getMinesCount:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">&#x3C;div class={styles.board}>
                   &#x3C;For each={boardArray} fallback={&#x3C;div>Loading...&#x3C;/div>}>
                       {(item: number, index: () => number) => (
                           &#x3C;div style={{width: '30px', height: '30px'}}>{getMinesCount(index())}&#x3C;/div>
                       )}
                   &#x3C;/For>
               &#x3C;/div>
</code></pre>
<!-- /wp:code -->
<p>А вот реализация функции getMinesCount:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="javascript" class="language-javascript">function getMinesCount(index: number) {
   const cell = boardArray[index];
   if (cell === 1) {
       return 'x';
   } else {
       let minesCount = 0;
       const hasLeftCells = index % ROW_LENGTH > 0;
       const hasRightCells = (index + 1) % ROW_LENGTH !== 0;
       const bottomCellIndex = index + ROW_LENGTH;
       const topCellIndex = index - ROW_LENGTH;


       if (boardArray[bottomCellIndex] === 1) {
           minesCount++;
       }


       if (boardArray[topCellIndex] === 1) {
           minesCount++;
       }


       if (hasLeftCells) {
           boardArray[index - 1] === 1 &#x26;&#x26; minesCount++;
           boardArray[topCellIndex - 1] === 1 &#x26;&#x26; minesCount++;
           boardArray[bottomCellIndex - 1] === 1 &#x26;&#x26; minesCount++;
       }


       if (hasRightCells) {
           boardArray[index + 1] === 1 &#x26;&#x26; minesCount++;
           boardArray[topCellIndex + 1] &#x26;&#x26; minesCount++;
           hasRightCells &#x26;&#x26; boardArray[bottomCellIndex + 1] &#x26;&#x26; minesCount++;
       }


       return minesCount;
   }
}
</code></pre>
<!-- /wp:code -->
<p>Логика довольно проста - мы вычисляем верхнюю и нижнюю ячейки, выясняем, есть ли у ячейки соседи слева или справа, и соответственно увеличиваем minesCount.</p>
<p>На самом деле это не так уж плохо, учитывая, что у нас сложность O(n).</p>
<p>Вот как это выглядит сейчас:</p>
<!-- wp:image -->
<figure class="wp-block-image"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--qDz0QldX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/n3cf3cyfmtmqsbx2uqvt.png" alt="Описание изображения"></figure>
<!-- /wp:image -->
<p>Символ “X” обозначает мины, а цифры показывают, сколько мин находится рядом с клеткой. Пора создать компонент Tile.</p>
<p>Вы, наверное, заметили, что я использую константу “ROW_LENGTH” для вычисления размеров доски, и я также имею это значение в CSS как переменную, и это немного раздражает меня, что изменение размеров сетки требует изменения как CSS, так и JS, а не только в одном месте.<br>Для этого я решил определить переменную CSS в коде рендеринга, например, так:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">&#x3C;div class={styles.App} style={{'--row-length': ROW_LENGTH}}>
           &#x3C;header class={styles.header}>
               &#x3C;div class={styles.board}>
                   &#x3C;For each={boardArray}>
                       {(item: number, index: () => number) => &#x3C;Tile {...getTileData(index())} />}
                   &#x3C;/For>
               &#x3C;/div>
           &#x3C;/header>
       &#x3C;/div>
</code></pre>
<!-- /wp:code -->
<p>Таким образом, мне нужно только изменить константу “ROW_LENGTH”, и все выравнивается идеально.</p>
<h2 class="wp-block-heading">Компонент плитки</h2>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">import {Component, createSignal} from 'solid-js';
import styles from './Tile.module.css';


export type TileData = {
   isMine: boolean;
   value?: number;
};


const Tile: Component&#x3C;TileData> = (data: TileData) => {
   const [isOpen, setIsOpen] = createSignal(false);
   const [isMarked, setIsMarked] = createSignal(false);


   const onTileClicked = (event: MouseEvent) => {
       !isMarked() &#x26;&#x26; setIsOpen(true);
   };


   const onTileContextClick = (event: MouseEvent) => {
       event.preventDefault();
       !isOpen() &#x26;&#x26; setIsMarked(!isMarked());
   };


   const value = data.isMine ? 'X' : data.value;


   return (
       &#x3C;div class={styles.Tile} onclick={onTileClicked} onContextMenu={onTileContextClick}>
           &#x3C;div class={styles.value} classList={{[styles.exposed]: isOpen() || isMarked()}}>
               {isMarked() ? '🚩' : value !== 0 ? value : ''}
           &#x3C;/div>
       &#x3C;/div>
   );
};


export default Tile;
</code></pre>
<!-- /wp:code -->
<p>Как вы можете видеть, щелчок правой кнопкой мыши отмечает плитку, а обычный щелчок открывает ее. Отметку можно переключить, но после открытия плитка уже открыта.</p>
<p>И мы используем это так в основном приложении:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">&#x3C;For each={boardArray} fallback={&#x3C;div>Loading...&#x3C;/div>}>
                       {(item: number, index: () => number) => &#x3C;Tile {...getTileData(index())} />}
                   &#x3C;/For>
</code></pre>
<!-- /wp:code -->
<p>И вот что мы получили: доска с ”пустыми” плитками, при нажатии на которые они открываются - те, что с цифрами, показывают цифры, те, что с минами, показывают “X”, а отмеченные - флажки.</p>
<!-- wp:image -->
<figure class="wp-block-image"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--RdcRT0Tl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ftfnehlrip7489sa8uny.png" alt="Описание изображения"></figure>
<!-- /wp:image -->
<h2 class="wp-block-heading">Доска Случайностей</h2>
<p>Пора добавить немного случайности в котел. Я хотел бы сгенерировать плоский массив 20x20 (400 клеток), в котором разбросаны 40 мин. Вот код для этого:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="jsx" class="language-jsx">const totalMines = 40;
const ROW_LENGTH = 20;
const TOTAL_TILES = Math.pow(ROW_LENGTH, 2);


const boardArray = [...Array(TOTAL_TILES)].fill(0);


let count = 0;
while (count &#x3C; totalMines) {
   const randomCellIndex = Math.floor(Math.random() * TOTAL_TILES);
   if (boardArray[randomCellIndex] !== 1) {
       boardArray[randomCellIndex] = 1;
       count++;
   }
}
</code></pre>
<!-- /wp:code -->
<p>Вот как это выглядит без скрытия значения плитки для наглядности:</p>
<!-- wp:image -->
<figure class="wp-block-image"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--V81u5Fs1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/36ikyg2dn601nal1abp5.png" alt="Описание изображения"></figure>
<!-- /wp:image -->
<p>На этом пока все.</p>
<p>У нас есть игровое поле, которое позволяет нам настраивать его размеры и количество мин, которые мы хотим включить. В настоящее время у нас есть возможность раскрывать или помечать отдельные плитки.</p>
<p>Следующий шаг - понять логику, лежащую в основе функции ”автораскрытия”, когда несколько плиток раскрываются одним щелчком мыши. Нам нужно определить соответствующую логику для открытия соседних плиток при нажатии на одну плитку. Нам также необходимо решить остальные вопросы механики игры, чтобы обеспечить ее бесперебойную работу.</p>
<p>Код можно найти в этом репозитории GitHub:<br><a href="https://github.com/mbarzeev/solid-minesweeper" rel="noopener noreferrer nofollow" target="_blank">https://github.com/mbarzeev/solid-minesweeper</a></p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Создание игры Minesweeper в SolidJS - Игровая доска&url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska&title=Создание игры Minesweeper в SolidJS - Игровая доска&summary=Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому.&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/sozdanie-igry-minesweeper-v-solidjs-igrovaya-doska&media=&description=Прошло некоторое время с тех пор, как я в последний раз что-то писал. Я подумал, что если поделиться с вами чем-то приятным, это может послужить средством для возвращения к этому." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/sozdanie-kart-react-native-s-pomoshhyu-mapbox" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Создание карт React Native с помощью Mapbox </a> <a href="/blog/sozdanie-diagrammy-boksa-i-uiskera-js" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Создание диаграммы Бокса и Уискера (JS) </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z1U3gfI" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>