<!DOCTYPE html><html lang="ru"> <head><title>Индикатор прогресса с Livewire - Igor Gorlov</title><link rel="canonical" href="https://igorlov.ru/blog/indikator-progressa-s-livewire"><meta name="description" content="Сегодня мы реализуем индикатор прогресса с помощью Livewire."><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.5.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.DbkvWnAm.css" />
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw);padding-left:min(2rem,1.2125rem + 1.05vw);padding-right:min(2rem,1.2125rem + 1.05vw);padding-top:1rem;padding-bottom:1rem}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.breadcrumbs__link[data-astro-cid-vcbh62el]{border-radius:9999px;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover{--tw-bg-opacity: 1;background-color:#fce4e1;background-color:rgba(252,228,225,var(--tw-bg-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]{padding:.125rem .75rem}.breadcrumbs__link[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#6a6a6a;background-color:rgba(106,106,106,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.breadcrumbs__link[data-astro-cid-vcbh62el]:hover:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#8a8a93;background-color:rgba(138,138,147,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}
</style>
<link rel="stylesheet" href="/_astro/_single_.BCoIA8H8.css" />
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#020202;border-color:rgba(2,2,2,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-bg-opacity: 1;background-color:#fef9f8;background-color:rgba(254,249,248,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-533071ec]{margin:auto;margin-top:1.25rem;max-width:42rem;--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.comments:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame[data-v-533071ec]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#020202;color:rgba(2,2,2,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-533071ec],[class=dark] *[data-v-533071ec]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
.theme-toggle[data-v-8d8d9c54]{width:1.25rem;height:1.25rem}
</style><script type="module" src="/_astro/hoisted.DYPnEDpO.js"></script><style>[data-astro-transition-scope="astro-vgmtzcrq-1"] { view-transition-name: blog-image-indikator-progressa-s-livewire; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-14 font-inter text-dark fluid:text-lg dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> <span class="nav__open-line" data-astro-cid-7wkmezxd></span> </button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> <span class="nav__close-line" data-astro-cid-7wkmezxd></span> </button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/projects" class="nav__link" data-astro-cid-7wkmezxd> Работы. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог. </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты. </a> </li> </ul> </nav> </div>   <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var v=Object.defineProperty;var A=(c,s,a)=>s in c?v(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a;var d=(c,s,a)=>(A(c,typeof s!="symbol"?s+"":s,a),a);var u;{let c={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},s=t=>{let[e,n]=t;return e in c?c[e](n):void 0},a=t=>t.map(s),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,n])=>[e,s(n)]));customElements.get("astro-island")||customElements.define("astro-island",(u=class extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var f;if(!this.hydrator||!this.isConnected)return;let e=(f=this.parentElement)==null?void 0:f.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let n=this.querySelectorAll("astro-slot"),r={},l=this.querySelectorAll("template[data-astro-template]");for(let o of l){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("data-astro-template")||"default"]=o.innerHTML,o.remove())}for(let o of n){let i=o.closest(this.tagName);i!=null&&i.isSameNode(this)&&(r[o.getAttribute("name")||"default"]=o.innerHTML)}let h;try{h=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(o){let i=this.getAttribute("component-url")||"<unknown>",b=this.getAttribute("component-export");throw b&&(i+=` (export ${b})`),console.error(`[hydrate] Error parsing props for component ${i}`,this.getAttribute("props"),o),o}let p;await this.hydrator(this)(this.Component,h,r,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),n.disconnect(),this.childrenConnectedCallback()},n=new MutationObserver(()=>{var r;((r=this.lastChild)==null?void 0:r.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});n.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),n=this.getAttribute("client");if(Astro[n]===void 0){window.addEventListener(`astro:${n}`,()=>this.start(),{once:!0});return}try{await Astro[n](async()=>{let r=this.getAttribute("renderer-url"),[l,{default:h}]=await Promise.all([import(this.getAttribute("component-url")),r?import(r):()=>()=>{}]),p=this.getAttribute("component-export")||"default";if(!p.includes("."))this.Component=l[p];else{this.Component=l;for(let y of p.split("."))this.Component=this.Component[y]}return this.hydrator=h,this.hydrate},e,this)}catch(r){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,r)}}attributeChangedCallback(){this.hydrate()}},d(u,"observedAttributes",["props"]),u))}})();</script><astro-island uid="IJ3dh" component-url="/_astro/ThemeToggle.kpN4JrWQ.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-rq644orq&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;ThemeToggle&quot;,&quot;value&quot;:true}"></astro-island> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <div class="blocks__container container"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <ol class="breadcrumbs__list" role="list" data-astro-cid-vcbh62el> <li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el> <a class="breadcrumbs__link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="breadcrumbs__item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </nav>  </div> <div class="blocks__container container"> <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/как-закодить" class="categories__link" data-astro-cid-axzg2cw6> Как закодить  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Индикатор прогресса с Livewire </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/laravel" data-astro-cid-axzg2cw6> Laravel </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 26 фев., 2023 by Igor Gorlov </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div>  <figure class="article__image" data-astro-cid-axzg2cw6> <picture> <source srcset="/_astro/undefined-Feb-26-2023.DJvCah9V_ZRi0lh.avif" type="image/avif"><source srcset="/_astro/undefined-Feb-26-2023.DJvCah9V_1TtlFO.webp" type="image/webp"> <img src="/_astro/undefined-Feb-26-2023.DJvCah9V_299mlt.png" alt="Индикатор прогресса с Livewire" class="aspect-auto h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-vgmtzcrq-1" width="1200" height="500" decoding="async"> </picture> </figure>  <div class="article__content prose prose-zinc max-w-full break-words dark:prose-invert prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:-mx-12 prose-figure:w-screen prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div id="adfox_17062261612859555"></div> <script>(function(){const blockId = "adfox_17062261612859555";

	window.yaContextCb = window.yaContextCb || [];
	window.yaContextCb.push(() => {
		Ya.adfoxCode.createAdaptive(
			{
				ownerId: 1493338,
				containerId: blockId,
				params: {
					p1: 'dawgg',
					p2: 'p',
				},
			},
			['desktop', 'tablet', 'phone'],
			{
				tabletWidth: 830,
				phoneWidth: 480,
				isAutoReloads: true,
			},
		);
	});
})();</script> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Индикатор прогресса с Livewire&#38;url=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/indikator-progressa-s-livewire&#38;title=Индикатор прогресса с Livewire&#38;summary=Сегодня мы реализуем индикатор прогресса с помощью Livewire.&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/indikator-progressa-s-livewire&#38;media=&#38;description=Сегодня мы реализуем индикатор прогресса с помощью Livewire." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <p><img class="post-cover" src="https://fly.io/laravel-bytes/2023-02-16/loading-chunks-cover.png" alt="We are shown an image with a background of pastel, green color. Encompassing most of the image&#x27;s center is a seemingly electric stove, on top of which chunks of brown cube ingredients are cooked in a grey frying pan. On the body of the stove, right below the cooking frying pan, is a label and a progress bar indicating the term LOADING."> Изображение Annie Ruygt</p>
<p>Сегодня мы реализуем индикатор прогресса с помощью Livewire. Fly.io, сделайте ваше приложение на Laravel за считанные минуты!</p>
<p>В статье Загрузка файлов с помощью Livewire мы легко загрузили файл отдельными, более мелкими частями с помощью функции загрузки Livewire. Сегодня мы создадим индикатор прогресса, чтобы наши пользователи знали, насколько продвинулась загрузка файла.</p>
<h2 class="wp-block-heading">Что такое прогресс?</h2>
<p>Мы можем представить себе прогресс как накопление ”маленьких побед”, ведущих к определенному ожиданию. Это портрет, который суммирует, насколько далеко мы продвинулись от завершения наших маленьких побед к ”ожидаемой цели”.</p>
<p>Прогресс может быть измеримым - если мы можем определить нашу ”ожидаемую цель” и перечислить ”маленькие победы”, которые к ней приближают.</p>
<p>Сегодня прогресс, который мы подсчитываем, - это успешная загрузка каждого фрагмента из общего количества фрагментов файла, который нужно загрузить. Каждый загруженный фрагмент - это маленькая победа на пути к полной загрузке файла.</p>
<p>Наш расчет будет выглядеть следующим образом: Процент прогресса = ”Количество маленьких побед на данный момент” / ”Ожидаемое общее количество побед” * 100%.</p>
<p>Это означает, что нам понадобится $chunkCount, чтобы знать, сколько фрагментов мы ожидаем (”Ожидаемые общие победы”), $uploadedCount, чтобы отслеживать, сколько фрагментов было успешно загружено (”Количество маленьких побед”), и, наконец, отдельный $progressPercentage для нашего индикатора прогресса (“Прогресс!”).</p>
<h2 class="wp-block-heading">Шаг на пути к прогрессу</h2>
<p>Чтобы отобразить прогресс отдельных побед для нашей загрузки файлов, важно накапливать каждую победу и сообщать клиенту общий прогресс.</p>
<p>Именно здесь на помощь приходит Livewire. Livewire предоставляет нам именно тот механизм обмена данными, который нужен для отслеживания завершенных загрузок фрагментов, и крючки жизненного цикла данных для пересчета прогресса и реализации индикатора прогресса:</p>
<p>Мы захотим автоматически обмениваться переменными прогресса между клиентом и сервером, поэтому мы объявим публичные атрибуты $chunkCount, $uploadedCount и $progressPercentage. В качестве индикатора прогресса мы будем использовать элемент progress bar в нашем html и свяжем его значение со значением $progressPercentage Каждый раз, когда чанк будет успешно загружен, мы перехватываем завершение загрузки на сервере с помощью обновленного хука Livewire. Отсюда мы можем увеличить $uploadedCount и пересчитать $progressPercentage прямо перед тем, как компонент Livewire отправит ответ об успехе в представление Livewire. Как только представление Livewire получит обновление значения $progressPercentage, оно должно вызвать повторный рендеринг элемента , связанного с нашим атрибутом, тем самым обновляя отображаемый прогресс для наших пользователей! Индикатор прогресса</p>
<p>Прогресс можно вычислить, поэтому сначала нам нужно объявить переменные, которые мы будем использовать для вычисления этого значения в нашем компоненте Livewire:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="php" class="language-php">// app/Http/Livewire/ChunkedFileUpload.php

public $chunkCount;
public $uploadedCount;
public $progressPercentage;
</code></pre>
<!-- /wp:code -->
<p>Здесь мы опираемся на настройку нашей статьи, где наши пользователи могут выбрать файл и нажать на кнопку, чтобы вызвать пользовательскую функцию JavaScript uploadChunks() для нарезки и загрузки фрагментов из выбранного файла:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="php" class="language-php">&#x3C;!-- app/resources/views/livewire/chunked-file-upload.php -->

&#x3C;input type="file" id="myFile"/>
&#x3C;button type="button" id="submit" onclick="uploadChunks()">Submit&#x3C;/button>
</code></pre>
<!-- /wp:code -->
<p>Каждый раз, когда файл отправляется на загрузку, мы будем инициализировать наши переменные прогресса, чтобы они соответствовали прогрессу нового файла. uploadChunks() срабатывает каждый раз, когда пользователь запрашивает загрузку файла, поэтому давайте добавим сюда нашу повторную инициализацию прогресса:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="javascript" class="language-javascript">&#x3C;script>
...
function uploadChunks(){

    // File Details
    const file = document.querySelector('#myFile').files[0];
+   @this.set('chunkCount', Math.ceil(file.size/@js($chunkSize)));
+   @this.set('uploadedCount', 0);
+   @this.set('progressPercentage', 0);
    ...
}
&#x3C;/script>
</code></pre>
<!-- /wp:code -->
<p>Далее добавим в представление Livewire индикатор прогресса. Мы соединим его с атрибутом $progressPercentage, объявленным выше. Таким образом, любое изменение атрибута $progressPercentage будет обновлять и вычислять значение нашего индикатора прогресса.</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="php" class="language-php">&#x3C;!-- app/resources/views/livewire/chunked-file-upload.php -->

&#x3C;input type="file" id="myFile"/>
&#x3C;button type="button" id="submit" onclick="uploadChunks()">Submit&#x3C;/button>

+ @if( $progressPercentage  )
+  &#x3C;progress max="100" wire:model="progressPercentage" />&#x3C;/progress>
+ @endif
</code></pre>
<!-- /wp:code -->
<p>Теперь, когда у нас есть индикатор прогресса, пляшущий под дудку атрибута $progressPercentage, мы готовы обновлять этот прогресс каждый раз, когда мы одерживаем маленькую победу - то есть каждый раз, когда мы успешно загружаем фрагмент нашего файла.</p>
<p>Разместите свои серверы поближе к пользователям - и восхититесь скоростью близкого расположения. Глобальное развертывание на Fly за считанные минуты!</p>
<p>Разверните свое приложение Laravel!  →</p>
<p><img srcset="https://fly.io/static/images/cta-rabbit@2x.jpg 2x" src="https://fly.io/static/images/cta-rabbit.jpg" alt="">Вот как мы развиваемся</p>
<p>Мы будем обновлять наш прогресс каждый раз, когда чанк будет успешно загружен. Для этого нам нужно ответить на два вопроса: как узнать, когда чанк завершает загрузку, и как реагировать на это завершение?</p>
<p>Мы создаем установку, которая использует функцию загрузки Livewire для загрузки нашего чанка файла:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="javascript" class="language-javascript">@this.upload('fileChunk', chunk, ...);
</code></pre>
<!-- /wp:code -->
<p>Обратите внимание на атрибуты, переданные в функцию: chunk - это переменная JavaScript, которая хранит ссылку на фрагмент нашего файла, а fileChunk соответствует публичному атрибуту в нашем компоненте Livewire, объявленному как $fileChunk.</p>
<p>Когда эта функция выполняется, представление Livewire выполняет процесс загрузки переменной chunk во временную папку на нашем сервере. После завершения загрузки фрагмента файла он обновляет отображаемый атрибут $fileChunk с подробной информацией о загруженном фрагменте. Livewire удобно предоставляет нам обновленный хук, который мы можем использовать для внедрения логики после этого ”обновления” нашей переменной.</p>
<p>С помощью этого хука мы можем пересчитать значение $progressPercentage. Каждый раз, когда загружается чанк, мы увеличиваем количество загруженных чанков $uploadedCount. Затем мы разделим это число на ожидаемое количество чанков: $chunkCount, и умножим его на 100, чтобы получить $progressPercentage:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="php" class="language-php">public function updatedFileChunk()
{
    // Update progress here
    $this->uploadedCount += 1;
    $this->progressPercentage 
    = ($this->uploadedCount / $this->chunkCount) * 100;
    ...
}
</code></pre>
<!-- /wp:code -->
<p>Наш хук updatedFileChunk() пересчитывает и обновляет наш $progressPercentage прямо перед тем, как компонент Livewire отвечает клиенту об успешной загрузке.</p>
<p>Изменение $progressPercentage, отправленное компонентом Livewire, обновляет связанный с ним элемент новым значением, перемещая наш индикатор прогресса.</p>
<p>Вот и все! Попробуйте загрузить свой файл сейчас и увидите, как индикатор прогресса движется к отметке 100!</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Индикатор прогресса с Livewire&#38;url=https://igorlov.ru/blog/indikator-progressa-s-livewire" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://igorlov.ru/blog/indikator-progressa-s-livewire&#38;title=Индикатор прогресса с Livewire&#38;summary=Сегодня мы реализуем индикатор прогресса с помощью Livewire.&#38;source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/indikator-progressa-s-livewire&#38;media=&#38;description=Сегодня мы реализуем индикатор прогресса с помощью Livewire." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/integracziya-bazy-dannyh-sqlite-teper-dostupna-v-vide-plagina-dlya-testirovaniya" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Интеграция базы данных SQLite теперь доступна в виде плагина для тестирования </a> <a href="/blog/html-element-br" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> HTML элемент: br </a> </nav>  </div> </article> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.svLg6TOn.js" component-export="default" renderer-url="/_astro/client.D9Vng9vH.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> <astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.BwogX8bT.js" component-export="default" renderer-url="/_astro/client.DtEXyQF-.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  </div> <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-dark  dark:text-gray" aria-label="logo" data-astro-cid-ijoll5s5>Фул фронт дев</a>  <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>