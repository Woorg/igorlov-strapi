<!DOCTYPE html><html lang="ru"> <head><title>Валидация моделей Rails: Исчерпывающее руководство с примерами кода - Igor Gorlov</title><link rel="canonical" href="https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda"><meta name="description" content="Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку."><meta name="robots" content="index, follow"><!-- favicon --><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><!-- theme meta --><meta name="theme-name" content="igorlov.ru"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="generator" content="Astro v4.9.1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- responsive meta --><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta name="google-adsense-account" content="ca-pub-0634695143666394"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="stylesheet" href="/_astro/_regular_.CyGIBtQS.css">
<style>.breadcrumbs[data-astro-cid-vcbh62el]{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#0d52a1;color:rgba(13,82,161,var(--tw-text-opacity));border-radius:min(1.5rem,1.1625rem + .45vw)}.breadcrumbs[data-astro-cid-vcbh62el]:where([class=dark],[class=dark] *){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#fff;color:rgba(255,255,255,var(--tw-text-opacity))}.container[data-astro-cid-vcbh62el]{padding:min(2rem,1.2125rem + 1.05vw)}.list[data-astro-cid-vcbh62el]{display:flex;align-items:center;gap:.125rem}.link[data-astro-cid-vcbh62el]{font-weight:500;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:.125rem .75rem;font-size:min(1.5rem,1.1625rem + .45vw);line-height:var(--tw-lh)}
</style>
<link rel="stylesheet" href="/_astro/_single_.C0aKA9dM.css">
<style>.circular-pagination[data-astro-cid-ihkjvfsn]{display:flex;width:100%;flex-wrap:wrap;align-items:center;justify-content:center;overflow:hidden;border-top-width:1px;--tw-border-opacity: 1;border-color:#27292d;border-color:rgba(39,41,45,var(--tw-border-opacity));margin-top:min(1.25rem,1.1375rem + .15vw)}.circular-pagination__link[data-astro-cid-ihkjvfsn]{width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity));text-decoration-line:none}.circular-pagination__link[data-astro-cid-ihkjvfsn]:hover{--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.circular-pagination__link[data-astro-cid-ihkjvfsn]{padding-left:min(1.5rem,1.1625rem + .45vw);padding-right:min(1.5rem,1.1625rem + .45vw);padding-top:.5rem;padding-bottom:.5rem}
.comments[data-v-f9c4118f]{margin:auto;margin-top:1.25rem;width:100%;--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.comments:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame[data-v-f9c4118f]{width:100%;--tw-bg-opacity: 1;background-color:#fff;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity: 1;color:#27292d;color:rgba(39,41,45,var(--tw-text-opacity))}.giscus-frame:where([class=dark][data-v-f9c4118f],[class=dark] *[data-v-f9c4118f]){--tw-bg-opacity: 1;background-color:#131315;background-color:rgba(19,19,21,var(--tw-bg-opacity))}
</style><script type="module" src="/_astro/hoisted.CUFolni_.js"></script><style>[data-astro-transition-scope="astro-r75ddqls-1"] { view-transition-name: blog-image-validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda; }</style></head> <body class="flex min-h-screen flex-col bg-gray-light pt-16 font-inter text-blue fluid:text-lg lg:pt-24 dark:bg-black dark:text-white"> <header class="header" data-astro-cid-rq644orq> <div class="header__container container" data-astro-cid-rq644orq> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg header__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <symbol id="ai:local:logo-one"><g fill="currentColor"><path d="M1198.57 596.749c0 329.575-267.171 596.751-596.747 596.751-329.575 0-596.749-267.176-596.749-596.751S272.248 0 601.823 0c329.576 0 596.747 267.174 596.747 596.749Z"/><circle cx="3035.75" cy="617.751" r="596.749" transform="rotate(-90 3035.75 617.751)"/><path d="M3035.75 2736.81c329.57 0 596.75 267.18 596.75 596.75 0 329.58-267.18 596.75-596.75 596.75-329.58 0-596.75-267.17-596.75-596.75 0-329.57 267.17-596.75 596.75-596.75Z"/><circle cx="596.749" cy="1964.8" r="596.749"/><path d="M1193.5 3332.87c0 329.57-267.176 596.75-596.751 596.75S0 3662.44 0 3332.87c0-329.58 267.174-596.75 596.749-596.75 329.575 0 596.751 267.17 596.751 596.75Z"/><circle cx="5062.46" cy="617.751" r="596.749" transform="rotate(-90 5062.46 617.751)"/><circle cx="5062.46" cy="3333.56" r="596.749" transform="rotate(-90 5062.46 3333.56)"/></g></symbol><use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <div class="nav header__nav" data-astro-cid-7wkmezxd> <button class="nav__open" title="Открыть меню" data-astro-cid-7wkmezxd> Меню</button> <nav class="nav__container" data-astro-cid-7wkmezxd> <button class="nav__close" title="Закрыть меню" data-astro-cid-7wkmezxd> Закрыть</button> <ul class="nav__list" data-astro-cid-7wkmezxd> <li class="nav__item" data-astro-cid-7wkmezxd> <a href="/blog" class="nav__link nav__link--active" data-astro-cid-7wkmezxd> Блог </a> </li><li class="nav__item" data-astro-cid-7wkmezxd> <a href="#cta" class="nav__link" data-astro-cid-7wkmezxd> Контакты </a> </li> </ul> </nav> </div>   <!-- <ThemeToggle client:only /> --> </div> </header>  <main id="main-content" class="main flex-1">  <div class="blocks"> <nav aria-label="Breadcrumbs" class="breadcrumbs" data-astro-cid-vcbh62el> <div class="container" data-astro-cid-vcbh62el> <ol class="list" role="list" data-astro-cid-vcbh62el> <li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/" data-astro-cid-vcbh62el> Главная </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el> <a class="link" href="/blog" data-astro-cid-vcbh62el> Blog </a> </li><li class="item" role="listitem" data-astro-cid-vcbh62el>  </li> </ol> </div> </nav>  <!-- <TextAds class="fade-in-bottom fluid:my-2" style="--delay: .8s;" /> --><article class="article" data-astro-cid-axzg2cw6> <div class="container" data-astro-cid-axzg2cw6> <div class="article__header" data-astro-cid-axzg2cw6> <ul class="article__categories categories" data-astro-cid-axzg2cw6> <li class="categories__item" data-astro-cid-axzg2cw6> <a href="/category/учебник" class="categories__link" data-astro-cid-axzg2cw6> Учебник  </a> </li> </ul> <h1 class="article__title text-wrap" data-astro-cid-axzg2cw6> Валидация моделей Rails: Исчерпывающее руководство с примерами кода </h1> <ul class="article__tags tags" data-astro-cid-axzg2cw6> <li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/rails" data-astro-cid-axzg2cw6> Rails </a> </li><li class="tags__item" data-astro-cid-axzg2cw6> <a class="tags__link" href="/tag/ruby" data-astro-cid-axzg2cw6> Ruby </a> </li> </ul> <time class="article__date" data-astro-cid-axzg2cw6>
Опубликовано 25 фев., 2023 by Igor Gorlov </time> <time class="article__date" data-astro-cid-axzg2cw6> Последнее изменение: 21 мар., 2024 </time> </div> <article data-astro-cid-axzg2cw6> <figure class="article__image" data-astro-cid-axzg2cw6> <picture data-astro-cid-axzg2cw6> <source srcset="/_astro/undefined-Feb-25-2023.BscJLvqp_1OlLLr.avif" type="image/avif"><source srcset="/_astro/undefined-Feb-25-2023.BscJLvqp_Z2c3zOP.webp" type="image/webp"> <img src="/_astro/undefined-Feb-25-2023.BscJLvqp_Z1fAhhO.png" alt="Валидация моделей Rails: Исчерпывающее руководство с примерами кода" class="aspect-video h-full w-full object-cover object-center" loading="eager" data-astro-cid-axzg2cw6 data-astro-transition-scope="astro-r75ddqls-1" width="1120" height="580" decoding="async"> </picture> </figure> </article> <div class="article__content prose prose-zinc max-w-full break-words text-blue dark:prose-invert prose-headings:text-blue prose-p:text-balance prose-a:no-underline hover:prose-a:underline prose-figure:bg-gray-light prose-figure:p-10 prose-figcaption:text-dark dark:prose-figure:bg-dark dark:prose-figcaption:text-white" data-astro-cid-axzg2cw6> <div id="adfox_17062261612859555"></div> <script>(function(){const blockId = "adfox_17062261612859555";

	window.yaContextCb = window.yaContextCb || [];
	window.yaContextCb.push(() => {
		Ya.adfoxCode.createAdaptive(
			{
				ownerId: 1493338,
				containerId: blockId,
				params: {
					p1: 'dawgg',
					p2: 'p',
				},
			},
			['desktop', 'tablet', 'phone'],
			{
				tabletWidth: 830,
				phoneWidth: 480,
				isAutoReloads: true,
			},
		);
	});
})();</script> <div class="article__meta" data-astro-cid-axzg2cw6> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Валидация моделей Rails: Исчерпывающее руководство с примерами кода&url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda&title=Валидация моделей Rails: Исчерпывающее руководство с примерами кода&summary=Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку.&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda&media=&description=Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <a class="article__meta-section" href="#comments" data-astro-cid-axzg2cw6> Комментарии</a> </div> <p>Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку.</p>
<!-- wp:rank-math/toc-block {"title":"Оглавление","headings":[{"key":"c2a8ecf7-1dbb-424b-bc55-c204e1c87ba2","content":"Валидация присутствия","level":2,"link":"#валидация-присутствия","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"dbd53ec6-c368-46a3-9a08-2ae48b464537","content":"Length Validation","level":2,"link":"#length-validation","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"625d516b-c828-4bf9-ba95-700e8775b11b","content":"Валидация формата","level":2,"link":"#валидация-формата","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"7ae51da4-c80f-4c7d-8a16-8c1417631604","content":"Проверка на уникальность","level":2,"link":"#проверка-на-уникальность","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"5a15368d-4d7e-4a86-8a6b-9793dd5fdf98","content":"Numericality Валидация","level":2,"link":"#numericality-валидация","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"d907b54d-0d28-4f4c-a39b-8e4dba9d2149","content":"Валидация проверки","level":2,"link":"#валидация-проверки","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"06117027-9ea2-4876-9e6d-7e49d8fad23f","content":"Валидация включения","level":2,"link":"#валидация-включения","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"c42c9901-6d9d-4674-bf5f-149e31d761b8","content":"Валидация исключения","level":2,"link":"#валидация-исключения","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"8fdcb832-71b1-46b8-a50d-24a59710f70d","content":"Валидация пользовательских сообщений","level":2,"link":"#валидация-пользовательских-сообщений","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"83525d35-be77-4c37-9be9-eae7203d752e","content":"Условная валидация","level":2,"link":"#условная-валидация","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"f2970082-942d-4b7d-a2a9-7290d1dd884b","content":"Множественные валидации","level":2,"link":"#множественные-валидации","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"a77ab71f-cc1a-4486-b103-2651ba09e0f6","content":"Пользовательская валидация","level":2,"link":"#пользовательская-валидация","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"6500df65-0484-4439-8e9e-aa856fdab444","content":"Валидация ассоциаций","level":2,"link":"#валидация-ассоциаций","disable":false,"isUpdated":false,"isGeneratedLink":true},{"key":"ac0e6927-b02f-4f23-9c7f-5987f3c0a7ac","content":"Заключение","level":2,"link":"#заключение","disable":false,"isUpdated":false,"isGeneratedLink":true}],"listStyle":"ul"} -->
<div class="wp-block-rank-math-toc-block" id="rank-math-toc"><h2>Оглавление</h2><nav><ul><li class=""><a href="#валидация-присутствия">Валидация присутствия</a></li><li class=""><a href="#length-validation">Length Validation</a></li><li class=""><a href="#валидация-формата">Валидация формата</a></li><li class=""><a href="#проверка-на-уникальность">Проверка на уникальность</a></li><li class=""><a href="#numericality-валидация">Numericality Валидация</a></li><li class=""><a href="#валидация-проверки">Валидация проверки</a></li><li class=""><a href="#валидация-включения">Валидация включения</a></li><li class=""><a href="#валидация-исключения">Валидация исключения</a></li><li class=""><a href="#валидация-пользовательских-сообщений">Валидация пользовательских сообщений</a></li><li class=""><a href="#условная-валидация">Условная валидация</a></li><li class=""><a href="#множественные-валидации">Множественные валидации</a></li><li class=""><a href="#пользовательская-валидация">Пользовательская валидация</a></li><li class=""><a href="#валидация-ассоциаций">Валидация ассоциаций</a></li><li class=""><a href="#заключение">Заключение</a></li></ul></nav></div>
<!-- /wp:rank-math/toc-block -->
<p>Вот некоторые из наиболее распространенных методов валидации, доступных в Rails:</p>
<h2 class="wp-block-heading" id="валидация-присутствия">Валидация присутствия</h2>
<p>Самый простой тип валидации — это валидация присутствия, которая гарантирует, что определенное поле не пусто. Например, если вы хотите убедиться, что поле name модели User всегда присутствует, вы напишете следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :name, presence: true
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="length-validation">Length Validation</h2>
<p>Другим распространенным типом валидации является валидация длины, которая ограничивает длину строкового поля. Например, если вы хотите убедиться, что поле пароля в модели User имеет длину не менее 8 символов, вы напишете следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :password, length: { minimum: 8 }
end
</code></pre>
<!-- /wp:code -->
<p>Вы также можете указать максимальную длину поля или как минимальную, так и максимальную длину:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :password, length: { minimum: 8, maximum: 20 }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="валидация-формата">Валидация формата</h2>
<p>Проверка формата используется для того, чтобы убедиться, что поле соответствует определенному шаблону, например, определенному формату электронной почты или формату почтового индекса. Например, если вы хотите убедиться, что поле email в модели User имеет правильный формат, вы напишите следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :email, format: { with: /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i, on: :create }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="проверка-на-уникальность">Проверка на уникальность</h2>
<p>Проверка уникальности гарантирует, что определенное поле уникально для всех записей в базе данных. Например, если вы хотите убедиться, что поле email в модели User уникально, вы напишете следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :email, uniqueness: true
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="numericality-валидация">Numericality Валидация</h2>
<p>Проверка на числовой характер гарантирует, что определенное поле является числом. Вы также можете задать дополнительные ограничения, например, убедиться, что число больше или равно определенному значению, или что оно является целым числом. Например, если вы хотите убедиться, что поле возраст модели User является числом, большим или равным 18, вы можете написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :age, numericality: { greater_than_or_equal_to: 18 }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="валидация-проверки">Валидация проверки</h2>
<p>Валидация подтверждения гарантирует, что поле подтверждается вторым полем. Например, если вы хотите убедиться, что пользователь подтвердил свой пароль, введя его дважды, вы должны написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :password, confirmation: true
end
</code></pre>
<!-- /wp:code -->
<p>В представлении у вас будет два поля, одно для пароля и одно для подтверждения, а поле подтверждения будет названо password_confirmation.</p>
<h2 class="wp-block-heading" id="валидация-включения">Валидация включения</h2>
<p>Валидация включения используется для того, чтобы убедиться, что поле включено в определенный набор значений. Например, если вы хотите убедиться, что модель User имеет поле role, которое является либо admin, либо moderator, либо member, вы напишите следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :role, inclusion: { in: %w(admin moderator member) }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="валидация-исключения">Валидация исключения</h2>
<p>Проверка на исключение используется для того, чтобы убедиться, что поле не входит в определенный набор значений. Например, если вы хотите убедиться, что модель User не имеет поля роли admin или root, вы должны написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :role, exclusion: { in: %w(admin root) }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="валидация-пользовательских-сообщений">Валидация пользовательских сообщений</h2>
<p>Вы также можете задать пользовательские сообщения об ошибках для каждой валидации. Например, если вы хотите отобразить пользовательское сообщение об ошибке, когда электронная почта модели User не имеет правильного формата, вы можете написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :email, format: { with: /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i, 
    message: "is not a valid email address" }
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="условная-валидация">Условная валидация</h2>
<p>Условная проверка позволяет указать, что проверка должна происходить только при выполнении определенного условия. Условие можно указать с помощью опции if. Например, если вы хотите убедиться, что пароль модели User имеет длину не менее 8 символов, только если поле password не равно nil, вы можете написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :password, length: { minimum: 8 }, if: :password_not_nil

  private
    def password_not_nil
      password.present?
    end
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="множественные-валидации">Множественные валидации</h2>
<p>Вы можете использовать несколько валидаций для одного поля, объединяя их в цепочку. Например, если вы хотите убедиться, что email модели User присутствует, имеет правильный формат и является уникальным, вы можете написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validates :email, presence: true, format: { with: /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i }, uniqueness: true
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="пользовательская-валидация">Пользовательская валидация</h2>
<p>Помимо встроенных методов валидации, Rails также позволяет создавать пользовательские валидации. Например, если вы хотите убедиться, что модель User содержит уникальную комбинацию имени и фамилии, вы можете написать собственный метод проверки:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validate :unique_name

  def unique_name
    if User.exists?(first_name: first_name, last_name: last_name)
      errors.add(:first_name, "and last name have already been taken")
    end
  end
end
</code></pre>
<!-- /wp:code -->
<p>или если вы хотите, чтобы имя модели User всегда писалось с заглавной буквы, вы можете написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  validate :name_must_be_capitalized

  private
    def name_must_be_capitalized
      errors.add(:name, "must be capitalized") unless name.nil? || name == name.capitalize
    end
end
</code></pre>
<!-- /wp:code -->
<h2 class="wp-block-heading" id="валидация-ассоциаций">Валидация ассоциаций</h2>
<p>Помимо проверки отдельных моделей, вы также можете проверять ассоциации между моделями. Проверка ассоциаций позволяет задать проверку для модели, которая зависит от состояния других моделей.</p>
<p>Например, если модель User имеет множество сообщений, вы можете проверить, что пользователь должен иметь хотя бы одно сообщение, прежде чем оно будет сохранено в базе данных. Для этого нужно написать следующий код:</p>
<!-- wp:code -->
<pre class="wp-block-code"><code lang="ruby" class="language-ruby">class User &#x3C; ApplicationRecord
  has_many :posts
  validates_associated :posts
end

class Post &#x3C; ApplicationRecord
  belongs_to :user
  validates :title, presence: true
end
</code></pre>
<!-- /wp:code -->
<p>В этом примере пользователь не будет сохранен в базе данных, если у него нет хотя бы одного связанного с ним поста с названием.</p>
<h2 class="wp-block-heading" id="заключение">Заключение</h2>
<p>В заключение следует отметить, что валидации являются важной частью любого Rails-приложения. Используя валидации, вы можете гарантировать, что ваши данные всегда точны, последовательны и соответствуют заданным вами критериям.</p>
<p>Независимо от того, проверяете ли вы отдельные модели или ассоциации между моделями, Rails позволяет легко определять и применять правила проверки. Используя возможности валидации Rails, вы можете сделать свое приложение более надежным и прочным, гарантируя, что данные, вводимые вашими пользователями, всегда точны и последовательны.</p>
<p>Для получения дополнительной информации и полного руководства по валидации в Rails посетите официальную документацию Ruby on Rails по адресу <a href="https://guides.rubyonrails.org/active_record_validations.html" rel="noopener noreferrer nofollow" target="_blank">https://guides.rubyonrails.org/active_record_validations.html</a>.</p> <div class="share article__share" data-astro-cid-g7nhfqu5> <h3 class="share__title" data-astro-cid-g7nhfqu5>Поделиться:</h3> <ul class="share__list" data-astro-cid-g7nhfqu5> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://vk.com/share.php?url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Vk
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="facebook share button" href="https://facebook.com/sharer/sharer.php?u=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Fb
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="twitter share button" href="https://twitter.com/share?title=Валидация моделей Rails: Исчерпывающее руководство с примерами кода&url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
X
</a> </li><li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="linkedin share button" href="https://www.linkedin.com/shareArticle?mini=true&url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda&title=Валидация моделей Rails: Исчерпывающее руководство с примерами кода&summary=Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку.&source=https://igorlov.ru/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Linkd
</a> </li> <li class="share__item" data-astro-cid-g7nhfqu5> <a class="share__link" aria-label="pinterest share button" href="https://pinterest.com/pin/create/button/?url=https://igorlov.ru/blog/validacziya-modelej-rails-ischerpyvayushhee-rukovodstvo-s-primerami-koda&media=&description=Ruby on Rails предоставляет множество встроенных методов валидации, которые помогают гарантировать, что данные, хранящиеся в вашей базе данных, последовательны и соответствуют определенным критериям. Эти методы проверки могут быть заданы непосредственно в файлах модели, что упрощает их управление и поддержку." target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-g7nhfqu5>
Pint
</a> </li> </ul>  </div> <nav class="circular-pagination" aria-label="Circular Pagination" data-astro-cid-ihkjvfsn> <a href="/blog/veb-skrapping-s-pomoshhyu-puppeteer-dlya-polnyh-profanov" class="circular-pagination__link circular-pagination__link--prev" data-astro-cid-ihkjvfsn> Парсинг с помощью Puppeteer для полных профанов </a> <a href="/blog/uznajte-kak-testirovat-prilozheniya-flask-s-pomoshhyu-pytest" class="circular-pagination__link circular-pagination__link--next" data-astro-cid-ihkjvfsn> Узнайте, как тестировать приложения Flask с помощью Pytest </a> </nav>  </div> </div> </article> <div class="container" data-astro-cid-axzg2cw6> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z1T5Wnr" prefix="r0" component-url="/_astro/YandexRelatedAds.D-6fTqBY.js" component-export="default" renderer-url="/_astro/client.Bd2Qst3j.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;YandexRelatedAds&quot;,&quot;value&quot;:true}" await-children=""><div id="yandex_rtb_C-A-2592503-2"></div><!--astro:end--></astro-island> </div> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();</script><astro-island uid="Z2a8j9B" component-url="/_astro/CommentBlock.ChJFdf82.js" component-export="default" renderer-url="/_astro/client.44T8euMP.js" props="{&quot;data-astro-cid-axzg2cw6&quot;:[0,true]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;CommentBlock&quot;,&quot;value&quot;:true}"></astro-island>  <!-- <div class="blocks__container container">
			<CtaBlock id="cta" class=""
			/>
		</div> --> </div>    </main> <footer class="footer" data-astro-cid-dwelrhxs> <div class="footer__container container" data-astro-cid-dwelrhxs> <a href="/" class="logo font-medium lowercase transition-colors fluid:text-lg footer__logo dark:hover:text-light text-blue dark:text-white" aria-label="logo" data-astro-cid-ijoll5s5> <svg width="1.44em" height="1em" viewBox="0 0 5660 3931" class="icon" data-astro-cid-ijoll5s5 data-icon="logo-one">  <use xlink:href="#ai:local:logo-one"></use>  </svg>  </a> <small class="footer__copyright" data-astro-cid-dwelrhxs>все права защищены. © 2024</small> </div> </footer>  </body></html>